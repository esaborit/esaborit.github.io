<!DOCTYPE html>
<html lang='es' ><meta charset="utf-8">
<meta name="viewport" content="width=device-width">

<meta http-equiv="Content-Security-Policy" content=" default-src 'self'; frame-ancestors 'self'; script-src 'self'; style-src 'self'">

<meta http-equiv="X-XSS-Protection"  content="1;mode=block">


<title>Inserción de datos de prueba con seeders y factories|ESC</title><link rel="stylesheet" href="https://esaborit.github.io/css/eureka.min.css">

<link rel="stylesheet" type="text/css" href="https://esaborit.github.iocss/mis.css" /><script defer src="https://esaborit.github.io/js/eureka.min.js"></script>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
  href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap"
  as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/styles/solarized-light.min.css"media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/highlight.min.js"crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/js/all.min.js"integrity="sha256-uNYoXefWRqv&#43;PsIF/OflNmwtKM4lStn9yrz2gVl6ymo="crossorigin></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3&#43;Aro6EYUG4&#43;cU&#43;KJWu/X"media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"integrity="sha384-g7c&#43;Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI&#43;sEnkvrMWph2EDg4"crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC&#43;Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"crossorigin></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],});
  });
</script><link rel="icon" type="image/png" sizes="32x32" href="https://esaborit.github.io/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_32x32_fill_box_center_2.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://esaborit.github.io/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_180x180_fill_box_center_2.png"><meta name="description"
    content="Inserción de datos de prueba en la base de datos Voy a crear un factory para cada una de las entidades/tablas de mi base de datos, salvo para User que ya se creo con el proyecto.
UserFactory.php
&lt;?php namespace Database\Factories; use App\Models\User; use Illuminate\Database\Eloquent\Factories\Factory; use Illuminate\Support\Str; class UserFactory extends Factory { /** * The name of the factory&#39;s corresponding model. * * @var string */ protected $model = User::class; /** * Define the model&#39;s default state.">





<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
"@type": "ListItem",
"position":  1 ,
"name": "ESC",
"item": "https://esaborit.github.io/"
},{
"@type": "ListItem",
"position":  2 ,
"name": "Documentos",
"item": "https://esaborit.github.io/docs/"
},{
"@type": "ListItem",
"position":  3 ,
"name": "Blog diseñado con Laravel",
"item": "https://esaborit.github.io/docs/blog_laravel/"
},{
"@type": "ListItem",
"position":  4 ,
"name": "Inserción de datos de prueba con seeders y factories",
"item": "https://esaborit.github.io/docs/blog_laravel/insertar_datos_de_prueba_con_seeders_y_factories/"
}]
}
</script>



<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://esaborit.github.io/docs/blog_laravel/insertar_datos_de_prueba_con_seeders_y_factories/"
    },
    "headline": "Inserción de datos de prueba con seeders y factories | ESC","datePublished": "2021-01-28T22:39:33+01:00",
    "dateModified": "2021-01-28T22:39:33+01:00",
    "wordCount":  1268 ,
    "publisher": {
        "@type": "Blog",
        "name": "C. Wang",
        "logo": {
            "@type": "ImageObject",
            "url": "https://esaborit.github.io/images/icon.png"
        }
        },
    "description": "Inserción de datos de prueba en la base de datos Voy a crear un factory para cada una de las entidades\/tablas de mi base de datos, salvo para User que ya se creo con el proyecto.\nUserFactory.php\n\u0026lt;?php namespace Database\\Factories; use App\\Models\\User; use Illuminate\\Database\\Eloquent\\Factories\\Factory; use Illuminate\\Support\\Str; class UserFactory extends Factory { \/** * The name of the factory\u0027s corresponding model. * * @var string *\/ protected $model = User::class; \/** * Define the model\u0027s default state."
}
</script>
<meta property="og:title" content="Inserción de datos de prueba con seeders y factories | ESC" />
<meta property="og:type" content="article" />


<meta property="og:image" content="https://esaborit.github.io/images/icon.png">


<meta property="og:url" content="https://esaborit.github.io/docs/blog_laravel/insertar_datos_de_prueba_con_seeders_y_factories/" />




<meta property="og:description" content="Inserción de datos de prueba en la base de datos Voy a crear un factory para cada una de las entidades/tablas de mi base de datos, salvo para User que ya se creo con el proyecto.
UserFactory.php
&lt;?php namespace Database\Factories; use App\Models\User; use Illuminate\Database\Eloquent\Factories\Factory; use Illuminate\Support\Str; class UserFactory extends Factory { /** * The name of the factory&#39;s corresponding model. * * @var string */ protected $model = User::class; /** * Define the model&#39;s default state." />




<meta property="og:locale" content="es" />




<meta property="og:site_name" content="ESC" />






<meta property="article:published_time" content="2021-01-28T22:39:33&#43;01:00" />


<meta property="article:modified_time" content="2021-01-28T22:39:33&#43;01:00" />



<meta property="article:section" content="docs" />


<body class="flex flex-col min-h-screen">
    <header class="flex items-center fixed w-full min-h-16 z-50 bg-secondary-bg shadow-sm">
        <div class="container mx-auto">
            <div class="max-w-screen-xl"><script>
    let storageColorScheme = localStorage.getItem("lightDarkMode")
    
    if ((storageColorScheme == 'Auto' || storageColorScheme == null) && window.matchMedia("(prefers-color-scheme: dark)").matches) {
        document.getElementsByTagName('html')[0].classList.add('dark')
    } else if (storageColorScheme == "Dark") {
        document.getElementsByTagName('html')[0].classList.add('dark')
    }
    
</script>
<nav class="flex items-center justify-between flex-wrap p-4">
    <a href="/" class="mr-6 text-primary-text text-xl font-bold">ESC</a>
    <button id="navbar-btn" class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
        <i class="fas fa-bars"></i>
    </button>

    <div id="target"
        class="hidden block md:flex md:flex-grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
        <div class="text-sm md:flex-grow pb-4 md:pb-0 border-b md:border-b-0" id="current-url"
            currenturl="https://esaborit.github.io/docs/blog_laravel/insertar_datos_de_prueba_con_seeders_y_factories/">
            
            <a href="/posts/"
                class="block mt-4 md:inline-block md:mt-0 hover:text-eureka mr-4 main-a">Artículos</a>
            
            <a href="/docs/"
                class="block mt-4 md:inline-block md:mt-0 hover:text-eureka mr-4 main-a">Documentos</a>
            
        </div>

        <div class="flex">
            <div class="relative pt-4 md:pt-0">
                <div class="cursor-pointer hover:text-eureka" id="lightDarkMode">
                    
                    <i class="fas fa-adjust"></i>
                    
                </div>
                <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id="is-open">
                </div>
                <div class="absolute flex flex-col left-0 md:left-auto right-auto md:right-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40"
                    id='lightDarkOptions'>
                    <span class="px-4 py-1 hover:text-eureka">Light</span>
                    <span class="px-4 py-1 hover:text-eureka">Dark</span>
                    <span class="px-4 py-1 hover:text-eureka">Auto</span>
                </div>
            </div>

            
        </div>
    </div>

    <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id="is-open-mobile">
    </div>

</nav>
<script>
    let element = document.getElementById('lightDarkMode')
    
    if (storageColorScheme == null || storageColorScheme == 'Auto') {
        document.addEventListener('DOMContentLoaded', () => {
            switchMode('Auto')
        })
    } else if (storageColorScheme == "Light") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'sun')
        element.firstElementChild.classList.add('fa-sun')
    } else if (storageColorScheme == "Dark") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'moon')
        element.firstElementChild.classList.add('fa-moon')
    }
    
    
    document.addEventListener('DOMContentLoaded', () => {
        getcolorscheme();
        switchBurger();
        
    });

    let currenturl = document.getElementById('current-url').getAttribute('currenturl')
        if (currenturl.length > 1) {
            currenturl = currenturl.substr(0, currenturl.length - 1)
        }

        sessionStorage.setItem("mainKey", currenturl)

        let elements = document.getElementsByClassName('main-a');
        for (let i in elements) {
            if (typeof elements[i] === "object") {
                let elementurl = elements[i].getAttribute('href')
                if (elementurl.length > 1 && elementurl.charAt(elementurl.length - 1) == '/') {
                    elementurl = elementurl.substr(0, elementurl.length - 1)
                }
                if (elementurl == sessionStorage.getItem("mainKey")) {
                    elements[i].classList.add('text-eureka')
                } else {
                    elements[i].classList.remove('text-eureka')
                }
            }
        }
</script></div>
        </div>
    </header>

    <main class="flex-grow pt-16">
        
        <div class="container mx-auto ">
            <div class="max-w-screen-xl lg:px-4 xl:px-8">


<div class="lg:pt-12">
    <div class="flex flex-col md:flex-row bg-secondary-bg rounded">
        <div class="md:w-1/4 lg:w-1/5 border-r">
            <div class="sticky top-16 pt-6">
                




<div id="sidebar-title" class="md:hidden mx-4 px-2 pt-4 pb-2 md:border-b text-tertiary-text md:text-primary-text">
    <span class="font-semibold">Tabla de contenidos</span>
    <i class="fas fa-caret-right ml-1"></i>
</div>

<div id="sidebar-toc"
    class="hidden md:block overflow-y-auto mx-6 md:mx-0 pr-6 pt-2 md:max-h-doc-sidebar bg-primary-bg md:bg-transparent">
    <div class="flex flex-wrap ml-4 -mr-2 p-2 bg-secondary-bg md:bg-primary-bg rounded">
        <a class=" hover:text-eureka"
            href="https://esaborit.github.io/docs/blog_laravel/">Blog diseñado con Laravel</a>
        
        
        


    </div>
    
<ul class="pl-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://esaborit.github.io/docs/blog_laravel/creacion_proyecto_diseno_bbdd/">Creacion del proyecto y diseño de la base de datos del blog</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" text-eureka  hover:text-eureka"
                href="https://esaborit.github.io/docs/blog_laravel/insertar_datos_de_prueba_con_seeders_y_factories/">Inserción de datos de prueba con seeders y factories</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://esaborit.github.io/docs/blog_laravel/crear_un_menu_responsive_con_tailwind_y_alpine/">Crear un menú responsive con Tailwind y Alpine</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://esaborit.github.io/docs/blog_laravel/listado_de_posts_en_la_pagina_principal/">Crear un listado de post en la página principal</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://esaborit.github.io/docs/blog_laravel/mostrando_y_filtrando_posts/">Mostrando y filtrando posts</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://esaborit.github.io/docs/blog_laravel/adminlte_en_el_proyecto/">Creando el backend del blog </a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://esaborit.github.io/docs/blog_laravel/crud_categorias/">Creando el crud de categorías. </a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://esaborit.github.io/docs/blog_laravel/crud_etiquetas/">Creando el crud de etiquetas. </a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://esaborit.github.io/docs/blog_laravel/crud_post/">Creando el crud de posts. </a>
        </div>
        
    </li>
    
    
</ul>

</div>





            </div>

        </div>
        <div class="w-full md:w-3/4 lg:w-4/5 pb-8 pt-2 md:pt-8">
            <div class="w-full lg:w-3/4 pl-6 ml-0 mr-auto">
                <h1 class="font-bold text-3xl text-primary-text">Inserción de datos de prueba con seeders y factories</h1>
                <div class="flex flex-wrap flex-row items-center my-2 text-tertiary-text">
    <div class="mr-6 my-2">
        <i class="fas fa-calendar mr-1"></i>
        <span>2021-01-28</span>
    </div>
    <div class="mr-6 my-2">
        <i class="fas fa-clock mr-1"></i>
        <span>6 min lectura</span>
    </div>
    
    

    
</div>
            </div>
            <div class="flex">
                <div class="w-full lg:w-3/4 px-6">
                    
                    
                    <div class="content">
                        <h2 id="inserción-de-datos-de-prueba-en-la-base-de-datos">Inserción de datos de prueba en la base de datos</h2>
<p>Voy a crear un <code>factory</code> para cada una de las entidades/tablas de mi base de datos, salvo para <code>User</code> que ya se creo con el proyecto.</p>
<p><em><strong>UserFactory.php</strong></em></p>
<pre><code class="language-php">&lt;?php

namespace Database\Factories;

use App\Models\User;
use Illuminate\Database\Eloquent\Factories\Factory;
use Illuminate\Support\Str;

class UserFactory extends Factory
{
    /**
     * The name of the factory's corresponding model.
     *
     * @var string
     */
    protected $model = User::class;

    /**
     * Define the model's default state.
     *
     * @return array
     */
    public function definition()
    {
        return [
            'name' =&gt; $this-&gt;faker-&gt;name,
            'email' =&gt; $this-&gt;faker-&gt;unique()-&gt;safeEmail,
            'email_verified_at' =&gt; now(),
            'password' =&gt; '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', // password
            'remember_token' =&gt; Str::random(10),
        ];
    }
}
</code></pre>
<p>Empiezo a crealos.</p>
<pre><code>enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:factory CategoryFactory
Factory created successfully.
enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:factory PostFactory
Factory created successfully.
enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:factory TagFactory
Factory created successfully.
enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:factory ImageFactory
Factory created successfully.
</code></pre>
<p>Ahora abro cada uno de los factories creados y los edito. Debo de indicar en cada uno de ellos que campos de la tabla quiero que se llenen y con que tipo de datos.</p>
<p><em><strong>CategoryFactory.php</strong></em></p>
<pre><code class="language-php">
namespace Database\Factories;

use App\Models\Category;
use Illuminate\Database\Eloquent\Factories\Factory;
use Illuminate\Support\Str;

class CategoryFactory extends Factory
{
    /**
     * The name of the factory's corresponding model.
     *
     * @var string
     */
    protected $model = Category::class;

    /**
     * Define the model's default state.
     *
     * @return array
     */
    public function definition()
    {
        $name = $this-&gt;faker-&gt;unique()-&gt;word(20); //genera una palabra aleatorioa y única

        return [
            'name' =&gt; $name,
            'slug' =&gt; Str::slug($name) // Uso Str para que me genere el slug de $name
        ];
    }
}
</code></pre>
<p><em><strong>PostFactory.php</strong></em></p>
<pre><code class="language-php">&lt;?php

namespace Database\Factories;

use App\Models\Category;
use App\Models\Post;
use App\Models\User;
use Illuminate\Database\Eloquent\Factories\Factory;
use Illuminate\Support\Str;

class PostFactory extends Factory
{
    /**
     * The name of the factory's corresponding model.
     *
     * @var string
     */
    protected $model = Post::class;

    /**
     * Define the model's default state.
     *
     * @return array
     */
    public function definition()
    {
        $name = $this-&gt;faker-&gt;unique()-&gt;sentence(); // Para el titulo del post

        return [
            'name' =&gt; $name,
            'slug' =&gt; Str::slug($name),
            'extract' =&gt; $this-&gt;faker-&gt;text(250), //Expecifico que el texto sea de 250 caracteres
            'body' =&gt; $this-&gt;faker-&gt;text(2000), //Expecifico que el texto sea de 250 caracteres
            'category_id' =&gt; Category::all()-&gt;random()-&gt;id, // Llamo al modelo Category, traigo todos los registros, elijo uno al azar y pido su id.
            'user_id' =&gt; User::all()-&gt;random()-&gt;id // Llamo al modelo User, traigo todos los registros, elijo uno al azar y pido su id.
        ];
</code></pre>
<p><em><strong>TagFactory.php</strong></em></p>
<pre><code class="language-php">
namespace Database\Factories;

use App\Models\Tag;
use Illuminate\Database\Eloquent\Factories\Factory;
use Illuminate\Support\Str;

class TagFactory extends Factory
{
    /**
     * The name of the factory's corresponding model.
     *
     * @var string
     */
    protected $model = Tag::class;

    /**
     * Define the model's default state.
     *
     * @return array
     */
    public function definition()
    {
        $name = $this-&gt;faker-&gt;unique()-&gt;word(20);

        return [
            'name' =&gt; $name,
            'slug' =&gt; Str::slug($name),
            'color' =&gt; $this-&gt;faker-&gt;randomElement(['red', 'yellow', 'green', 'blue', 'indigo', 'purple', 'pink'])
        ];
    }
}
</code></pre>
<p>cuando subimos una imagen al servidor esta se almacena en la carpeta <code>var/www/laravel/blog_laravel/storage/app</code></p>
<pre><code>enrique@enrique-server:/var/www/laravel/blog_laravel$ ls -la storage/app/
total 16
drwxrwsr-x 3 enrique www-data 4096 Dec  8 15:51 .
drwxrwsr-x 5 enrique www-data 4096 Dec  8 15:51 ..
-rw-rw-r-- 1 enrique www-data   23 Dec  8 15:51 .gitignore
drwxrwsr-x 2 enrique www-data 4096 Dec  8 15:51 public
</code></pre>
<p>Pero a la única carpeta a la que podemos acceder desde el navegador es a la carpeta <code>public</code></p>
<pre><code>enrique@enrique-server:/var/www/laravel/blog_laravel$ ls -la public/
total 36
drwxrwsr-x  4 enrique www-data 4096 Dec  9 22:58 .
drwxrwsr-x 13 enrique www-data 4096 Dec  9 22:57 ..
-rw-rw-r--  1 enrique www-data  603 Dec  8 15:51 .htaccess
drwxr-sr-x  2 enrique www-data 4096 Dec  9 22:30 css
-rw-rw-r--  1 enrique www-data    0 Dec  8 15:51 favicon.ico
-rw-rw-r--  1 enrique www-data 1731 Dec  8 15:51 index.php
drwxrwsr-x  2 enrique www-data 4096 Dec  9 22:58 js
-rw-rw-r--  1 enrique www-data   71 Dec  9 22:58 mix-manifest.json
-rw-rw-r--  1 enrique www-data   24 Dec  8 15:51 robots.txt
lrwxrwxrwx  1 enrique www-data   48 Dec  9 22:30 storage -&gt; /var/www/laravel/blog_laravel/storage/app/public
-rw-rw-r--  1 enrique www-data 1194 Dec  8 15:51 web.config
</code></pre>
<p>En esta carpeta <code>public</code> hay un acceso directo a una carpeta llamada <code>storage</code>, pero esta carpeta <code>storage</code> no es la misma que <code>var/www/laravel/blog_laravel/storage/app</code>, sino a <code>/var/www/laravel/blog_laravel/storage/app/public</code>.</p>
<p>Entonces lo que debo lograr es que las imágenes se suban a la carpeta <code>/var/www/laravel/blog_laravel/storage/app/public</code> para conseguirlo voy a la carpeta <code>config</code> y abro el archivo <code>/var/www/laravel/blog_laravel/config/filesystems.php</code> donde cambio el valor de la variable <code>FILESYSTEM_DRIVER</code> de local a public.</p>
<p><em><strong>filesystems.php</strong></em></p>
<pre><code class="language-php">&lt;?php

return [

    /*
    |--------------------------------------------------------------------------
    | Default Filesystem Disk
    |--------------------------------------------------------------------------
    |
    | Here you may specify the default filesystem disk that should be used
    | by the framework. The &quot;local&quot; disk, as well as a variety of cloud
    | based disks are available to your application. Just store away!
    |
    */

    //'default' =&gt; env('FILESYSTEM_DRIVER', 'local'),
    'default' =&gt; env('FILESYSTEM_DRIVER', 'public'),
</code></pre>
<p><em><strong>ImageFactory.php</strong></em></p>
<pre><code class="language-php">&lt;?php

namespace Database\Factories;

use App\Models\Image;
use Illuminate\Database\Eloquent\Factories\Factory;

class ImageFactory extends Factory
{
    /**
     * The name of the factory's corresponding model.
     *
     * @var string
     */
    protected $model = Image::class;

    /**
     * Define the model's default state.
     *
     * @return array
     */
    public function definition()
    {
        return [
            'url' =&gt; 'posts/'.$this-&gt;faker-&gt;image('public/storage/posts', 640, 480, null, false) //lo almacena en posts/imagen.jpg
        ];
    }
}
</code></pre>
<p>Para que estos <code>factories</code> puedan rellenar la base de datos con valores falsos debo de llamarlos desde <code>databaseSeeders.php</code></p>
<p>Creo un seeder para meter mis usuarios junto con datos aleatorios creados por el <code>UserFactory.php</code></p>
<pre><code>enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:seeder UserSeeder
Seeder created successfully.
</code></pre>
<p><em><strong>UserSeeder.php</strong></em></p>
<pre><code class="language-php">&lt;?php

namespace Database\Seeders;

use App\Models\User;
use Illuminate\Database\Seeder;

class UserSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        User::create([
            'name' =&gt; 'Enrique Saborit Crespo',
            'email' =&gt; 'esaborit@gmail.com',
            'password' =&gt; bcrypt('esaborit')
        ]);
        
        User::factory(99)-&gt;create();
    }
}
</code></pre>
<p>Debo llamar este <code>UserSeeder</code> desde el <code>DatabaseSeeder</code>ya que es el único documento que se va a leer a la hora de ejecutar los seeders.</p>
<p><em><strong>DatabaseSeeder.php</strong></em></p>
<pre><code class="language-php">&lt;?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;

class DatabaseSeeder extends Seeder
{
    /**
     * Seed the application's database.
     *
     * @return void
     */
    public function run()
    {
        $this-&gt;call(UserSeeder::class); // Llamo al UserSeeder
        Category::factory(4)-&gt;create(); // Para que me cree 4 categorias
        Tag::factory(8)-&gt;create(); // me crea 8 etiquetas
    }
}
</code></pre>
<p>Para crear los posts falsos necesito que me cree a la vez una imagen con cada uno por lo que los voy a crear con u seeder a parte que incluiré después en <code>DaabaseSeeder.php</code></p>
<pre><code>enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:seeder PostSeeder
Seeder created successfully.
</code></pre>
<p><em><strong>PostSeeder.php</strong></em></p>
<pre><code class="language-php">&lt;?php

namespace Database\Seeders;

use App\Models\Image;
use App\Models\Post;
use Illuminate\Database\Seeder;

class PostSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        $posts = Post::factory(100)-&gt;create();

        foreach ($posts as $post) {
            // añado una imagen a cada post (como el ImageFactory solo añade la url el resto lo añado aqui)
            Image::factory(1)-&gt;create([
                'imageable_id' =&gt; $post-&gt;id,
                'imageable_type' =&gt; Post::class
            ]);
            // Añado 2 etiquetas a cada post
            $post-&gt;tags()-&gt;attach([ // attach() rellena la tabla post_tag
                rand(1, 4),
                rand(5, 8)
            ]);
        }
    }
}
</code></pre>
<p>Llamo a este seeder desde <code>DatabaseSeeder.php</code></p>
<pre><code class="language-php">&lt;?php

namespace Database\Seeders;

use App\Models\Category;
use App\Models\Tag;
use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\Storage;

class DatabaseSeeder extends Seeder
{
    /**
     * Seed the application's database.
     *
     * @return void
     */
    public function run()
    {
         // \App\Models\User::factory(10)-&gt;create();
        
        Storage::deleteDirectory('posts'); // Elimina el directorio cada vez que hago un seed
        Storage::makeDirectory('posts');
        $this-&gt;call(UserSeeder::class);
        Category::factory(4)-&gt;create();
        Tag::factory(8)-&gt;create();
        $this-&gt;call(PostSeeder::class);
    }
}
</code></pre>
<p>Ejecuto los seeders</p>
<pre><code>enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan migrate:fresh --seed
Dropped all tables successfully.
Migration table created successfully.
Migrating: 2014_10_12_000000_create_users_table
Migrated:  2014_10_12_000000_create_users_table (7,283.34ms)
Migrating: 2014_10_12_100000_create_password_resets_table
Migrated:  2014_10_12_100000_create_password_resets_table (3,186.33ms)
Migrating: 2014_10_12_200000_add_two_factor_columns_to_users_table
Migrated:  2014_10_12_200000_add_two_factor_columns_to_users_table (4,433.22ms)
Migrating: 2019_08_19_000000_create_failed_jobs_table
Migrated:  2019_08_19_000000_create_failed_jobs_table (3,505.14ms)
Migrating: 2019_12_14_000001_create_personal_access_tokens_table
Migrated:  2019_12_14_000001_create_personal_access_tokens_table (6,432.68ms)
Migrating: 2020_12_09_223020_create_sessions_table
Migrated:  2020_12_09_223020_create_sessions_table (11,400.94ms)
Migrating: 2020_12_10_151428_create_categories_table
Migrated:  2020_12_10_151428_create_categories_table (2,110.62ms)
Migrating: 2020_12_10_152625_create_posts_table
Migrated:  2020_12_10_152625_create_posts_table (14,110.12ms)
Migrating: 2020_12_10_154814_create_tags_table
Migrated:  2020_12_10_154814_create_tags_table (2,421.83ms)
Migrating: 2020_12_10_155345_create_post_tag_table
Migrated:  2020_12_10_155345_create_post_tag_table (17,809.01ms)
Migrating: 2020_12_10_182248_create_images_table
Migrated:  2020_12_10_182248_create_images_table (2,946.20ms)
Seeding: Database\Seeders\UserSeeder
Seeded:  Database\Seeders\UserSeeder (47,335.58ms)
Seeding: Database\Seeders\PostSeeder
Seeded:  Database\Seeders\PostSeeder (172,518.66ms)
Database seeding completed successfully.
</code></pre>
<p>Desde <code>phpmyadmin</code> puedo ver las tablas de mi proyecto con los registros falsos creados.</p>
<p><figure>
    <img src="/img/documentos/blog_laravel/4.png"/> 
</figure>

<figure>
    <img src="/img/documentos/blog_laravel/5.png"/> 
</figure>

<figure>
    <img src="/img/documentos/blog_laravel/6.png"/> 
</figure>

<figure>
    <img src="/img/documentos/blog_laravel/7.png"/> 
</figure>

<figure>
    <img src="/img/documentos/blog_laravel/8.png"/> 
</figure>

<figure>
    <img src="/img/documentos/blog_laravel/9.png"/> 
</figure>
</p>

                    </div>
                    
                    

                    

                    
<div class="flex flex-col md:flex-row md:justify-between -mx-2 mt-4 px-2 pt-4 border-t">
    <div>
        
        <span class="block font-bold">Anterior</span>
        <a href="https://esaborit.github.io/docs/blog_laravel/creacion_proyecto_diseno_bbdd/" class="block">Creacion del proyecto y diseño de la base de datos del blog</a>
        
    </div>
    <div class="md:text-right mt-4 md:mt-0">
        
        <span class="block font-bold">Siguiente</span>
        <a href="https://esaborit.github.io/docs/blog_laravel/crear_un_menu_responsive_con_tailwind_y_alpine/" class="block">Crear un menú responsive con Tailwind y Alpine</a>
        
    </div>
</div>

                    
                </div>
                
                <div class="hidden lg:block lg:w-1/4">
                    
                    <div class="sticky top-16 z-10 hidden lg:block px-6 py-4  bg-secondary-bg pt-16 -mt-16 ">
    <span class="text-lg font-semibold">Secciones</span>
</div>
<div class="sticky-toc hidden lg:block px-6 pb-6  pt-10 -mt-10 border-l ">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#inserción-de-datos-de-prueba-en-la-base-de-datos">Inserción de datos de prueba en la base de datos</a></li>
  </ul>
</nav>
</div>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        enableStickyToc();
    });
</script>
                    
                </div>
                
            </div>

        </div>


    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        hljs.initHighlightingOnLoad();
        changeSidebarHeight();
        switchDocToc();
    })
</script>









            </div>
        </div>
        
    </main>

    <footer>
        <div class="container mx-auto">
            <div class="max-w-screen-xl"><footer class="w-full text-center p-6 pin-b text-sm text-tertiary-text">
    <p>&copy; 2021 Enrique Saborit Crespo &middot;  Powered by the <a href="https://github.com/wangchucheng/hugo-eureka" class="hover:text-eureka">Eureka</a> theme for <a href="https://gohugo.io" class="hover:text-eureka">Hugo</a></p>
</footer></div>
        </div>
    </footer>
</body>

</html>