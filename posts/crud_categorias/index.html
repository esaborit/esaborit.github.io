<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>ESC | Creando el crud de categorías - VII </title>
    <meta name="description" content="Creando un crud para las categorías del blog Genero en admin.php una ruta de tipo resources que me genere las rutas para el crud de las categorías. Antes creo un controlador para categorías que me genere ya los 7 métodos.
1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller Admin/CategoryController -r Controller created successfully. ">
    <link rel="canonical" href="https://esaborit.github.io/posts/crud_categorias/" />
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <meta property="og:title" content="Creando el crud de categorías - VII " />
<meta property="og:description" content="Creando un crud para las categorías del blog Genero en admin.php una ruta de tipo resources que me genere las rutas para el crud de las categorías. Antes creo un controlador para categorías que me genere ya los 7 métodos.
1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller Admin/CategoryController -r Controller created successfully." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://esaborit.github.io/posts/crud_categorias/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-30T22:19:33+01:00" />
<meta property="article:modified_time" content="2021-01-30T22:19:33+01:00" />
<meta property="og:see_also" content="https://esaborit.github.io/posts/crud_post/" /><meta property="og:see_also" content="https://esaborit.github.io/posts/crud_etiquetas/" /><meta property="og:see_also" content="https://esaborit.github.io/posts/adminlte_en_el_proyecto/" /><meta property="og:see_also" content="https://esaborit.github.io/posts/mostrando_y_filtrando_posts/" /><meta property="og:see_also" content="https://esaborit.github.io/posts/listado_de_posts_en_la_pagina_principal/" />


    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Creando el crud de categorías - VII "/>
<meta name="twitter:description" content="Creando un crud para las categorías del blog Genero en admin.php una ruta de tipo resources que me genere las rutas para el crud de las categorías. Antes creo un controlador para categorías que me genere ya los 7 métodos.
1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller Admin/CategoryController -r Controller created successfully."/>

    
        
    

    <link rel="stylesheet" href='/css/style.css' />
    <link rel="stylesheet" href='/css/search.css' />
    <link rel="stylesheet" href='/css/md_nb.css' />
    <link rel="stylesheet" href='/css/list.css' />
    <link rel="stylesheet" href='/css/terms.css' />
    <link rel="stylesheet" href='/css/taxonomy.css' />
    <link rel="stylesheet" href='/css/font-awesome-4.7.0/css/font-awesome.min.css' />
    <link rel="stylesheet" href='/css/home.css' />
    <link rel="stylesheet" href='/css/syntax.css' />
    
    <link rel="stylesheet" href='/css/shortcode.css' />
    
    
    <link rel="stylesheet" href='/css/_custom.css' />
    <style>
         
    </style>
    
    
    
    
    <script src="/js/lazysizes.min.js" async=""></script>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/search.js"></script>
    <script src="/js/md_nb.js"></script>
    <script src="/js/yes.js"></script>
    
</head><body style="font-family: ,'Helvetica Neue', Helvetica, Arial, 'PingFang SC', 'Hiragino Sans GB', 'Heiti SC', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif;">
        <div class="loading">
            <div class="loading-bg"></div>
            <div class="loading-long">
                <div class="loading-short"></div>
            </div>
        </div>

        <header>
    <nav class="navbar">
        <div class="navbar-brand">
            <a href="/">
                <span class="logo">ESC</span>
            </a>
        </div>
        <div class="navbar-menu">
            
                <a href="/">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-home'></i> Inicio</div>
                        </div>
                    </div>
                </a>
            
                <a href="/posts">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-book'></i> Artículos</div>
                        </div>
                    </div>
                </a>
            
                <a href="/categories">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-folder-open'></i> Categorias</div>
                        </div>
                    </div>
                </a>
            
                <a href="/tags">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-tags'></i> Etiquetas</div>
                        </div>
                    </div>
                </a>
            
            <div class="navbar-burger">
                <div class="burger-btn"><span><i class="fa fa-navicon"></i></span></div>
            </div>
            
            
            <div class="search-in"><span><i class="fa fa-search"></i></span></div>
            
                <div class="mode">
                    <span class="sun"><i class="fa fa-sun-o"></i></span>
                    <span class="moon"><i class="fa fa-moon-o"></i></span>
                </div>
            
        </div>
    </nav>
    <div class="burger-items">
        
        <a href="/">
            <div class="burger-item">
                <i class='fa fa-home'></i> Inicio
            </div>
        </a>
        
        <a href="/posts">
            <div class="burger-item">
                <i class='fa fa-book'></i> Artículos
            </div>
        </a>
        
        <a href="/categories">
            <div class="burger-item">
                <i class='fa fa-folder-open'></i> Categorias
            </div>
        </a>
        
        <a href="/tags">
            <div class="burger-item">
                <i class='fa fa-tags'></i> Etiquetas
            </div>
        </a>
        
    </div>
    <div class="header-rest"></div>
</header>


        <div id="content">








    <div class="hero">
        
            <div class="hero-img">
                <img class="lazyload" src="/images/thumbnail.gif" data-src="/images/post/blog_laravel/blog_laravel.jpg" alt="">
            </div>
        
        <div class="hero-content">
            <div class="hero-title">Creando el crud de categorías - VII </div>
            <div class="hero-subtitle"></div>
            <div class="hero-date">
                    <span class="no-wrap"><i class="fa fa-calendar"></i> publicado el: 2021-1-30 &nbsp;</span>
                    <span class="no-wrap"><i class="fa fa-calendar-check-o"></i> actualizado el: 2021-1-30 &nbsp;</span>
                    <span class="no-wrap"><i class="fa fa-folder"></i>
                        incluido en:
                        
                            <a href='
                                /categories/proyecto-blog-laravel
                            '>
                                Proyecto blog laravel
                            </a>
                    </span>    
            </div>
            <div class="timelong">
                <span class="no-wrap"><i class="fa fa-pencil"></i> palabras totales: 3208 &nbsp;</span>
                <span class="no-wrap"><i class="fa fa-clock-o"></i> tiempo de lectura: 16 mins &nbsp;</span>
                
            </div>
        </div>
    </div>




<div class="zhuti-0">
    <div class="container">
        <div class="zhuti">
            <div class="zhuti-l">
                




    


<div class="content-root">
    <div class="long">
        <button class="tosides-1 text-wbd">
            <i class="fa fa-arrow-right"></i>
        </button>
        <button class="tosides-2 text-wbd">
            <i class="fa fa-arrow-left"></i>
        </button>
        <button class="toup text-wbd">
            <i class="fa fa-arrow-up"></i>
        </button>
    </div>
    
        <div class="content">
            <div class="content-self">
                <h2 id="creando-un-crud-para-las-categorías-del-blog">Creando un crud para las categorías del blog</h2>
<p>Genero en <code>admin.php</code> una ruta de tipo resources que me genere las  rutas para el crud de las categorías. Antes creo un controlador para categorías que me genere ya los 7 métodos.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller Admin/CategoryController -r
</span></span><span class="line"><span class="cl">Controller created successfully.
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>CategoryController.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">App\Http\Controllers\Admin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">App\Http\Controllers\Controller</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Illuminate\Http\Request</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CategoryController</span> <span class="k">extends</span> <span class="nx">Controller</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Display a listing of the resource.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Show the form for creating a new resource.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">create</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Store a newly created resource in storage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  \Illuminate\Http\Request  $request
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">store</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Display the specified resource.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Show the form for editing the specified resource.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">edit</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Update the specified resource in storage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  \Illuminate\Http\Request  $request
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">update</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">,</span> <span class="nv">$id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Remove the specified resource from storage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">destroy</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Dentro del archivo <code>admin.php</code>  creo la ruta de tipo resources para categorías se la asigno al controlador <code>CategoryController</code> y le digo que los nombres de las rutas comiencen por <code>admin.categories</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">App\Http\Controllers\Admin\CategoryController</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">App\Http\Controllers\Admin\HomeController</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Route</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Route</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">HomeController</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">])</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">(</span><span class="s1">&#39;admin.home&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">Route</span><span class="o">::</span><span class="na">resource</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">,</span> <span class="nx">CategoryController</span><span class="o">::</span><span class="na">class</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">names</span><span class="p">(</span><span class="s1">&#39;admin.categories&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Si observo las rutas creadas veo que los parámetros que pasamos son de tipo categoy (en singular)</p>
<figure><img src="/images/post/blog_laravel/16.png"/>
</figure>

<p>Esto no coincide con los parámetros que pasamos en los métodos del controlador. Los cambio en el controlador para que sean objetos de tipo Category, y añado las vistas que quiero que muestren los metodos index, show, edit y create</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">App\Http\Controllers\Admin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">App\Http\Controllers\Controller</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">App\Models\Category</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Illuminate\Http\Request</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CategoryController</span> <span class="k">extends</span> <span class="nx">Controller</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Display a listing of the resource.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;admin.categories.index&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Show the form for creating a new resource.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">create</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;admin.categories.create&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Store a newly created resource in storage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  \Illuminate\Http\Request  $request
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">store</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Display the specified resource.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">(</span><span class="nx">Category</span> <span class="nv">$category</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;admin.categories.show&#39;</span><span class="p">,</span> <span class="nx">compact</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Show the form for editing the specified resource.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">edit</span><span class="p">(</span><span class="nx">Category</span> <span class="nv">$category</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;admin.categories.edit&#39;</span><span class="p">,</span> <span class="nx">compact</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Update the specified resource in storage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  \Illuminate\Http\Request  $request
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">update</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">Category</span> <span class="nv">$category</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Remove the specified resource from storage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">destroy</span><span class="p">(</span><span class="nx">Category</span> <span class="nv">$category</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Creo las vistas de dichos métodos (index, show, edit y create) <code>resources/views/admin/categories/index.blade.php</code>, <code>resources/views/admin/categories/show.blade.php</code>, <code>resources/views/admin/categories/edit.blade.php</code> y <code>resources/views/admin/categories/create.blade.php</code> y extiendo la plantilla adminLTE a cada una de ellas. Por ejemplo:</p>
<p><strong>create.blade.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">@</span><span class="k">extends</span><span class="p">(</span><span class="s1">&#39;adminlte::page&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog con Laravel&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content_header&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Crear</span> <span class="nx">categoría</span><span class="o">&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Aqui</span> <span class="nx">va</span> <span class="nx">un</span> <span class="nx">formulario</span> <span class="nx">para</span> <span class="nx">Crear</span> <span class="nx">categoria</span><span class="o">.&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;css&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/css/admin_custom.css&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;js&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span> <span class="nx">console</span><span class="o">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hi!&#39;</span><span class="p">);</span> <span class="o">&lt;/</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Quiero empezar mostrando el listado de las categorías en una tabla. Para ello modifico la plantilla <code>resources/views/admin/categories/index.blade.php</code> y el método index del controlador <code>CategoryController.php</code>.</p>
<p><strong>método index de CategoryController.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Display a listing of the resource.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$categories</span> <span class="o">=</span> <span class="nx">Category</span><span class="o">::</span><span class="na">all</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;admin.categories.index&#39;</span><span class="p">,</span> <span class="nx">compact</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>index.blade.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">@</span><span class="k">extends</span><span class="p">(</span><span class="s1">&#39;adminlte::page&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog con Laravel&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content_header&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Lista</span> <span class="nx">de</span> <span class="nx">categorías</span><span class="o">.&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Aqui</span> <span class="nx">aparece</span> <span class="nx">un</span> <span class="nx">listado</span> <span class="nx">de</span> <span class="nx">categorías</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card-header&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; btn btn-secondary float-right&#34;</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;{{route(&#39;admin.categories.create&#39;)}}&#34;</span><span class="o">&gt;</span><span class="nx">Crear</span> <span class="nx">Categoría</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">table</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; table table-striped&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">thead</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Id</span><span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Nombre</span><span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span> <span class="nx">colspan</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">thead</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">tbody</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="k">foreach</span> <span class="p">(</span><span class="nv">$categories</span> <span class="k">as</span> <span class="nv">$category</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$category</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$category</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&#34;10px&#34;</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; btn btn-primary btn-sm&#34;</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;{{route(&#39;admin.categories.edit&#39;, </span><span class="si">$category</span><span class="s2">)}}&#34;</span><span class="o">&gt;</span><span class="nx">Editar</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&#34;10px&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                            <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">action</span><span class="o">=</span><span class="s2">&#34;{{route(&#39;admin.categories.destroy&#39;, </span><span class="si">$category</span><span class="s2">)}}&#34;</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;POST&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                                <span class="o">@</span><span class="nx">csrf</span>
</span></span><span class="line"><span class="cl">                                <span class="o">@</span><span class="nx">method</span><span class="p">(</span><span class="s1">&#39;delete&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;btn btn-danger btn-sm&#34;</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;submit&#34;</span><span class="o">&gt;</span><span class="nx">Eliminar</span><span class="o">&lt;/</span><span class="nx">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                            <span class="o">&lt;/</span><span class="nx">form</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">@</span><span class="k">endforeach</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">tbody</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;/</span><span class="nx">table</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;css&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/css/admin_custom.css&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;js&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>En esta vista he creado una tabla dentro de la que listo las categorías por su id y su nombre. Le añado a cada una un botón para editarla que me dirige a ala vista <code>edit.blade.php</code> y otro botón mediante un formulario que me permite utilizar la ruta <code>admin.categories.destroy</code> y el método <code>destroy</code> del controlador. Este formulario lo envío usando el método <code>delete</code> que recomienda laravel para lo cual debo incluir <code>@method('delete')</code>en el formulario.</p>
<p>También he creado un botón para crear una nueva categoría que me redirige mediante la ruta <code>admmin.categories.create</code> a la vista <code>create.blade.php</code> donde un formulario me permite crear una nueva categoría. La vista <code>index.blade.php</code> se ve así.</p>
<figure><img src="/images/post/blog_laravel/17.png"/>
</figure>

<p>Para crear los formularios del blog me voy a ayudar de un componente de laravel llamado <a href="https://laravelcollective.com/docs/6.x/html">laravelcollective</a> cuyo sitio web me indica en su sección <code>docs</code> que para poder usar el paquete debo usando composer desde la linea de comandos y escribir el siguiente comando:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">enrique@enrique-server:/var/www/laravel/blog_laravel$ composer require laravelcollective/html
</span></span><span class="line"><span class="cl">Using version ^6.2 <span class="k">for</span> laravelcollective/html
</span></span><span class="line"><span class="cl">./composer.json has been updated
</span></span><span class="line"><span class="cl">Running composer update laravelcollective/html
</span></span><span class="line"><span class="cl">Loading composer repositories with package information
</span></span><span class="line"><span class="cl">Updating dependencies
</span></span><span class="line"><span class="cl">Lock file operations: <span class="m">1</span> install, <span class="m">0</span> updates, <span class="m">0</span> removals
</span></span><span class="line"><span class="cl">  - Locking laravelcollective/html <span class="o">(</span>v6.2.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">Writing lock file
</span></span><span class="line"><span class="cl">Installing dependencies from lock file <span class="o">(</span>including require-dev<span class="o">)</span>
</span></span><span class="line"><span class="cl">Package operations: <span class="m">1</span> install, <span class="m">0</span> updates, <span class="m">0</span> removals
</span></span><span class="line"><span class="cl">  - Downloading laravelcollective/html <span class="o">(</span>v6.2.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">  - Installing laravelcollective/html <span class="o">(</span>v6.2.1<span class="o">)</span>: Extracting archive
</span></span><span class="line"><span class="cl">Generating optimized autoload files
</span></span><span class="line"><span class="cl">&gt; Illuminate<span class="se">\F</span>oundation<span class="se">\C</span>omposerScripts::postAutoloadDump
</span></span><span class="line"><span class="cl">&gt; @php artisan package:discover --ansi
</span></span><span class="line"><span class="cl">Discovered Package: facade/ignition
</span></span><span class="line"><span class="cl">Discovered Package: fideloper/proxy
</span></span><span class="line"><span class="cl">Discovered Package: fruitcake/laravel-cors
</span></span><span class="line"><span class="cl">Discovered Package: jenssegers/agent
</span></span><span class="line"><span class="cl">Discovered Package: jeroennoten/laravel-adminlte
</span></span><span class="line"><span class="cl">Discovered Package: laravel/fortify
</span></span><span class="line"><span class="cl">Discovered Package: laravel/jetstream
</span></span><span class="line"><span class="cl">Discovered Package: laravel/sail
</span></span><span class="line"><span class="cl">Discovered Package: laravel/sanctum
</span></span><span class="line"><span class="cl">Discovered Package: laravel/tinker
</span></span><span class="line"><span class="cl">Discovered Package: laravelcollective/html
</span></span><span class="line"><span class="cl">Discovered Package: livewire/livewire
</span></span><span class="line"><span class="cl">Discovered Package: nesbot/carbon
</span></span><span class="line"><span class="cl">Discovered Package: nunomaduro/collision
</span></span><span class="line"><span class="cl">Package manifest generated successfully.
</span></span><span class="line"><span class="cl"><span class="m">75</span> packages you are using are looking <span class="k">for</span> funding.
</span></span><span class="line"><span class="cl">Use the <span class="sb">`</span>composer fund<span class="sb">`</span> <span class="nb">command</span> to find out more!
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ahora ya puedo ir a  <code>resources/views/admin/categories/create.blade.php</code> y crear el formulario.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">@</span><span class="k">extends</span><span class="p">(</span><span class="s1">&#39;adminlte::page&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog con Laravel&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content_header&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Crear</span> <span class="nx">categoría</span><span class="o">&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Aqui</span> <span class="nx">va</span> <span class="nx">un</span> <span class="nx">formulario</span> <span class="nx">para</span> <span class="nx">Crear</span> <span class="nx">categoria</span><span class="o">.&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">open</span><span class="p">([</span><span class="s1">&#39;route&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;admin.categories.store&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el nombre de la categoria&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="s1">&#39;Slug&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el slug de la categoria&#39;</span><span class="p">,</span> <span class="s1">&#39;readonly&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">submit</span><span class="p">(</span><span class="s1">&#39;Crear categoría&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;btn btn-primary&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">close</span><span class="p">()</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Para automatizar la creación del slug voy a utilizar un pluging de JQuery, de manera que el usuario no tenga que escribir nada y evitar errores.</p>
<p>Lo descargo en la carpeta <code>public/vendor</code> desde su página web.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">enrique@enrique-server:/var/www/laravel/blog_laravel/public/vendor$ wget https://github.com/leocaseiro/jQuery-Plugin-stringToSlug/archive/1.3.zip
</span></span><span class="line"><span class="cl">--2021-01-14 15:34:04--  https://github.com/leocaseiro/jQuery-Plugin-stringToSlug/archive/1.3.zip
</span></span><span class="line"><span class="cl">Resolving github.com <span class="o">(</span>github.com<span class="o">)</span>... 140.82.121.4
</span></span><span class="line"><span class="cl">Connecting to github.com <span class="o">(</span>github.com<span class="o">)</span><span class="p">|</span>140.82.121.4<span class="p">|</span>:443... connected.
</span></span><span class="line"><span class="cl">HTTP request sent, awaiting response... <span class="m">302</span> Found
</span></span><span class="line"><span class="cl">Location: https://codeload.github.com/leocaseiro/jQuery-Plugin-stringToSlug/zip/1.3 <span class="o">[</span>following<span class="o">]</span>
</span></span><span class="line"><span class="cl">--2021-01-14 15:34:04--  https://codeload.github.com/leocaseiro/jQuery-Plugin-stringToSlug/zip/1.3
</span></span><span class="line"><span class="cl">Resolving codeload.github.com <span class="o">(</span>codeload.github.com<span class="o">)</span>... 140.82.121.10
</span></span><span class="line"><span class="cl">Connecting to codeload.github.com <span class="o">(</span>codeload.github.com<span class="o">)</span><span class="p">|</span>140.82.121.10<span class="p">|</span>:443... connected.
</span></span><span class="line"><span class="cl">HTTP request sent, awaiting response... <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">Length: unspecified <span class="o">[</span>application/zip<span class="o">]</span>
</span></span><span class="line"><span class="cl">Saving to: ‘1.3.zip’
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">1.3.zip                                              <span class="o">[</span> &lt;<span class="o">=</span>&gt;                                                                                                      <span class="o">]</span>  27.88K  --.-KB/s    in 0.09s   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2021-01-14 15:34:05 <span class="o">(</span><span class="m">312</span> KB/s<span class="o">)</span> - ‘1.3.zip’ saved <span class="o">[</span>28544<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>lo descomprimo</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">enrique@enrique-server:/var/www/laravel/blog_laravel/public/vendor$ unzip 1.3.zip 
</span></span><span class="line"><span class="cl">Archive:  1.3.zip
</span></span><span class="line"><span class="cl">b553fe235853f0afb4fcfa2b5d08d9381a274e7e
</span></span><span class="line"><span class="cl">   creating: jQuery-Plugin-stringToSlug-1.3/
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/README.md  
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/jquery.StringToSlug.jquery.json  
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.js  
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js  
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/samples.html  
</span></span><span class="line"><span class="cl">   creating: jQuery-Plugin-stringToSlug-1.3/tests/
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/tests/index.html  
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/tests/minimal-test.html  
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/tests/qunit.css  
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/tests/qunit.js  
</span></span><span class="line"><span class="cl">  inflating: jQuery-Plugin-stringToSlug-1.3/tests/tests.js 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Creo una sección <code>js</code> debajo de la sección <code>content</code> y copio dos script, uno para importar el archivo  <code>jquery.stringToSlug.min.js</code> y otra donde escribo el código que relaciona los inputs de name y slug.</p>
<p><strong>create.blade.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">@</span><span class="k">extends</span><span class="p">(</span><span class="s1">&#39;adminlte::page&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog con Laravel&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content_header&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Crear</span> <span class="nx">categoría</span><span class="o">&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Aqui</span> <span class="nx">va</span> <span class="nx">un</span> <span class="nx">formulario</span> <span class="nx">para</span> <span class="nx">Crear</span> <span class="nx">categoria</span><span class="o">.&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">open</span><span class="p">([</span><span class="s1">&#39;route&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;admin.categories.store&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el nombre de la categoria&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="s1">&#39;Slug&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el slug de la categoria&#39;</span><span class="p">,</span> <span class="s1">&#39;readonly&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">submit</span><span class="p">(</span><span class="s1">&#39;Crear categoría&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;btn btn-primary&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">close</span><span class="p">()</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;js&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&#34;{{asset(&#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js&#39;)}}&#34;</span><span class="o">&gt;&lt;/</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="err">$</span><span class="p">(</span><span class="nx">document</span><span class="p">)</span><span class="o">.</span><span class="nx">ready</span><span class="p">(</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="err">$</span><span class="p">(</span><span class="s2">&#34;#name&#34;</span><span class="p">)</span><span class="o">.</span><span class="nx">stringToSlug</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                <span class="nx">setEvents</span><span class="o">:</span> <span class="s1">&#39;keyup keydown blur&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">getPut</span><span class="o">:</span> <span class="s1">&#39;#slug&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">space</span><span class="o">:</span> <span class="s1">&#39;-&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">endsection</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Al hacer clic en el botón de <code>submit</code> los datos del formulario se envían por la ruta <code>admin.categories.store</code>al método <code>store</code> del controlador <code>CategoryController.php</code>. En este método valido los datos y los almaceno en la tabla <code>categories</code> de la base de datos. Dedo habilitar la asignación masiva en el modelo <code>app/Models/Category.php</code>. Para lo cual declaro la propiedad <code>fillable</code> dentro de la entidad <code>Category.php</code>.</p>
<p><strong>Category.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">App\Models</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Factories\HasFactory</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Category</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">use</span> <span class="nx">HasFactory</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$fillable</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;slug&#39;</span><span class="p">];</span> <span class="c1">//habilito la asignación masiva en name y slug
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Relaccion uno a muchos posts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">posts</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">Post</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ambos campos son requeridos y ademas el campo slug debe de ser único en la tabla <code>categorias</code>.</p>
<p><strong>CategoryController.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">......</span>
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Store a newly created resource in storage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  \Illuminate\Http\Request  $request
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">store</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;slug&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|unique:categories&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">Category</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">redirect</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;admin.categories.index&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">.....</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Inserto los posibles errores de validación (dentro de la directiva de blade @error) de los campos name y slug en la vista</p>
<p><strong>create.blade.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">..........</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Aqui</span> <span class="nx">va</span> <span class="nx">un</span> <span class="nx">formulario</span> <span class="nx">para</span> <span class="nx">Crear</span> <span class="nx">categoría</span><span class="o">.&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">open</span><span class="p">([</span><span class="s1">&#39;route&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;admin.categories.store&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el nombre de la categoria&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; text-danger&#34;</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$message</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">enderror</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="s1">&#39;Slug&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el slug de la categoria&#39;</span><span class="p">,</span> <span class="s1">&#39;readonly&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; text-danger&#34;</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$message</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">enderror</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">submit</span><span class="p">(</span><span class="s1">&#39;Crear categoría&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;btn btn-primary&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">close</span><span class="p">()</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl"><span class="o">..........</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Compruebo el funcionamiento del formulario para crear una categoría haciendo clic en el botón <code>crear categoría</code> de  la lista de categorias. Aparece una vista donde puedo crear una nueva categoría.</p>
<figure><img src="/images/post/blog_laravel/18.png"/>
</figure>

<p>Al rellenar el campo de nombre, se auto rellena el de slug y al hacer clic en el botón <code>Crear categoría</code> se validan los campos antes de crear el registro en la tabla, si hay errores en algún campo se muestran debajo de el.</p>
<figure><img src="/images/post/blog_laravel/19.png"/>
</figure>

<p>Si la validación ha sido correcta, guarda el registro en la tabla <code>categories</code> y me redirige al listado de categorías.</p>
<figure><img src="/images/post/blog_laravel/20.png"/>
</figure>

<p><strong>Actualizar o editar un registro</strong></p>
<p>Hago clic en el boton <code>editar</code> de una categoria cualquiera y la ruta <code>admin.categories.edit</code> me dirige al método <code>edit</code> del controllador el cual pasa a la vista <code>edit.blade.php</code> el objeto almacenado en la variable <code>$category</code> para mostrarlo en el formulario de la vista en el que se va a editar sus campos. Me baso en el formulario realizado para  la vista <code>create.blade.php</code> y lo modifico.</p>
<p><strong>edit.blade.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">@</span><span class="k">extends</span><span class="p">(</span><span class="s1">&#39;adminlte::page&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog con Laravel&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content_header&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Edita</span> <span class="nx">una</span> <span class="nx">categoría</span><span class="o">.&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Editar</span> <span class="nx">detalle</span> <span class="nx">de</span> <span class="nx">la</span> <span class="nx">categoría</span><span class="o">.&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">model</span><span class="p">(</span><span class="nv">$category</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;route&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;admin.categories.update&#39;</span><span class="p">,</span> <span class="nv">$category</span><span class="p">],</span> <span class="s1">&#39;method&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;put&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el nombre de la categoría&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; text-danger&#34;</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$message</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">enderror</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="s1">&#39;Slug&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el slug de la categoría&#39;</span><span class="p">,</span> <span class="s1">&#39;readonly&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; text-danger&#34;</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$message</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">enderror</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">submit</span><span class="p">(</span><span class="s1">&#39;Actualizar categoría&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;btn btn-primary&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">close</span><span class="p">()</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;js&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&#34;{{asset(&#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js&#39;)}}&#34;</span><span class="o">&gt;&lt;/</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="err">$</span><span class="p">(</span><span class="nx">document</span><span class="p">)</span><span class="o">.</span><span class="nx">ready</span><span class="p">(</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="err">$</span><span class="p">(</span><span class="s2">&#34;#name&#34;</span><span class="p">)</span><span class="o">.</span><span class="nx">stringToSlug</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                <span class="nx">setEvents</span><span class="o">:</span> <span class="s1">&#39;keyup keydown blur&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">getPut</span><span class="o">:</span> <span class="s1">&#39;#slug&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">space</span><span class="o">:</span> <span class="s1">&#39;-&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">endsection</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>El método utilizado para enviar este formulario es el método <code>put</code> y la ruta debe de ser <code>admin.categories.update</code> a la que debo pasar como parámetro <code>$category</code>. Para rellenar los campos con los datos de la categoría a editar para ello cambio <code>Form::open</code> por <code>Form::model</code> y le paso la variable <code>$category</code>. Quedaría así: <code>{!! Form::model($category, ['route' =&gt; ['admin.categories.update', $category], 'method' =&gt; 'put']) !!}</code>.</p>
<p>Si hago clic en el botón <code>actualizar categoría</code> la información del formulario se envía a la ruta <code>admin.categories.update</code>que es administrada por el método <code>update</code> del controlador <code>CategoryController.php</code>. En este método valido la información recibida y si pasa la validación la actualizo en la base de datos y que me redireccione a la ruta <code>admin.categories.edit</code>. Además quiero que ignore el <code>slug</code> del registro que quiero actualizar (cambio <code>'required|unique:categories'</code> por <code>&quot;required|unique:categories,slug,$category-&gt;id&quot;</code> ignorando el slug de la categoría que quiero actualizar).</p>
<p>Por último quiero que se muestre una alerta indicando que se ha actualizado el registro con éxito. Lo condigo enviando un mensaje de sesión (<code>with('info', 'La categoría se actualizó con éxito.')</code>) que debo de recoger la vista <code>admin.categories.edit</code>.</p>
<p><strong>Método update de CategoryController.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">........</span>
</span></span><span class="line"><span class="cl">	<span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Update the specified resource in storage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  \Illuminate\Http\Request  $request
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">update</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">Category</span> <span class="nv">$category</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;slug&#39;</span> <span class="o">=&gt;</span> <span class="s2">&#34;required|unique:categories,slug,</span><span class="si">$category-&gt;id</span><span class="s2">&#34;</span> <span class="c1">//ignora el slug de la categoria que quiero actualizar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$category</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">redirect</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;admin.categories.edit&#39;</span><span class="p">,</span> <span class="nv">$category</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;La categoría se actualizó con éxito.&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">.........</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>edit.blade.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Editar</span> <span class="nx">detalle</span> <span class="nx">de</span> <span class="nx">la</span> <span class="nx">categoría</span><span class="o">.&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="k">if</span> <span class="p">(</span><span class="nx">session</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; alert alert-success&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">strong</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">session</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">)}}</span><span class="o">&lt;/</span><span class="nx">strong</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="k">endif</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">model</span><span class="p">(</span><span class="nv">$category</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;route&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;admin.categories.update&#39;</span><span class="p">,</span> <span class="nv">$category</span><span class="p">],</span> <span class="s1">&#39;method&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;put&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el nombre de la categoría&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; text-danger&#34;</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$message</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">enderror</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;form-group&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="s1">&#39;Slug&#39;</span><span class="p">)</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">text</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ingresa el slug de la categoría&#39;</span><span class="p">,</span> <span class="s1">&#39;readonly&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; text-danger&#34;</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$message</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="nx">enderror</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">submit</span><span class="p">(</span><span class="s1">&#39;Actualizar categoría&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;btn btn-primary&#39;</span><span class="p">])</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">!!</span> <span class="nx">Form</span><span class="o">::</span><span class="na">close</span><span class="p">()</span> <span class="o">!!</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><img src="/images/post/blog_laravel/21.png"/>
</figure>

<p>Esta alerta se puede crear en el método store para que se muestre en la plantilla index al crear una categoría nueva.</p>
<figure><img src="/images/post/blog_laravel/22.png"/>
</figure>

<p><strong>Eliminar una categoría</strong></p>
<p>Si hago clic en el botón <code>eliminar</code> la información de la categoría  se envía a la ruta <code>admin.categories.destroy</code>que es administrada por el método <code>destroy</code> del controlador <code>CategoryController.php</code>. En este método  elimino el registro en la base de datos y que me redirecciona a la ruta <code>admin.categories.index</code> donde me muestra una alerta de borrado del registro.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Remove the specified resource from storage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     *
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @param  int  $id
</span></span></span><span class="line"><span class="cl"><span class="sd">     * @return \Illuminate\Http\Response
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">destroy</span><span class="p">(</span><span class="nx">Category</span> <span class="nv">$category</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$category</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">redirect</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;admin.categories.index&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;info-del&#39;</span><span class="p">,</span> <span class="s1">&#39;La categoría se ha eliminado con éxito&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>En la vista añado una condición al if para que recoja la variable de sesión <code>infodel</code> y muestre la alerta de borrado de la categoría.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">@</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Aqui</span> <span class="nx">aparecerán</span> <span class="nx">las</span> <span class="nx">categorías</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="k">if</span> <span class="p">(</span><span class="nx">session</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; alert alert-success&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">strong</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">session</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">)}}</span><span class="o">&lt;/</span><span class="nx">strong</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="k">elseif</span><span class="p">(</span><span class="nx">session</span><span class="p">(</span><span class="s1">&#39;info-del&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; alert alert-danger&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">strong</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">session</span><span class="p">(</span><span class="s1">&#39;info-del&#39;</span><span class="p">)}}</span><span class="o">&lt;/</span><span class="nx">strong</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="k">endif</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card-header&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; btn btn-secondary&#34;</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;{{route(&#39;admin.categories.create&#39;)}}&#34;</span><span class="o">&gt;</span><span class="nx">Crear</span> <span class="nx">Categoría</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;card-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">table</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; table table-striped&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">thead</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Id</span><span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Nombre</span><span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span> <span class="nx">colspan</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">thead</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="nx">tbody</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="k">foreach</span> <span class="p">(</span><span class="nv">$categories</span> <span class="k">as</span> <span class="nv">$category</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$category</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="p">{{</span><span class="nv">$category</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">}}</span><span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&#34;10px&#34;</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34; btn btn-primary btn-sm&#34;</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;{{route(&#39;admin.categories.edit&#39;, </span><span class="si">$category</span><span class="s2">)}}&#34;</span><span class="o">&gt;</span><span class="nx">Editar</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;</span><span class="nx">th</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&#34;10px&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                            <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">action</span><span class="o">=</span><span class="s2">&#34;{{route(&#39;admin.categories.destroy&#39;, </span><span class="si">$category</span><span class="s2">)}}&#34;</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;POST&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                                <span class="o">@</span><span class="nx">csrf</span>
</span></span><span class="line"><span class="cl">                                <span class="o">@</span><span class="nx">method</span><span class="p">(</span><span class="s1">&#39;delete&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;btn btn-danger btn-sm&#34;</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;submit&#34;</span><span class="o">&gt;</span><span class="nx">Eliminar</span><span class="o">&lt;/</span><span class="nx">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                            <span class="o">&lt;/</span><span class="nx">form</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">&lt;/</span><span class="nx">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">@</span><span class="k">endforeach</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="nx">tbody</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;/</span><span class="nx">table</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">stop</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Pantalla después de haber borrado una categoría.</p>
<figure><img src="/images/post/blog_laravel/23.png"/>
</figure>

<p><strong>URL amigables en categorías</strong></p>
<p>Para que el la url no aparezca el id de la categoría  sino su lug debo crear un método <code>getRouteKeyName</code> en el modelo <code>app/Models/Category.php</code></p>
<p><strong>Category.php</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">App\Models</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Factories\HasFactory</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Category</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">use</span> <span class="nx">HasFactory</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$fillable</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;slug&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getRouteKeyName</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;slug&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// Relaccion uno a muchos posts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">posts</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">Post</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ahora ya muestra el slug como se puede apreciar el la siguiente imagen.</p>
<figure><img src="/images/post/blog_laravel/24.png"/>
</figure>


            </div>
            
                <div class="tags">
                    
                    <span class="down-type-item">
                        <div class="type-text">
                            <a href='
                                        /tags/larabel
                                    '>
                                <i class="fa fa-tag"></i> Larabel
                            </a>
                        </div>
                    </span>
                    
                    <span class="down-type-item">
                        <div class="type-text">
                            <a href='
                                        /tags/blog
                                    '>
                                <i class="fa fa-tag"></i> Blog
                            </a>
                        </div>
                    </span>
                    
                </div>
            
        </div>
        
            
                <div class="pre-next">
                    
    
        
        <a href="https://esaborit.github.io/posts/adminlte_en_el_proyecto/" class="pre">
            <span class="pre-icon"><i class="fa fa-hand-o-left"></i></span>
            <div class="pre-title-root">
                <span>Creando el backend del blog -VI </span>
            </div>
        </a>
        

        
        <a href="https://esaborit.github.io/posts/crud_etiquetas/" class="next">
            <div class="next-title-root">
                <span>Creando el crud de etiquetas - VIII </span>
            </div>
            <span class="next-icon"><i class="fa fa-hand-o-right"></i></span>
        </a>
        

    
    

                </div>
            
        
    
</div>

    


            </div>
            <div class="zhuti-r">
                
<div class="zhuti-r-0">
    <div class="zhuti-r-1">
        
        <div id="r1">
            

<div class="about-zuozhe">
    <div class="zuozhe">
        
            <div class="datou">
                <img class="lazyload" src="/images/thumbnail.gif" data-src="/images/santanderb.jpg" alt="">
            </div>
        
        <div class="name-jianjie">
            <div class="name">ESC</div>
            <div class="jianjie">
                «No se puede enseñar nada a un hombre; sólo se le puede ayudar a encontrar la respuesta dentro de sí mismo». Galileo Galilei (1564 - 1642)
            </div>
        </div>
    </div>

    <div class="type">
        <a href='
                    /posts/
                '>
            
            <p>Artículos</p>
            <p>29</p>
        </a>
        <a href='
                    /categories/
                '>
            
            <p>Categorias</p>
            <p>14</p>
        </a>
        <a href='
                    /tags/
                '>
            
            <p>Etiquetas</p>
            <p>27</p>
        </a>
    </div>

    
    <div class="link">
        
        <a href="https://github.com/esaborit" class="link-item is-hidden-desktop" title="GitHub">
            <span class="icon"><i class='fa fa-github'></i></span>
        </a>
        
        <a href="https://gitlab.com/esaborit" class="link-item is-hidden-desktop" title="Gitlab">
            <span class="icon"><i class='fa fa-gitlab'></i></span>
        </a>
        
    </div>
</div>

            <div class="mulu">
    <div class="dong"></div>
    <div class="zhi">
        <div class="wenzi">
            <div class="zhi-mulu text-wbd">Tabla de contenidos</div>
            <div class="mulu-items">
            </div>
        </div>
    </div>
</div>
            



    
    


<div class="other">
    <div class="other-up">
        <div class="other-qita text-wbd">Artículos relacionados</div>
        <div class="xian"></div>
    </div>
    <div class="list">
        
            <a href="https://esaborit.github.io/posts/crud_post/">
                
<a href="https://esaborit.github.io/posts/crud_post/">
    <div class="list-item">
        <div class="icon-other-root">
            
                <div class="icon-other" style="background-image: url( /images/post/blog_laravel/blog_laravel.jpg );"></div>
            
        </div>
        <div class="list-right">
            <div class="other-title">
                Creando el crud de posts - IX 
            </div>
            <div class="other-summary">Creando un crud para los post del blog Creo el controlador con los siete métodos
1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller Admin/PostController -r Controller created successfully. Lo modifico para recibir objetos post y las vistas a los métodos correspondientes.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 &lt;?</div>
            <div class="other-date">2021-2-3</div>
        </div>
    </div>
</a>
            </a>
        
            <a href="https://esaborit.github.io/posts/crud_etiquetas/">
                
<a href="https://esaborit.github.io/posts/crud_etiquetas/">
    <div class="list-item">
        <div class="icon-other-root">
            
                <div class="icon-other" style="background-image: url( /images/post/blog_laravel/blog_laravel.jpg );"></div>
            
        </div>
        <div class="list-right">
            <div class="other-title">
                Creando el crud de etiquetas - VIII 
            </div>
            <div class="other-summary">Creando un crud para las etiquetas del blog Sigo los mismos pasos que para las categorias.
Desde la consola de comandos y situado dentro del proyecto creo el controlador con sus 7 métodos para administrar las etiquetas desde el backend.
1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controler Admin/TagController -r Controller created successfully.</div>
            <div class="other-date">2021-1-31</div>
        </div>
    </div>
</a>
            </a>
        
            <a href="https://esaborit.github.io/posts/adminlte_en_el_proyecto/">
                
<a href="https://esaborit.github.io/posts/adminlte_en_el_proyecto/">
    <div class="list-item">
        <div class="icon-other-root">
            
                <div class="icon-other" style="background-image: url( /images/post/blog_laravel/blog_laravel.jpg );"></div>
            
        </div>
        <div class="list-right">
            <div class="other-title">
                Creando el backend del blog -VI 
            </div>
            <div class="other-summary">Integrando AdminLTE en el proyecto Para la gestión de la parte administrativa voy a usar el paquete AdminLTE 3
Voy a generar una url llamada admin que utilizaré para desarrollar la parte de administración del blog. Esta url no la voy a declarar en el fichero web.php sino que creo uno nuevo llamado routes/admin.</div>
            <div class="other-date">2021-1-29</div>
        </div>
    </div>
</a>
            </a>
        
            <a href="https://esaborit.github.io/posts/mostrando_y_filtrando_posts/">
                
<a href="https://esaborit.github.io/posts/mostrando_y_filtrando_posts/">
    <div class="list-item">
        <div class="icon-other-root">
            
                <div class="icon-other" style="background-image: url( /images/post/blog_laravel/blog_laravel.jpg );"></div>
            
        </div>
        <div class="list-right">
            <div class="other-title">
                Mostrando y filtrando posts - V
            </div>
            <div class="other-summary">Mostrando el detalle de un post Creo una ruta en web.php para mostrar el detalle de un post.
web.php
1 Route::get(&#39;posts/{post}&#39;, [PostController::class, &#39;show&#39;])-&gt;name(&#39;posts.show&#39;); Creo en método show en el controllador PostController.php al que le paso como parámetro un objeto post. Dentro de el recupero los post que pertenecen a la misma categoría que el en la variable $similares y se los paso junto con la variable $post a la vista posts.</div>
            <div class="other-date">2021-1-28</div>
        </div>
    </div>
</a>
            </a>
        
            <a href="https://esaborit.github.io/posts/listado_de_posts_en_la_pagina_principal/">
                
<a href="https://esaborit.github.io/posts/listado_de_posts_en_la_pagina_principal/">
    <div class="list-item">
        <div class="icon-other-root">
            
                <div class="icon-other" style="background-image: url( /images/post/blog_laravel/blog_laravel.jpg );"></div>
            
        </div>
        <div class="list-right">
            <div class="other-title">
                Crear un listado de post en la página principal - IV
            </div>
            <div class="other-summary">Listado de posts Voy a mostrar un listado con los pos almacenados en la base de datos, para ello debo empezar creando un controlador en el que recogeré una variable con los post y desde donde llamar a una vista para mostrarlos. Creo un controlador llamado PostController.
1 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller PostController entro en la clase app/Http/Controllers/PostController.</div>
            <div class="other-date">2021-1-28</div>
        </div>
    </div>
</a>
            </a>
        
    </div>
</div>
        </div>
        <div id="r2">
            
        </div> 
    </div>
</div>

            </div>
        </div>
    </div>
</div>


        </div>

        <footer class="footer">
    
        <div class="container">
            <div class="footer-items">
                
                
                    <div class="footer-item">
                        © 2020-2023 <a href="https://github.com/esaborit">ESC</a>
                    </div>
                
                
            </div>
        </div>
    

    
</footer>


        
        <div class="search-root">
    <div class="search-zz"></div>
    <div class="search">
        <div class="sheader anniu">
            <div class="sh-l">
                <input type="text" placeholder='Introduzca una palabra clave' id="search-key">
                <span class="sclear"><i class="fa fa-close"></i></span>
            </div>
            <div class="sh-r">
                <button>Búsqueda</button>
            </div>
        </div>
        <div class="sbody">
            <div class="sbody-1">
                <div class="stip"></div>
            </div>
        </div>
    </div>
</div>
        









    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    


<script type="text/javascript">
    var mode_custom = "auto";
    var postsCount =  29 ;
    var arrPosts = [{"link":"https://esaborit.github.io/posts/crud_post/","plain":"Creando un crud para los post del blog Creo el controlador con los siete métodos\n1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller Admin/PostController -r Controller created successfully. Lo modifico para recibir objetos post y las vistas a los métodos correspondientes.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 \u0026lt;?php namespace App\\Http\\Controllers\\Admin; use App\\Http\\Controllers\\Controller; use App\\Models\\Post; use Illuminate\\Http\\Request; class PostController extends Controller { /** * Display a listing of the resource. * * @return \\Illuminate\\Http\\Response */ public function index() { return view(\u0026#39;admin.posts.index\u0026#39;); } /** * Show the form for creating a new resource. * * @return \\Illuminate\\Http\\Response */ public function create() { return view(\u0026#39;admin.posts.create\u0026#39;); } /** * Store a newly created resource in storage. * * @param \\Illuminate\\Http\\Request $request * @return \\Illuminate\\Http\\Response */ public function store(Request $request) { // } /** * Display the specified resource. * * @param App\\Models\\Post $post * @return \\Illuminate\\Http\\Response */ public function show(Post $post) { return view(\u0026#39;admin.posts.show\u0026#39;, compact(\u0026#39;post\u0026#39;)); } /** * Show the form for editing the specified resource. * * @param App\\Models\\Post $post * @return \\Illuminate\\Http\\Response */ public function edit(Post $post) { return view(\u0026#39;admin.posts.edit\u0026#39;, compact(\u0026#39;post\u0026#39;)); } /** * Update the specified resource in storage. * * @param \\Illuminate\\Http\\Request $request * @param App\\Models\\Post $post * @return \\Illuminate\\Http\\Response */ public function update(Request $request, Post $post) { // } /** * Remove the specified resource from storage. * * @param App\\Models\\Post $post * @return \\Illuminate\\Http\\Response */ public function destroy(Post $post) { // } } Creo la ruta dentro del archivo routes/admin.php\n1 2 3 4 5 6 7 8 9 10 use App\\Http\\Controllers\\Admin\\CategoryController; use App\\Http\\Controllers\\Admin\\HomeController; use App\\Http\\Controllers\\Admin\\PostController; use App\\Http\\Controllers\\Admin\\TagController; use Illuminate\\Support\\Facades\\Route; Route::get(\u0026#39;\u0026#39;, [HomeController::class, \u0026#39;index\u0026#39;])-\u0026gt;name(\u0026#39;admin.home\u0026#39;); Route::resource(\u0026#39;categories\u0026#39;, CategoryController::class)-\u0026gt;names(\u0026#39;admin.categories\u0026#39;); Route::resource(\u0026#39;tags\u0026#39;, TagController::class)-\u0026gt;names(\u0026#39;admin.tags\u0026#39;); Route::resource(\u0026#39;posts\u0026#39;, PostController::class)-\u0026gt;names(\u0026#39;admin.posts\u0026#39;); Creo las vistas index.blade.php, create.blade.php, show.blade.php y edit.blade.php en la carpeta resources/views/admin/posts y les pego la plantilla de adminLTE3.\nAbro el archivo config/adminlte.php, quiero modificar el menú de navegación de la barra lateral de la izquierda. Para ello dentro de adminlte.php modifico la sección Menu Items para que aparezca un enlace a la vista index de los posts.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 /* |-------------------------------------------------------------------------- | Menu Items |-------------------------------------------------------------------------- | | Here we can modify the sidebar/top navigation of the admin panel. | | For more detailed instructions you can look here: | https://github.com/jeroennoten/Laravel-AdminLTE/#8-menu-configuration | */ \u0026#39;menu\u0026#39; =\u0026gt; [ [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;search\u0026#39;, \u0026#39;search\u0026#39; =\u0026gt; true, \u0026#39;topnav\u0026#39; =\u0026gt; true, ], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;blog\u0026#39;, \u0026#39;url\u0026#39; =\u0026gt; \u0026#39;admin/blog\u0026#39;, \u0026#39;can\u0026#39; =\u0026gt; \u0026#39;manage-blog\u0026#39;, ], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;Dashboard\u0026#39;, \u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.home\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;fas fa-tachometer-alt fa-fw\u0026#39;, ], [\u0026#39;header\u0026#39; =\u0026gt; \u0026#39;ADMINISTRADOR\u0026#39;], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;Categorías\u0026#39;, \u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.categories.index\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;fab fa-fw fa-buffer\u0026#39;, \u0026#39;active\u0026#39; =\u0026gt; [\u0026#39;admin/categories*\u0026#39;], ], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;Etiquetas\u0026#39;, \u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.tags.index\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;fas fa-fw fa-lock\u0026#39;, \u0026#39;active\u0026#39; =\u0026gt; [\u0026#39;admin/tags*\u0026#39;], ], [\u0026#39;header\u0026#39; =\u0026gt; \u0026#39;OPCIONES DEL BLOG\u0026#39;], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;Listado de posts\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;fas fa-fw fa-clipboard\u0026#39;, \u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.posts.index\u0026#39;, ], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;Crear un post\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;fas fa-fw fa-file\u0026#39;, \u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.posts.create\u0026#39;, ], ], Para mostrar el listado de posts quiero utilizar livewire en la plantilla admiLTE para así poder interactuar con el listado sin refrescar la pantalla y dotar lo de un campo de búsqueda que nos filtre los registros por nombre. Para poder usar livewire junto con la plantilla adminLTE debo molificar a true el campo livewire valor de en el archivo de configuración de adminlte.\nadminLTE.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 ........ /* |-------------------------------------------------------------------------- | Livewire |-------------------------------------------------------------------------- | | Here we can enable the Livewire support. | | For more detailed instructions you can look here: | https://github.com/jeroennoten/Laravel-AdminLTE/#93-livewire */ \u0026#39;livewire\u0026#39; =\u0026gt; true, ........ Ahora ya puedo crear un componente de livewire\n1 2 3 4 5 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:livewire Admin/PostsIndex COMPONENT CREATED 🤙 CLASS: app/Http/Livewire/Admin/PostsIndex.php VIEW: resources/views/livewire/admin/posts-index.blade.php Me ha creado una clase app/Http/Livewire/Admin/PostsIndex.php y una vista resources/views/livewire/admin/posts-index.blade.php en las rutas arriba indicadas.\nIncluyo el componente @livewire('admin.posts-index') dentro del archivo resources/views/admin/posts/index.blade.php\nindex.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Listado de posts\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) @livewire(\u0026#39;admin.posts-index\u0026#39;) //Aquí incluyo el componente livewire @stop @section(\u0026#39;css\u0026#39;) \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/css/admin_custom.css\u0026#34;\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script\u0026gt; console.log(\u0026#39;Hi!\u0026#39;); \u0026lt;/script\u0026gt; @stop Escribo un texto de prueba en resources/views/livewire/admin/posts-index.blade.php\nposts-index.blade.php\n1 2 3 \u0026lt;div\u0026gt; Componente de prueba. \u0026lt;/div\u0026gt; El resultado es:\nAbro el archivo de la clase de livewire app/Http/Livewire/Admin/PostsIndex.php y agrego la logica que pasará a la vista resources/views/livewire/admin/posts-index.blade.php. En el almaceno en la variable $posts aquellos post que pertenecen al usuario actualmente logeado ordenados por id de mayor a menor y paginados. Para que la paginación use estilos de bootstrap defino la propiedad $paginationTheme y pido que use WithPagination.\nPostIndex.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 use App\\Models\\Post; use Livewire\\Component; use Livewire\\WithPagination; class PostsIndex extends Component { use WithPagination; //para usar la paginación con livewire protected $paginationTheme = \u0026#34;bootstrap\u0026#34;; //para que livewire use los estilos de bootstrap en vez de tailwind public function render() { $posts = Post::where(\u0026#39;user_id\u0026#39;, auth()-\u0026gt;user()-\u0026gt;id)-\u0026gt;latest(\u0026#39;id\u0026#39;)-\u0026gt;paginate(); return view(\u0026#39;livewire.admin.posts-index\u0026#39;, compact(\u0026#39;posts\u0026#39;)); } } En la vista creo una tabla que lista los posts dentro de una tarjeta y le añado la paginación\nposts-indes.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026lt;div class=\u0026#34; card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;table class=\u0026#34;table table-striped\u0026#34;\u0026gt; \u0026lt;thead\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;Id\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Nombre\u0026lt;/th\u0026gt; \u0026lt;th colspan=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;tbody\u0026gt; @foreach ($posts as $post) \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;{{$post-\u0026gt;id}}\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt;\u0026lt;a class=\u0026#34; btn btn-primary btn-sm\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.posts.edit\u0026#39;, $post)}}\u0026#34;\u0026gt;Editar\u0026lt;/a\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt; \u0026lt;form action=\u0026#34;{{route(\u0026#39;admin.posts.destroy\u0026#39;, $post)}}\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; @csrf @method(\u0026#39;delete\u0026#39;) \u0026lt;button class=\u0026#34;btn btn-danger btn-sm\u0026#34; type=\u0026#34;submit\u0026#34;\u0026gt;Eliminar\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; @endforeach \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/div\u0026gt; {{-- Aqui pongo la paginación--}} \u0026lt;div class=\u0026#34;car-footer\u0026#34;\u0026gt; {{$posts-\u0026gt;links()}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; En la parte superior de la lista de post voy a agregar un buscador en el que al escribir una palabra me seleccione todos los posts que contengan el texto escrito dentro del campo nombre.\nPara ello en app/Http/Livewire/Admin/PostsIndex.php defino una propiedad llamada search que sincronizo con un input que pongo en la vista index.blade.php gracias al componente wire:model = \u0026quot;search\u0026quot; de livewire. La propiedad search la uso dentro de una clausula where para filtrar los post que cumplan esa condición.\nPostIndex.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 use App\\Models\\Post; use Livewire\\Component; use Livewire\\WithPagination; class PostsIndex extends Component { use WithPagination; //para usar la paginación con livwwire protected $paginationTheme = \u0026#34;bootstrap\u0026#34;; //para que livewire use los estilos de bootstrap en vez de tailwind public $search; public function render() { $posts = Post::where(\u0026#39;user_id\u0026#39;, auth()-\u0026gt;user()-\u0026gt;id) -\u0026gt;where(\u0026#39;name\u0026#39;, \u0026#39;LIKE\u0026#39;, \u0026#39;%\u0026#39; . $this-\u0026gt;search . \u0026#39;%\u0026#39;) -\u0026gt;latest(\u0026#39;id\u0026#39;) -\u0026gt;paginate(); return view(\u0026#39;livewire.admin.posts-index\u0026#39;, compact(\u0026#39;posts\u0026#39;)); } } posts-indes.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 \u0026lt;div class=\u0026#34; card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-header\u0026#34;\u0026gt; {{-- Sincronizo el input con la propiedad search de PostIndex.php--}} \u0026lt;input wire:model = \u0026#34;search\u0026#34; class=\u0026#34; form-control\u0026#34; placeholder=\u0026#34;Escriba el nombre de un post\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; @if ($posts-\u0026gt;count()) \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;table class=\u0026#34;table table-striped\u0026#34;\u0026gt; \u0026lt;thead\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;Id\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Nombre\u0026lt;/th\u0026gt; \u0026lt;th colspan=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;tbody\u0026gt; @foreach ($posts as $post) \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;{{$post-\u0026gt;id}}\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt;\u0026lt;a class=\u0026#34; btn btn-primary btn-sm\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.posts.edit\u0026#39;, $post)}}\u0026#34;\u0026gt;Editar\u0026lt;/a\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt; \u0026lt;form action=\u0026#34;{{route(\u0026#39;admin.posts.destroy\u0026#39;, $post)}}\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; @csrf @method(\u0026#39;delete\u0026#39;) \u0026lt;button class=\u0026#34;btn btn-danger btn-sm\u0026#34; type=\u0026#34;submit\u0026#34;\u0026gt;Eliminar\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; @endforeach \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/div\u0026gt; {{-- Aqui pongo la paginación--}} \u0026lt;div class=\u0026#34;car-footer\u0026#34;\u0026gt; {{$posts-\u0026gt;links()}} \u0026lt;/div\u0026gt; @else \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;No hay ninguna coincidencia.\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @endif \u0026lt;/div\u0026gt; Para que me elimine la página de la paginación de la barra de direcciones del navegador web, defino el método updatingSearch que se activa cuando la propiedad search cambia de valor. De esta manera la búsqueda siempre se realiza sobre el listado completo.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 use App\\Models\\Post; use Livewire\\Component; use Livewire\\WithPagination; class PostsIndex extends Component { use WithPagination; //para usar la paginación con livwwire protected $paginationTheme = \u0026#34;bootstrap\u0026#34;; //para que livewire use los estilos de bootstrap en vez de tailwind public $search; public function updatingSearch() // Solo se activa cuando la propiedad search cambia de valor { $this-\u0026gt;resetPage(); } public function render() { $posts = Post::where(\u0026#39;user_id\u0026#39;, auth()-\u0026gt;user()-\u0026gt;id) -\u0026gt;where(\u0026#39;name\u0026#39;, \u0026#39;LIKE\u0026#39;, \u0026#39;%\u0026#39; . $this-\u0026gt;search . \u0026#39;%\u0026#39;) -\u0026gt;latest(\u0026#39;id\u0026#39;) -\u0026gt;paginate(); return view(\u0026#39;livewire.admin.posts-index\u0026#39;, compact(\u0026#39;posts\u0026#39;)); } } Creo el formulario para crear un post En la vista resources/views/admin/posts/index.blade.php agrego un botón que me dirige a la ruta admin.posts.create administrada por el método create del controlador app/Http/controllers/Admin/PostController.php.\nindex.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;a class=\u0026#34;btn btn-secondary btn-m float-right\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.posts.create\u0026#39;)}}\u0026#34;\u0026gt;Crear nuevo post\u0026lt;/a\u0026gt; \u0026lt;h1\u0026gt;Listado de posts\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) @livewire(\u0026#39;admin.posts-index\u0026#39;) @stop @section(\u0026#39;css\u0026#39;) \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/css/admin_custom.css\u0026#34;\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script\u0026gt; console.log(\u0026#39;Hi!\u0026#39;); \u0026lt;/script\u0026gt; @stop Dentro del método create almaceno en dos variables dos arrays, uno con parejas clave, valor de nombre e id de las categorías y otro de objetos tag que se los paso a la vista donde escribiré el código del formulario para crear un post.\nMétodo create de PostController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 ................... /** * Show the form for creating a new resource. * * @return \\Illuminate\\Http\\Response */ public function create() { $categories = Category::pluck(\u0026#39;name\u0026#39;, \u0026#39;id\u0026#39;); //Devuelve un array de parejas clave=\u0026gt;valor (\u0026#39;id\u0026#39;=\u0026gt;\u0026#39;nombre\u0026#39;) $tags = Tag::all();//Devuelve un array de objetos Tag. return view(\u0026#39;admin.posts.create\u0026#39;, compact(\u0026#39;categories\u0026#39;, \u0026#39;tags\u0026#39;)); } ................... Creo el formulario en la vista resources/views/admin/posts/create.blade.php.\ncreate.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Crea un post\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.posts.store\u0026#39;]) !!} \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre: \u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;Escribe el nombre del post\u0026#39;]) !!} \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug: \u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;readonly\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;Escribe el slug del post\u0026#39;]) !!} \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;category_id\u0026#39;, \u0026#39;Categoría: \u0026#39;) !!} {!! Form::select(\u0026#39;category_id\u0026#39;, $categories, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;font-weight-bold\u0026#34;\u0026gt;Etiquetas: \u0026lt;/p\u0026gt; @foreach ($tags as $tag) \u0026lt;label class=\u0026#34;mr-2\u0026#34;\u0026gt; {!! Form::checkbox(\u0026#39;tags[]\u0026#39;, $tag-\u0026gt;id, null) !!} {{--Seleccion multiple en array tags[]--}} {{$tag-\u0026gt;name}} \u0026lt;/label\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;extract\u0026#39;, \u0026#39;Extracto: \u0026#39;) !!} {!! Form::textarea(\u0026#39;extract\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;body\u0026#39;, \u0026#39;Cuerpo del post: \u0026#39;) !!} {!! Form::textarea(\u0026#39;body\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} \u0026lt;/div\u0026gt; {!! Form::submit(\u0026#39;Crear post\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); \u0026lt;/script\u0026gt; @endsection Para permitir texto enriquecido en los dos textarea voy a utilizar ckeditor. Me dirijo a su página de descargas y copio el CDN \u0026lt;script src=\u0026quot;https://cdn.ckeditor.com/ckeditor5/24.0.0/classic/ckeditor.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;que inserto en la sección @section('js') de la vista create.blade.php. Localizo el elemento en el que quiero usarlo y pongo el valor de su id dentro del método ClassicEditro.create(). Como indica sus instrucciones de la página.\nClassic editor\nIn your HTML page add an element that CKEditor should replace:\n1 \u0026lt;div id=\u0026#34;editor\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; Load the classic editor build (here CDN location is used):\n1 \u0026lt;script src=\u0026#34;https://cdn.ckeditor.com/ckeditor5/24.0.0/classic/ckeditor.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; Call the ClassicEditor.create() method.\n1 2 3 4 5 6 7 \u0026lt;script\u0026gt; ClassicEditor .create( document.querySelector( \u0026#39;#editor\u0026#39; ) ) .catch( error =\u0026gt; { console.error( error ); } ); \u0026lt;/script\u0026gt; La sección @section('js') de la vista create.blade.php queda así:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.ckeditor.com/ckeditor5/24.0.0/classic/ckeditor.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); ClassicEditor .create( document.querySelector( \u0026#39;#extract\u0026#39; ) ) .catch( error =\u0026gt; { console.error( error ); } ); ClassicEditor .create( document.querySelector( \u0026#39;#body\u0026#39; ) ) .catch( error =\u0026gt; { console.error( error ); } ); \u0026lt;/script\u0026gt; @endsection y el formulario se ve así:\nSe me olvidó añadir un radio button para el estado\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;font-weight-bold\u0026#34;\u0026gt;Estado\u0026lt;/p\u0026gt; \u0026lt;label class=\u0026#34;mr-2\u0026#34;\u0026gt; {!! Form::radio(\u0026#39;status\u0026#39;, 1, true) !!} Borrador \u0026lt;/label\u0026gt; \u0026lt;label class=\u0026#34;mr-2\u0026#34;\u0026gt; {!! Form::radio(\u0026#39;status\u0026#39;, 2) !!} Publicado \u0026lt;/label\u0026gt; \u0026lt;/div\u0026gt; Voy a manejar dos validaciones con este formulario, una cuando quiera guardar el formulario como borrador y otra cuando quiera que sea como publicado. Como los campos extract y body de la tabla posts quiero que puedan ser vacíos en el caso de borrador, debo modificarlo en el factory correspondiente database/migrations/2020_12_10_152625_create_posts_table.php.\n2020_12_10_152625_create_posts_table.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 \u0026lt;?php use Illuminate\\Database\\Migrations\\Migration; use Illuminate\\Database\\Schema\\Blueprint; use Illuminate\\Support\\Facades\\Schema; class CreatePostsTable extends Migration { /** * Run the migrations. * * @return void */ public function up() { Schema::create(\u0026#39;posts\u0026#39;, function (Blueprint $table) { $table-\u0026gt;id(); $table-\u0026gt;string(\u0026#39;name\u0026#39;); $table-\u0026gt;string(\u0026#39;slug\u0026#39;); $table-\u0026gt;text(\u0026#39;extract\u0026#39;)-\u0026gt;nullable(); //Modificado para que sea nulable $table-\u0026gt;longText(\u0026#39;body\u0026#39;)-\u0026gt;nullable(); //Modificado para que sea nulable $table-\u0026gt;enum(\u0026#39;status\u0026#39;, [1,2])-\u0026gt;default(1); //1 es borrador y 2 publicado $table-\u0026gt;unsignedBigInteger(\u0026#39;category_id\u0026#39;); $table-\u0026gt;unsignedBigInteger(\u0026#39;user_id\u0026#39;); $table-\u0026gt;foreign(\u0026#39;category_id\u0026#39;)-\u0026gt;references(\u0026#39;id\u0026#39;)-\u0026gt;on(\u0026#39;categories\u0026#39;)-\u0026gt;onDelete(\u0026#39;cascade\u0026#39;); $table-\u0026gt;foreign(\u0026#39;user_id\u0026#39;)-\u0026gt;references(\u0026#39;id\u0026#39;)-\u0026gt;on(\u0026#39;users\u0026#39;)-\u0026gt;onDelete(\u0026#39;cascade\u0026#39;); $table-\u0026gt;timestamps(); }); } /** * Reverse the migrations. * * @return void */ public function down() { Schema::dropIfExists(\u0026#39;posts\u0026#39;); } } Vuelvo a realizar las migraciones para que tengan efecto los cambios.\n1 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan migrate:fresh --seed Ahora debo crear las reglas de validación que no voy a incluir dentro del método store del controlador Admin/PostController.php sino\nmediante un formRequest\n1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:request StorePostRequest Request created successfully. app/Http/Requests/StorePostRequest.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;?php namespace App\\Http\\Requests; use Illuminate\\Foundation\\Http\\FormRequest; class StorePostRequest extends FormRequest { /** * Determine if the user is authorized to make this request. * * @return bool */ public function authorize() { return false; } /** * Get the validation rules that apply to the request. * * @return array */ public function rules() { return [ // ]; } } y lo modifico incluyendo las reglas de validación para los status de borrador y de publicado.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 \u0026lt;?php namespace App\\Http\\Requests; use Illuminate\\Foundation\\Http\\FormRequest; class StorePostRequest extends FormRequest { /** * Determine if the user is authorized to make this request. * * @return bool */ public function authorize() { return true; } /** * Get the validation rules that apply to the request. * * @return array */ public function rules() { $rules = [ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;slug\u0026#39; =\u0026gt; \u0026#39;required|unique:posts\u0026#39;, \u0026#39;status\u0026#39; =\u0026gt; \u0026#39;required|in:1,2\u0026#39; ]; if($this-\u0026gt;status == 2){ $rules = array_merge($rules, [ \u0026#39;category_id\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;tags\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;extract\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;body\u0026#39; =\u0026gt; \u0026#39;required\u0026#39; ]); } return $rules; } } Cambio la clase Request por StorePostRequest en el método store del controlador para que utilice la clase del formRequest que acabo de crear con las validaciones, los objetos que pasamos por parámetro serán de la clase formRequest.\nMétodo store en Admin/PostController.php\n1 2 3 4 5 6 7 8 9 10 /** * Store a newly created resource in storage. * * @param App\\Http\\Requests\\StorePostRequest $request * @return \\Illuminate\\Http\\Response */ public function store(StorePostRequest $request) { // } Lo siguiente es agregar los mensajes de error de validación en la vista resources/views/admin/posts/create.blade.php\ncreate.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Crea un post\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.posts.store\u0026#39;]) !!} \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre: \u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;Escribe el nombre del post\u0026#39;]) !!} @error(\u0026#39;name\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug: \u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;readonly\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;Escribe el slug del post\u0026#39;]) !!} @error(\u0026#39;slug\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;category_id\u0026#39;, \u0026#39;Categoría: \u0026#39;) !!} {!! Form::select(\u0026#39;category_id\u0026#39;, $categories, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} @error(\u0026#39;category_id\u0026#39;) \u0026lt;br\u0026gt; \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;font-weight-bold\u0026#34;\u0026gt;Etiquetas: \u0026lt;/p\u0026gt; @foreach ($tags as $tag) \u0026lt;label class=\u0026#34;mr-2\u0026#34;\u0026gt; {!! Form::checkbox(\u0026#39;tags[]\u0026#39;, $tag-\u0026gt;id, null) !!} {{--Seleccion multiple en array tags[]--}} {{$tag-\u0026gt;name}} \u0026lt;/label\u0026gt; @endforeach @error(\u0026#39;tags\u0026#39;) \u0026lt;br\u0026gt; \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;font-weight-bold\u0026#34;\u0026gt;Estado\u0026lt;/p\u0026gt; \u0026lt;label class=\u0026#34;mr-2\u0026#34;\u0026gt; {!! Form::radio(\u0026#39;status\u0026#39;, 1, true) !!} Borrador \u0026lt;/label\u0026gt; \u0026lt;label class=\u0026#34;mr-2\u0026#34;\u0026gt; {!! Form::radio(\u0026#39;status\u0026#39;, 2) !!} Publicado \u0026lt;/label\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;extract\u0026#39;, \u0026#39;Extracto: \u0026#39;) !!} {!! Form::textarea(\u0026#39;extract\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} @error(\u0026#39;extract\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;body\u0026#39;, \u0026#39;Cuerpo del post: \u0026#39;) !!} {!! Form::textarea(\u0026#39;body\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} @error(\u0026#39;body\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; {!! Form::submit(\u0026#39;Crear post\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.ckeditor.com/ckeditor5/24.0.0/classic/ckeditor.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); ClassicEditor .create( document.querySelector( \u0026#39;#extract\u0026#39; ) ) .catch( error =\u0026gt; { console.error( error ); } ); ClassicEditor .create( document.querySelector( \u0026#39;#body\u0026#39; ) ) .catch( error =\u0026gt; { console.error( error ); } ); \u0026lt;/script\u0026gt; @endsection Compruebo que funciona la validación.\nDentro del formulario debo incluir de forma oculta dentro de un input el id del usuario logeado.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 ........ @section(\u0026#39;content\u0026#39;) \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.posts.store\u0026#39;]) !!} {!! Form::hidden(\u0026#39;user_id\u0026#39;, auth()-\u0026gt;user()-\u0026gt;id) !!} {{-- Campo oculto --}} \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre: \u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;Escribe el nombre del post\u0026#39;]) !!} @error(\u0026#39;name\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; ........ Para garantizar que no se modifica este id al enviar el formulario voy a modificar el método authorize de app/Http/Requests/StorePostRequest.php\nStorePostRequest.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 ......... public function authorize() { // Compruebo si cualquier user_id que se pasa por el formulario coincide con el del usuario logeado // Entonces e permito la verificacion de las reglas y enviar el formulario if($this-\u0026gt;user_id == auth()-\u0026gt;user()-\u0026gt;id) { return true; }else{ return false; } } ......... Para poder mandar el formulario utilizando el método store del controlador Admin/PostController.php debo activa la asignación masiva en el modeloPost.php. En este caso utilizaré la propiedad $guarded.\napp/Models/Post.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 \u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Database\\Eloquent\\Model; class Post extends Model { use HasFactory; protected $guarded = [\u0026#39;id\u0026#39;, \u0026#39;created_at\u0026#39;, \u0026#39;updated_at\u0026#39;]; // Relacion uno a muchos inversa users public function user() { return $this-\u0026gt;belongsTo(User::class); } // Relacion uno a muchos inversa categories public function category() { return $this-\u0026gt;belongsTo(Category::class); } // Relacion muchos a muchos etiquetas public function tags() { return $this-\u0026gt;belongsToMany(Tag::class); } // Relacion uno a uno polimórfica con image public function image() { return $this-\u0026gt;morphOne(Image::class, \u0026#39;imageable\u0026#39;); } } Método store en Admin/PostController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ....... /** * Store a newly created resource in storage. * * @param App\\Http\\Requests\\StorePostRequest $request * @return \\Illuminate\\Http\\Response */ public function store(StorePostRequest $request) { $post = Post::create($request-\u0026gt;all()); {{-- Guardo el post--}} if($request-\u0026gt;tags) {{-- Si hay etiquetas marcadas en el formulario--}} { $post-\u0026gt;tags()-\u0026gt;attach($request-\u0026gt;tags); {{-- Las añado a la tala intermedia--}} } return redirect()-\u0026gt;route(\u0026#39;admin.posts.index\u0026#39;); } ....... Si ahora creo un post y lo publico, al listarlo en la página principal del sitio, o al intentar mostrar su contenido, o filtrar los posts por categorías o etiquetas, laravel me lanzará un mensaje de error porque le estoy pidiendo en la vista correspondiente que muestre una imagen que no he subido. Para corregir este fallo de diseño debo hacer los siguientes cambios de código en las vistas.\nresources/views/posts/index.blade.php\n1 2 3 4 5 6 7 8 \u0026lt;x-app-layout\u0026gt; \u0026lt;div class=\u0026#34;micontainer py-8\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\u0026#34;\u0026gt; @foreach ($posts as $post) \u0026lt;article class=\u0026#34; w-full h-80 bg-cover bg-center @if($loop-\u0026gt;first) md:col-span-2 @endif\u0026#34; style=\u0026#34;background-image: url(@if($post-\u0026gt;image){{Storage::url($post-\u0026gt;image-\u0026gt;url)}} @else https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_960_720.jpg @endif)\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34; w-full h-full px-8 flex flex-col justify-center\u0026#34;\u0026gt; ..................... En este bloque de código le digo con un if a la propiedad backgroud-image que me muestre una imagen por defecto cuando no he subido yo una al crear el post\nresources/views/components/card-post.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 @props([\u0026#39;post\u0026#39;]) \u0026lt;article class=\u0026#34;mb-8 bg-white shadow-lg rounded-lg overflow-hidden\u0026#34;\u0026gt; @if ($post-\u0026gt;image) \u0026lt;img class=\u0026#34; w-full h-72 object-cover object-center\u0026#34; src=\u0026#34;{{Storage::url($post-\u0026gt;image-\u0026gt;url)}}\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; @else \u0026lt;img class=\u0026#34; w-full h-72 object-cover object-center\u0026#34; src=\u0026#34;https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_960_720.jpg \u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; @endif \u0026lt;div class=\u0026#34;px-6 py-4\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34; font-bold text-xl mb-2\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.show\u0026#39;, $post)}}\u0026#34;\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/a\u0026gt; \u0026lt;/h1\u0026gt; \u0026lt;div class=\u0026#34; text-gray-700 text-base\u0026#34;\u0026gt; {!!$post-\u0026gt;extract!!} {{-- Sustituido por {{$post-\u0026gt;extract}} para que laravel no escape el html usado con ckeditor--}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;px-6 pt-4 pb-2\u0026#34;\u0026gt; @foreach ($post-\u0026gt;tags as $tag) \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.tag\u0026#39;, $tag)}}\u0026#34; class=\u0026#34; inline-block bg-gray-200 rounded-full px-3 py-1 text-sm text-gray-700 mr-2\u0026#34;\u0026gt;{{$tag-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;/article\u0026gt; Filtrado de categorías o etiquetas corregido.\nresources/views/posts/show.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 \u0026lt;x-app-layout\u0026gt; \u0026lt;div class=\u0026#34; micontainer py-8\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34; text-4xl font-bold text-gray-600\u0026#34;\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/h1\u0026gt; \u0026lt;div class=\u0026#34; text-lg text-gray-500 mb-2\u0026#34;\u0026gt; {!!$post-\u0026gt;extract!!} {{-- Sustituido por {{$post-\u0026gt;extract}} para que laravel no escape el html usado con ckeditor--}} \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;grid grid-cols-1 lg:grid-cols-3 gap-6\u0026#34;\u0026gt; {{-- Contenido principal --}} \u0026lt;div class=\u0026#34; lg:col-span-2\u0026#34;\u0026gt; \u0026lt;figure\u0026gt; @if ($post-\u0026gt;image) \u0026lt;img class=\u0026#34; w-full h-80 object-cover object-center\u0026#34; src=\u0026#34;{{Storage::url($post-\u0026gt;image-\u0026gt;url)}}\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; @else \u0026lt;img class=\u0026#34; w-full h-80 object-cover object-center\u0026#34; src=\u0026#34;https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_960_720.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; @endif \u0026lt;/figure\u0026gt; \u0026lt;div class=\u0026#34; text-base text-gray-500 mt-4\u0026#34;\u0026gt; {!!$post-\u0026gt;body!!} {{-- Sustituido por {{$post-\u0026gt;body}} para que laravel no escape el html usado con ckeditor--}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; {{-- Contenido relacionado--}} \u0026lt;aside\u0026gt; \u0026lt;h1 class=\u0026#34; text-2xl font-bold text-gray-600 mb-4\u0026#34;\u0026gt;Más en: {{$post-\u0026gt;category-\u0026gt;name}}\u0026lt;/h1\u0026gt; \u0026lt;ul\u0026gt; @foreach ($similares as $similar) \u0026lt;li class=\u0026#34; mb-4\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34;flex\u0026#34; href=\u0026#34;{{Route(\u0026#39;posts.show\u0026#39;, $similar)}}\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34; w-40 h-20 object-cover object-center \u0026#34; src=\u0026#34;@if($similar-\u0026gt;image) {{Storage::url($similar-\u0026gt;image-\u0026gt;url)}} @else https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_960_720.jpg @endif\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34; ml-2 text-gray-600\u0026#34;\u0026gt;{{$similar-\u0026gt;name}}\u0026lt;/span\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt; @endforeach \u0026lt;/ul\u0026gt; \u0026lt;/aside\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/x-app-layout\u0026gt; Subiendo una imagen al servidor y asociandola a un post Modifico la vista create.blade.php en la que añado un div que me contiene una imagen de muestra y un input de tipo file para poder subir imágenes. Además necesito añadir al formulario la propiedad 'files' =\u0026gt; true para permitir subir imágenes y un script js que controle el cambio de imagen en la vista previa antes de mandar el formulario.\nresources/views/admin/posts/create.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 ................. @section(\u0026#39;content\u0026#39;) \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.posts.store\u0026#39;, \u0026#39;autocomplete\u0026#39; =\u0026gt; \u0026#39;off\u0026#39;, \u0026#39;files\u0026#39; =\u0026gt; true]) !!} {!! Form::hidden(\u0026#39;user_id\u0026#39;, auth()-\u0026gt;user()-\u0026gt;id) !!} ................. \u0026lt;div class=\u0026#34;row mb-3\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;image-wrapper\u0026#34;\u0026gt; \u0026lt;img id=\u0026#34;picture\u0026#34; src=\u0026#34;https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_960_720.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;file\u0026#39;, \u0026#39;Imagen a mostrar en el post\u0026#39;) !!} {!! Form::file(\u0026#39;file\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control-file\u0026#39;, \u0026#39;accept\u0026#39; =\u0026gt; \u0026#39;image/*\u0026#39;]) !!} \u0026lt;p\u0026gt;Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestias totam adipisci, reiciendis rem soluta cupiditate repudiandae voluptate autem fugit asperiores nobis nihil eveniet quam aperiam assumenda eius ipsa facilis tempora?\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ........................ @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.ckeditor.com/ckeditor5/24.0.0/classic/ckeditor.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; ......... //Cambiar imagen document.getElementById(\u0026#34;file\u0026#34;).addEventListener(\u0026#39;change\u0026#39;, cambiarImagen); function cambiarImagen(event){ var file = event.target.files[0]; var reader = new FileReader(); reader.onload = (event) =\u0026gt; { document.getElementById(\u0026#34;picture\u0026#34;).setAttribute(\u0026#39;src\u0026#39;, event.target.result); }; reader.readAsDataURL(file); } \u0026lt;/script\u0026gt; @endsection Al enviar este formulario a la ruta admin.posts.store que gestiona el controlador Admin/PostsController.php a través de su método store debo modificar este último para que pueda recoger la imagen si es enviada y almacenarla en la tabla images.\nuse Illuminate\\Support\\Facades\\Storage; Añado el Facades Storage para que laravel me permita almacenar imágenes en la carpeta public del servidor.\nMétodo store del controlador Admin/PostsController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 ............ use Illuminate\\Support\\Facades\\Storage ............ /** * Store a newly created resource in storage. * * @param App\\Http\\Requests\\StorePostRequest $request * @return \\Illuminate\\Http\\Response */ public function store(StorePostRequest $request) { $post = Post::create($request-\u0026gt;all()); if ($request-\u0026gt;file(\u0026#39;file\u0026#39;)) { // Si se está enviando una imagen $url = Storage::put(\u0026#39;posts\u0026#39;, $request-\u0026gt;file(\u0026#39;file\u0026#39;)); //guardo la imagen en la carpeta post y copio su url en la variable $url $post-\u0026gt;image()-\u0026gt;create([ // al usar create para almacenar la imagen en la tabla img debo habilitar asignación masiva en Image.php \u0026#39;url\u0026#39; =\u0026gt; $url ]); } if($request-\u0026gt;tags) { $post-\u0026gt;tags()-\u0026gt;attach($request-\u0026gt;tags); } return redirect()-\u0026gt;route(\u0026#39;admin.posts.index\u0026#39;); } Habilito la asignación masiva en app/Models/Image.php.\nModelo Image.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Database\\Eloquent\\Model; class Image extends Model { use HasFactory; protected $fillable = [\u0026#39;url\u0026#39;]; // Habilito la signación masiva. // Relacion uno a uno polimórfica public function imageable() { return $this-\u0026gt;morphTo(); } } Valido desde el servidor que solo pueda subir imágenes añadiendo la regla 'file' =\u0026gt; 'image' en app/Http/Requests/StorePostRequest.php.\nStorePostRequest.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 ......... /** * Get the validation rules that apply to the request. * * @return array */ public function rules() { $rules = [ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;slug\u0026#39; =\u0026gt; \u0026#39;required|unique:posts\u0026#39;, \u0026#39;status\u0026#39; =\u0026gt; \u0026#39;required|in:1,2\u0026#39;, \u0026#39;file\u0026#39; =\u0026gt; \u0026#39;image\u0026#39; ]; if($this-\u0026gt;status == 2){ $rules = array_merge($rules, [ \u0026#39;category_id\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;tags\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;extract\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;body\u0026#39; =\u0026gt; \u0026#39;required\u0026#39; ]); } return $rules; } ......... Y 'accept' =\u0026gt; 'image/*' en el input tipo file de la vista.\n1 2 3 4 5 6 7 8 9 enrique@enrique-server:/var/www/laravel/blog_laravel$ sudo chmod 777 storage/app/public/posts/ [sudo] password for enrique: enrique@enrique-server:/var/www/laravel/blog_laravel$ ls -la storage/app/public/ total 32 drwxrwsr-x 3 enrique www-data 4096 Jan 24 15:48 . drwxrwsr-x 3 enrique www-data 4096 Dec 8 15:51 .. -rwxrwxr-x 1 enrique www-data 14 Dec 8 15:51 .gitignore drwxrwsrwx 2 enrique www-data 20480 Jan 24 15:58 posts enrique@enrique-server:/var/www/laravel/blog_laravel$ Actualizando un post Para editar un post voy a reutilizar los input del formulario de la vista views/admin/posts/create.blade.php por lo que lo refactorizo para poder utilizarlos en ambas vistas. Creo el partial views/admin/posts/partials/form.blade.php y pego en el los campos comunes a los dos formularios.\nviews/admin/posts/partials/form.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre: \u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;Escribe el nombre del post\u0026#39;]) !!} @error(\u0026#39;name\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug: \u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;readonly\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;Escribe el slug del post\u0026#39;]) !!} @error(\u0026#39;slug\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;category_id\u0026#39;, \u0026#39;Categoría: \u0026#39;) !!} {!! Form::select(\u0026#39;category_id\u0026#39;, $categories, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} @error(\u0026#39;category_id\u0026#39;) \u0026lt;br\u0026gt; \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;font-weight-bold\u0026#34;\u0026gt;Etiquetas: \u0026lt;/p\u0026gt; @foreach ($tags as $tag) \u0026lt;label class=\u0026#34;mr-2\u0026#34;\u0026gt; {!! Form::checkbox(\u0026#39;tags[]\u0026#39;, $tag-\u0026gt;id, null) !!} {{--Seleccion multiple en array tags[]--}} {{$tag-\u0026gt;name}} \u0026lt;/label\u0026gt; @endforeach @error(\u0026#39;tags\u0026#39;) \u0026lt;br\u0026gt; \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;font-weight-bold\u0026#34;\u0026gt;Estado\u0026lt;/p\u0026gt; \u0026lt;label class=\u0026#34;mr-2\u0026#34;\u0026gt; {!! Form::radio(\u0026#39;status\u0026#39;, 1, true) !!} Borrador \u0026lt;/label\u0026gt; \u0026lt;label class=\u0026#34;mr-2\u0026#34;\u0026gt; {!! Form::radio(\u0026#39;status\u0026#39;, 2) !!} Publicado \u0026lt;/label\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;row mb-3\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;image-wrapper\u0026#34;\u0026gt; @isset($post-\u0026gt;image) \u0026lt;img id=\u0026#34;picture\u0026#34; src=\u0026#34;{{Storage::url($post-\u0026gt;image-\u0026gt;url)}}\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; @else \u0026lt;img id=\u0026#34;picture\u0026#34; src=\u0026#34;https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_960_720.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; @endisset \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;file\u0026#39;, \u0026#39;Imagen a mostrar en el post\u0026#39;) !!} {!! Form::file(\u0026#39;file\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control-file\u0026#39;, \u0026#39;accept\u0026#39; =\u0026gt; \u0026#39;image/*\u0026#39;]) !!} \u0026lt;p\u0026gt;Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestias totam adipisci, reiciendis rem soluta cupiditate repudiandae voluptate autem fugit asperiores nobis nihil eveniet quam aperiam assumenda eius ipsa facilis tempora?\u0026lt;/p\u0026gt; @error(\u0026#39;file\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;extract\u0026#39;, \u0026#39;Extracto: \u0026#39;) !!} {!! Form::textarea(\u0026#39;extract\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} @error(\u0026#39;extract\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;body\u0026#39;, \u0026#39;Cuerpo del post: \u0026#39;) !!} {!! Form::textarea(\u0026#39;body\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} @error(\u0026#39;body\u0026#39;) \u0026lt;small class=\u0026#34;text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/small\u0026gt; @enderror \u0026lt;/div\u0026gt; Actualizo la vista create:\nviews/admin/posts/create.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Crea un post\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.posts.store\u0026#39;, \u0026#39;autocomplete\u0026#39; =\u0026gt; \u0026#39;off\u0026#39;, \u0026#39;files\u0026#39; =\u0026gt; true]) !!} {!! Form::hidden(\u0026#39;user_id\u0026#39;, auth()-\u0026gt;user()-\u0026gt;id) !!} @include(\u0026#39;admin.posts.partials.form\u0026#39;) {!! Form::submit(\u0026#39;Crear post\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;css\u0026#39;) \u0026lt;style\u0026gt; .image-wrapper{ position: relative; padding-bottom: 56.25% } .image-wrapper img{ position: absolute; object-fit: cover; width: 100%; height: 100%; } \u0026lt;/style\u0026gt; @endsection @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.ckeditor.com/ckeditor5/24.0.0/classic/ckeditor.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); ClassicEditor .create( document.querySelector( \u0026#39;#extract\u0026#39; ) ) .catch( error =\u0026gt; { console.error( error ); } ); ClassicEditor .create( document.querySelector( \u0026#39;#body\u0026#39; ) ) .catch( error =\u0026gt; { console.error( error ); } ); //Cambiar imagen document.getElementById(\u0026#34;file\u0026#34;).addEventListener(\u0026#39;change\u0026#39;, cambiarImagen); function cambiarImagen(event){ var file = event.target.files[0]; var reader = new FileReader(); reader.onload = (event) =\u0026gt; { document.getElementById(\u0026#34;picture\u0026#34;).setAttribute(\u0026#39;src\u0026#39;, event.target.result); }; reader.readAsDataURL(file); } \u0026lt;/script\u0026gt; @endsection Y la vista edit:\nviews/admin/posts/edit.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Editar un post\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) @if (session(\u0026#39;info\u0026#39;)) \u0026lt;div class=\u0026#34; alert alert-success\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;{{session(\u0026#39;info\u0026#39;)}}\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @endif \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::model($post,[\u0026#39;route\u0026#39; =\u0026gt; [\u0026#39;admin.posts.update\u0026#39;, $post], \u0026#39;autocomplete\u0026#39; =\u0026gt; \u0026#39;off\u0026#39;, \u0026#39;files\u0026#39; =\u0026gt; true, \u0026#39;method\u0026#39; =\u0026gt; \u0026#39;put\u0026#39;]) !!} {{-- {!! Form::hidden(\u0026#39;user_id\u0026#39;, auth()-\u0026gt;user()-\u0026gt;id) !!} Lo validare--}} @include(\u0026#39;admin.posts.partials.form\u0026#39;) {!! Form::submit(\u0026#39;Actualizar post\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;css\u0026#39;) \u0026lt;style\u0026gt; .image-wrapper{ position: relative; padding-bottom: 56.25% } .image-wrapper img{ position: absolute; object-fit: cover; width: 100%; height: 100%; } \u0026lt;/style\u0026gt; @endsection @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.ckeditor.com/ckeditor5/24.0.0/classic/ckeditor.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); ClassicEditor .create( document.querySelector( \u0026#39;#extract\u0026#39; ) ) .catch( error =\u0026gt; { console.error( error ); } ); ClassicEditor .create( document.querySelector( \u0026#39;#body\u0026#39; ) ) .catch( error =\u0026gt; { console.error( error ); } ); //Cambiar imagen document.getElementById(\u0026#34;file\u0026#34;).addEventListener(\u0026#39;change\u0026#39;, cambiarImagen); function cambiarImagen(event){ var file = event.target.files[0]; var reader = new FileReader(); reader.onload = (event) =\u0026gt; { document.getElementById(\u0026#34;picture\u0026#34;).setAttribute(\u0026#39;src\u0026#39;, event.target.result); }; reader.readAsDataURL(file); } \u0026lt;/script\u0026gt; @endsection Actualizo los métodos edit y update del controlador PostController.php\nPostController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 ......... /** * Show the form for editing the specified resource. * * @param App\\Models\\Post $post * @return \\Illuminate\\Http\\Response */ public function edit(Post $post) { $categories = Category::pluck(\u0026#39;name\u0026#39;, \u0026#39;id\u0026#39;); //Devuelve un array de parejas clave=\u0026gt;valor (\u0026#39;id\u0026#39;=\u0026gt;\u0026#39;nombre\u0026#39;) $tags = Tag::all();//Devuelve un array de objetos Tag. return view(\u0026#39;admin.posts.edit\u0026#39;, compact(\u0026#39;post\u0026#39;, \u0026#39;categories\u0026#39;, \u0026#39;tags\u0026#39;)); } /** * Update the specified resource in storage. * * @param \\Illuminate\\Http\\PostRequest $request * @param App\\Models\\Post $post * @return \\Illuminate\\Http\\Response */ public function update(PostRequest $request, Post $post) { $post-\u0026gt;update($request-\u0026gt;all()); // actualizo los datos del post if($request-\u0026gt;file(\u0026#39;file\u0026#39;)){ //Si se envia una imagen en el formulario $url = Storage::put(\u0026#39;posts\u0026#39;, $request-\u0026gt;file(\u0026#39;file\u0026#39;)); //la almaceno en la carpeta posts if($post-\u0026gt;image){ //si el registro del post tiene una imagen previa asociada Storage::delete([$post-\u0026gt;image-\u0026gt;url]); //borro la imagen de la carpeta posts $post-\u0026gt;image-\u0026gt;update([ // Y cambio la url por la nueva \u0026#39;url\u0026#39; =\u0026gt; $url ]); }else{ // Si no tiene imagen previa le asigno la url de la nueva $post-\u0026gt;image()-\u0026gt;create([ \u0026#39;url\u0026#39; =\u0026gt; $url ]); } } if($request-\u0026gt;tags){ $post-\u0026gt;tags()-\u0026gt;sync($request-\u0026gt;tags); // El método sync sincroniza las etiquetas, eliminando las desseleccionadas y agregando las nuevas. } return redirect()-\u0026gt;route(\u0026#39;admin.posts.edit\u0026#39;, $post)-\u0026gt;with(\u0026#39;info\u0026#39;, \u0026#39;El post se actualizó con éxito.\u0026#39;); } ......... Tanto en el método update como en el store he utilizado las mismas reglas de validación por lo que modifico el formRequest creado para validar los campos del método store y cambio también su nombre a PostRequest.php\napp/Http/Request/PostRequest.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 \u0026lt;?php namespace App\\Http\\Requests; use Illuminate\\Foundation\\Http\\FormRequest; class PostRequest extends FormRequest { /** * Determine if the user is authorized to make this request. * * @return bool */ public function authorize() { return true; } /** * Get the validation rules that apply to the request. * * @return array */ public function rules() { $post = $this-\u0026gt;route()-\u0026gt;parameter(\u0026#39;post\u0026#39;); $rules = [ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;slug\u0026#39; =\u0026gt; \u0026#39;required|unique:posts\u0026#39;, \u0026#39;status\u0026#39; =\u0026gt; \u0026#39;required|in:1,2\u0026#39;, \u0026#39;file\u0026#39; =\u0026gt; \u0026#39;image|max:3000\u0026#39; ]; if($post){ $rules[\u0026#39;slug\u0026#39;] = \u0026#39;required|unique:posts,slug, \u0026#39;. $post-\u0026gt;id; } if($this-\u0026gt;status == 2){ $rules = array_merge($rules, [ \u0026#39;category_id\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;tags\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;extract\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;body\u0026#39; =\u0026gt; \u0026#39;required\u0026#39; ]); } return $rules; } } Eliminando un post Al hacer clic en el botón eliminar del listado de post de la vista resources/views/livewire/admin/posts-index.blade.php el formulario en el que está encerrado me dirige a la ruta admin.posts.destroy gestionada por el método destroy del controlador Admin/PostCopntroller.php. En el escribo la logica para eliminar el post y una redireccion a la ruta admin.posts.index a la que le paso un mensaje de éxito.\n1 2 3 4 5 6 7 8 9 10 11 12 /** * Remove the specified resource from storage. * * @param App\\Models\\Post $post * @return \\Illuminate\\Http\\Response */ public function destroy(Post $post) { $post-\u0026gt;delete(); return redirect()-\u0026gt;route(\u0026#39;admin.posts.index\u0026#39;)-\u0026gt;with(\u0026#39;info-del\u0026#39;, \u0026#39;El post se eliminó con éxito\u0026#39;); } Recojo las variables de sesión dentro de resources/views/livewire/admin/posts-index.blade.php\nresources/views/livewire/admin/posts-index.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 \u0026lt;div class=\u0026#34; card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-header\u0026#34;\u0026gt; {{-- Sincronizo el input con la propiedad search de PostIndex.php--}} \u0026lt;input wire:model = \u0026#34;search\u0026#34; class=\u0026#34; form-control\u0026#34; placeholder=\u0026#34;Escriba el nombre de un post\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; @if ($posts-\u0026gt;count()) @if (session(\u0026#39;info\u0026#39;)) \u0026lt;div class=\u0026#34; alert alert-success\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;{{session(\u0026#39;info\u0026#39;)}}\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @elseif(session(\u0026#39;info-del\u0026#39;)) \u0026lt;div class=\u0026#34; alert alert-danger\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;{{session(\u0026#39;info-del\u0026#39;)}}\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @endif \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;table class=\u0026#34;table table-striped\u0026#34;\u0026gt; \u0026lt;thead\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;Id\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Nombre\u0026lt;/th\u0026gt; \u0026lt;th colspan=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;tbody\u0026gt; @foreach ($posts as $post) \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;{{$post-\u0026gt;id}}\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt;\u0026lt;a class=\u0026#34; btn btn-primary btn-sm\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.posts.edit\u0026#39;, $post)}}\u0026#34;\u0026gt;Editar\u0026lt;/a\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt; \u0026lt;form action=\u0026#34;{{route(\u0026#39;admin.posts.destroy\u0026#39;, $post)}}\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; @csrf @method(\u0026#39;delete\u0026#39;) \u0026lt;button class=\u0026#34;btn btn-danger btn-sm\u0026#34; type=\u0026#34;submit\u0026#34;\u0026gt;Eliminar\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; @endforeach \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/div\u0026gt; {{-- Aqui pongo la paginación--}} \u0026lt;div class=\u0026#34;car-footer\u0026#34;\u0026gt; {{$posts-\u0026gt;links()}} \u0026lt;/div\u0026gt; @else \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;No hay ninguna coincidencia.\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @endif \u0026lt;/div\u0026gt; No he incluido el código para eliminar la imagen asociada al post dentro del método destroy como si hice en el método update. Para eliminar las imágenes asociadas a los post voy a utilizar una clase observer (son clases que tienen métodos que reflejan los eventos de un modelo en especifico: created: evento que se ejecuta cuando se crea un registro en el modelo.)\n1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:observer PostObserver --model=Post Observer created successfully. La clase creada queda así:\napp/Observers/PostObserver.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 \u0026lt;?php namespace App\\Observers; use App\\Models\\Post; class PostObserver { /** * Handle the Post \u0026#34;created\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function created(Post $post) { // } /** * Handle the Post \u0026#34;updated\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function updated(Post $post) { // } /** * Handle the Post \u0026#34;deleted\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function deleted(Post $post) { // } /** * Handle the Post \u0026#34;restored\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function restored(Post $post) { // } /** * Handle the Post \u0026#34;force deleted\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function forceDeleted(Post $post) { // } } Cada una de esas funciones se activan cada vez que realicemos una acción con respecto al modelo Post. cada vez que cree un nuevo post se activara el evento public function created(Post $post).\nDe momento solo voy a usar los métodos created y updated por lo que elimino los demás.\napp/Observers/PostObserver.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \u0026lt;?php namespace App\\Observers; use App\\Models\\Post; class PostObserver { /** * Handle the Post \u0026#34;created\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function created(Post $post) { // } /** * Handle the Post \u0026#34;deleted\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function deleted(Post $post) { // } } Ambos métodos se activan después de borrar o crear un post. Pero necesito que el evento se ejecute antes de eliminar o crear el post. Por lo que voy a\nusar el evento deleting en vez del deleted.\nMétodo deleting en app/Observers/PostObserver.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 ........ /** * Handle the Post \u0026#34;deleted\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function deleting(Post $post) //cada vez que se elimina un post si este tiene imagen la borramos tambien. { if($post-\u0026gt;image){ Storage::delete($post-\u0026gt;image-\u0026gt;url); } } ........ Registro PostObserver en app/Providers/EventServiceProvider.php. Importo tanto el modelo como el observador con: use App\\Models\\Post; y use App\\Observers\\PostObserver; y lo registro en el método boot del mismo.\napp/Providers/EventServiceProvider.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;?php namespace App\\Providers; use Illuminate\\Auth\\Events\\Registered; use Illuminate\\Auth\\Listeners\\SendEmailVerificationNotification; use Illuminate\\Foundation\\Support\\Providers\\EventServiceProvider as ServiceProvider; use Illuminate\\Support\\Facades\\Event; use App\\Models\\Post; use App\\Observers\\PostObserver; class EventServiceProvider extends ServiceProvider { /** * The event listener mappings for the application. * * @var array */ protected $listen = [ Registered::class =\u0026gt; [ SendEmailVerificationNotification::class, ], ]; /** * Register any events for your application. * * @return void */ public function boot() { Post::observe(PostObserver::class); } } Aprovecho este observer para pasar desde el backend el id del usuario logeado como creador del post en vez de enviarlo desde el frontend (vista views/admin/posts/create.blade.php)\nresources/views/admin/posts/create.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 ........ @section(\u0026#39;content\u0026#39;) \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.posts.store\u0026#39;, \u0026#39;autocomplete\u0026#39; =\u0026gt; \u0026#39;off\u0026#39;, \u0026#39;files\u0026#39; =\u0026gt; true]) !!} {{-- {!! Form::hidden(\u0026#39;user_id\u0026#39;, auth()-\u0026gt;user()-\u0026gt;id) !!}--}} @include(\u0026#39;admin.posts.partials.form\u0026#39;) {!! Form::submit(\u0026#39;Crear post\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop ..... app/Observers/PostObserver.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 .......... class PostObserver { /** * Handle the Post \u0026#34;created\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function creating(Post $post) { $post-\u0026gt;user_id = auth()-\u0026gt;user()-\u0026gt;id; } ......... Para evitar errores durante las migraciones y seeders modifico el método creating.\nMétodo creating en app/Observers/PostObserver.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 namespace App\\Observers; use App\\Models\\Post; use Illuminate\\Support\\Facades\\Storage; class PostObserver { /** * Handle the Post \u0026#34;created\u0026#34; event. * * @param \\App\\Models\\Post $post * @return void */ public function creating(Post $post) { if(! \\App::runningInConsole()){ // Para que no se ejecute cuando se esten ejecutando los seeders $post-\u0026gt;user_id = auth()-\u0026gt;user()-\u0026gt;id; //cada vez que se cree un post se asigna l campo user_id el valor del usuario autentiado. } } .......... ","pubDate":"2021-02-03","title":"Creando el crud de posts - IX "},{"link":"https://esaborit.github.io/posts/crud_etiquetas/","plain":"Creando un crud para las etiquetas del blog Sigo los mismos pasos que para las categorias.\nDesde la consola de comandos y situado dentro del proyecto creo el controlador con sus 7 métodos para administrar las etiquetas desde el backend.\n1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controler Admin/TagController -r Controller created successfully. Edito el controlador recién creado, sustituyendo los parámetros $id por objetos $tag y añadiendo las vistas a los métodos index, create, update.\nTagController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 \u0026lt;?php namespace App\\Http\\Controllers\\Admin; use App\\Http\\Controllers\\Controller; use App\\Models\\Tag; use Illuminate\\Http\\Request; class TagController extends Controller { /** * Display a listing of the resource. * * @return \\Illuminate\\Http\\Response */ public function index() { return view(\u0026#39;admin.tags.index\u0026#39;); } /** * Show the form for creating a new resource. * * @return \\Illuminate\\Http\\Response */ public function create() { return view(\u0026#39;admin.tags.create\u0026#39;); } /** * Store a newly created resource in storage. * * @param \\Illuminate\\Http\\Request $request * @return \\Illuminate\\Http\\Response */ public function store(Request $request) { // } /** * Display the specified resource. * * @param App\\Models\\Tag $tag * @return \\Illuminate\\Http\\Response */ public function show(Tag $tag) { // } /** * Show the form for editing the specified resource. * * @param App\\Models\\Tag $tag * @return \\Illuminate\\Http\\Response */ public function edit(Tag $tag) { return view(\u0026#39;admin.tags.edit\u0026#39;, compact(\u0026#39;tag\u0026#39;)); } /** * Update the specified resource in storage. * * @param \\Illuminate\\Http\\Request $request * @param App\\Models\\Tag $tag * @return \\Illuminate\\Http\\Response */ public function update(Request $request, Tag $tag) { // } /** * Remove the specified resource from storage. * * @param App\\Models\\Tag $tag * @return \\Illuminate\\Http\\Response */ public function destroy(Tag $tag) { // } } Dentro del archivo admin.php añado una ruta de tipo resources que me genere las rutas para el crud de las etiquetas, se la asigno al controlador TagController.php y le digo que todas las rutas comiencen con admin.tags.\n1 2 3 4 5 6 7 8 9 use App\\Http\\Controllers\\Admin\\CategoryController; use App\\Http\\Controllers\\Admin\\TagController; use App\\Http\\Controllers\\Admin\\HomeController; use Illuminate\\Support\\Facades\\Route; Route::get(\u0026#39;\u0026#39;, [HomeController::class, \u0026#39;index\u0026#39;])-\u0026gt;name(\u0026#39;admin.home\u0026#39;); Route::resource(\u0026#39;categories\u0026#39;, CategoryController::class)-\u0026gt;names(\u0026#39;admin.categories\u0026#39;); Route::resource(\u0026#39;tags\u0026#39;, TagController::class)-\u0026gt;names(\u0026#39;admin.tags\u0026#39;); Cuando añado una ruta nueva no me las suele reconocer sin mas, asi que refresco la caché de laravel.\n1 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan route:cache Ahora debo crear las vistas dentro de la carpeta views, donde creo una carpeta llamada tags para tenerlas todas dentro bien organizadas (resources/views/admin/tags/index.blade.php, resources/views/admin/tags/show.blade.php, resources/views/admin/tags/create.blade.php y resources/views/admin/tags/edit.blade.php). A modo de ejemplo muestro la vista index en la que he cargado la plantilla de adminLTE3.\nindex.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Listado de etiquetas\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui va un listado de etiquetas dentro de una tabla.\u0026lt;/p\u0026gt; @stop @section(\u0026#39;css\u0026#39;) \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/css/admin_custom.css\u0026#34;\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script\u0026gt; console.log(\u0026#39;Hi!\u0026#39;); \u0026lt;/script\u0026gt; @stop Lo siguiente que quiero es modificar es el menú de navegación de la barra lateral de la izquierda. Para ello dentro de adminlte.php modifico la sección Menu Items para que aparezca un enlace a la vista index de las etiquetas.\nadminlte.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 /* |-------------------------------------------------------------------------- | Menu Items |-------------------------------------------------------------------------- | | Here we can modify the sidebar/top navigation of the admin panel. | | For more detailed instructions you can look here: | https://github.com/jeroennoten/Laravel-AdminLTE/#8-menu-configuration | */ \u0026#39;menu\u0026#39; =\u0026gt; [ [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;search\u0026#39;, \u0026#39;search\u0026#39; =\u0026gt; true, \u0026#39;topnav\u0026#39; =\u0026gt; true, ], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;blog\u0026#39;, \u0026#39;url\u0026#39; =\u0026gt; \u0026#39;admin/blog\u0026#39;, \u0026#39;can\u0026#39; =\u0026gt; \u0026#39;manage-blog\u0026#39;, ], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;Dashboard\u0026#39;, \u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.home\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;fas fa-tachometer-alt fa-fw\u0026#39;, ], [\u0026#39;header\u0026#39; =\u0026gt; \u0026#39;ADMINISTRADOR\u0026#39;], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;Categorías\u0026#39;, \u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.categories.index\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;fab fa-fw fa-buffer\u0026#39;, \u0026#39;active\u0026#39; =\u0026gt; [\u0026#39;admin/categories*\u0026#39;], ], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;Etiquetas\u0026#39;, \u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.tags.index\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;fas fa-fw fa-lock\u0026#39;, \u0026#39;active\u0026#39; =\u0026gt; [\u0026#39;admin/tags*\u0026#39;], ], Mostrando un listado de etiquetas\nEn la vista index.blade.phpquiero mostrar el listado de etiquetas que podré crear, editar y borrar. Para ello llamo a la base de datos desde el método index del controlador TagController.php almaceno todas etiquetas dentro de una variable y se la paso a la vista index.blade.php.\nMétodo index de TagController.php\n1 2 3 4 5 6 7 8 9 10 11 /** * Display a listing of the resource. * * @return \\Illuminate\\Http\\Response */ public function index() { $tags = Tag::all(); return view(\u0026#39;admin.tags.index\u0026#39;, compact(\u0026#39;tags\u0026#39;)); } En la vista index creo una tabla dentro de un card de bootstrap en el que muestro el id, nombre, color y los botones de editar (ruta admin.tags.edit) y eliminar (admin.tags.destroy) para cada etiqueta. sobre esta lista añado un botón para crear etiquetas que me dirige a la ruta admin.tags.create\nindex.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Lista de etiquetas.\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui aparece un listado de etiquetas\u0026lt;/p\u0026gt; // mensajes de exito al editar, crear o eliminar una etiqueta @if (session(\u0026#39;info\u0026#39;)) \u0026lt;div class=\u0026#34; alert alert-success\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;{{session(\u0026#39;info\u0026#39;)}}\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @elseif(session(\u0026#39;info-del\u0026#39;)) \u0026lt;div class=\u0026#34; alert alert-danger\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;{{session(\u0026#39;info-del\u0026#39;)}}\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @endif \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-header\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34; btn btn-secondary float-right\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.tags.create\u0026#39;)}}\u0026#34;\u0026gt;Crear Etiqueta\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;table class=\u0026#34; table table-striped\u0026#34;\u0026gt; \u0026lt;thead\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;Id\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Nombre\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Color\u0026lt;/th\u0026gt; \u0026lt;th colspan=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;tbody\u0026gt; @foreach ($tags as $tag) \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;{{$tag-\u0026gt;id}}\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;{{$tag-\u0026gt;name}}\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;{{$tag-\u0026gt;color}}\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt;\u0026lt;a class=\u0026#34; btn btn-primary btn-sm\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.tags.edit\u0026#39;, $tag)}}\u0026#34;\u0026gt;Editar\u0026lt;/a\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt; \u0026lt;form action=\u0026#34;{{route(\u0026#39;admin.tags.destroy\u0026#39;, $tag)}}\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; @csrf @method(\u0026#39;delete\u0026#39;) \u0026lt;button class=\u0026#34;btn btn-danger btn-sm\u0026#34; type=\u0026#34;submit\u0026#34;\u0026gt;Eliminar\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; @endforeach \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;css\u0026#39;) \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/css/admin_custom.css\u0026#34;\u0026gt; @stop @section(\u0026#39;js\u0026#39;) @stop Creando una etiqueta\nUna vez que tengo creado el listado de las etiquetas me centro en poder crear una etiqueta nueva. Al hacer clic en el botón crear me envia a la ruta admin.tags.create que es administrada por el método create del controlador TagController.php. Debo pues crear un formulario en la vista resources/views/admin/tags/create.blade.php a la que seré enviado desde el método create.\ncreate.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Crear Etiqueta\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui va un formulario para crear una etiqueta.\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.tags.store\u0026#39;]) !!} \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre:\u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;Pon un nombre\u0026#39;]) !!} @error(\u0026#39;name\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug:\u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;Pon un slug\u0026#39;, \u0026#39;readonly\u0026#39;]) !!} @error(\u0026#39;slug\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;color\u0026#39;, \u0026#39;Color:\u0026#39;) !!} {!! Form::select(\u0026#39;color\u0026#39;, $colors, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} @error(\u0026#39;color\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; {!! Form::submit(\u0026#39;Crear etiqueta\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); \u0026lt;/script\u0026gt; @endsection El contenido del método es el siguiente\nMétodo create del controlador TagController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 /** * Show the form for creating a new resource. * * @return \\Illuminate\\Http\\Response */ public function create() { $colors = [ \u0026#39;red\u0026#39; =\u0026gt; \u0026#39;Color rojo\u0026#39;, \u0026#39;yellow\u0026#39; =\u0026gt; \u0026#39;color amarillo\u0026#39;, \u0026#39;green\u0026#39; =\u0026gt; \u0026#39;Color verde\u0026#39;, \u0026#39;purple\u0026#39; =\u0026gt; \u0026#39;Color púrpura\u0026#39;, \u0026#39;pink\u0026#39; =\u0026gt; \u0026#39;Color rosa\u0026#39; ]; return view(\u0026#39;admin.tags.create\u0026#39;, compact(\u0026#39;colors\u0026#39;)); } Como el formulario lo voy a volver a utilizar para editar las etiquetas, lo voy a factorizar de forma que solo tenga que crearlo y realizar las modificaciones futuras sobre un solo archivo. Para ello creo la carpeta resourses/views/admin/tags/partialsy dentro el archivo form.blade.php con los imputs del formulario recién creado.\nform.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre:\u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el nombre de la categoria\u0026#39;]) !!} @error(\u0026#39;name\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug:\u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el slug de la categoria\u0026#39;, \u0026#39;readonly\u0026#39;]) !!} @error(\u0026#39;slug\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;color\u0026#39;, \u0026#39;Color:\u0026#39;) !!} {!! Form::select(\u0026#39;color\u0026#39;, $colors, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;]) !!} @error(\u0026#39;color\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; y lo incluyo dentro de la vista resources/views/admin/tags/create.blade.php.\ncreate.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Crear Etiqueta\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui va un formulario para crear una etiqueta.\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.tags.store\u0026#39;]) !!} @include(\u0026#39;admin.tags.partials.form\u0026#39;) {!! Form::submit(\u0026#39;Crear etiqueta\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); \u0026lt;/script\u0026gt; @endsection Al hacer clic en el botón Crear etiqueta toda la información del formulario se envía a la ruta admin.tags.store que es gestionada por el método store del controlador TagController.php. En este método valido los datos recibido en $request y los almaceno como un registro en la tabla tags de la base de datos del blog. Acto seguido le pido que me redirija a la ruta admin.tags.index a la que le paso un mensaje de éxito.\nTagController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ........... /** * Store a newly created resource in storage. * * @param \\Illuminate\\Http\\Request $request * @return \\Illuminate\\Http\\Response */ public function store(Request $request) { $request-\u0026gt;validate([ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;slug\u0026#39; =\u0026gt; \u0026#39;required|unique:tags\u0026#39;, \u0026#39;color\u0026#39; =\u0026gt; \u0026#39;required\u0026#39; ]); Tag::create($request-\u0026gt;all()); return redirect()-\u0026gt;route(\u0026#39;admin.tags.index\u0026#39;)-\u0026gt;with(\u0026#39;info\u0026#39;, \u0026#39;La etiqueta se creo con éxito.\u0026#39;); } ................... Para que esto funcione debo de habilitar la asignación masiva en el modelo Tag.php.\nTag.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Database\\Eloquent\\Model; class Tag extends Model { use HasFactory; protected $fillable = [\u0026#39;name\u0026#39;, \u0026#39;slug\u0026#39;, \u0026#39;color\u0026#39;]; //habilito la asignación masiva public function getRouteKeyName() //convierto las rutas en amigables { return \u0026#34;slug\u0026#34;; } // relacion muchos a muuchos con post public function posts() { return $this-\u0026gt;belongsToMany(Post::class); } } Edición de una etiqueta\nEn la edición de etiquetas voy a necesitar el método edit del controlador TagController.php que me mostrará el formulario de edición de la vista resourdces/admin/tags/edit.blade.php en el voy a incluir el formulario resources/admin/tags/partials/form.blade.php.\nmétodo edit de TagController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /** * Show the form for editing the specified resource. * * @param App\\Models\\Tag $tag * @return \\Illuminate\\Http\\Response */ public function edit(Tag $tag) { // Array con los valores del select que le paso a la vista edit $colors = [ \u0026#39;red\u0026#39; =\u0026gt; \u0026#39;Color rojo\u0026#39;, \u0026#39;yellow\u0026#39; =\u0026gt; \u0026#39;Color amarillo\u0026#39;, \u0026#39;blue\u0026#39; =\u0026gt; \u0026#39;Color azul\u0026#39;, \u0026#39;green\u0026#39; =\u0026gt; \u0026#39;Color verde\u0026#39;, \u0026#39;indigo\u0026#39; =\u0026gt; \u0026#39;Color índigo\u0026#39;, \u0026#39;pink\u0026#39; =\u0026gt; \u0026#39;Color rosa\u0026#39;, \u0026#39;purple\u0026#39; =\u0026gt; \u0026#39;Color morado\u0026#39; ]; return view(\u0026#39;admin.tags.edit\u0026#39;, compact(\u0026#39;tag\u0026#39;, \u0026#39;colors\u0026#39;)); } El formulario de la vista edit nos dirige a la ruta admin.tags.update a la que pasamos $tag a editar utilizando el método put.\nedit.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Editar una etiqueta\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;formulario edicion etiqueta.\u0026lt;/p\u0026gt; @if (session(\u0026#39;info\u0026#39;)) \u0026lt;div class=\u0026#34; alert alert-success\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;{{session(\u0026#39;info\u0026#39;)}}\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @endif \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::model($tag, [\u0026#39;route\u0026#39; =\u0026gt; [\u0026#39;admin.tags.update\u0026#39;, $tag], \u0026#39;method\u0026#39; =\u0026gt; \u0026#39;put\u0026#39;]) !!} @include(\u0026#39;admin.tags.partials.form\u0026#39;) {!! Form::submit(\u0026#39;Editar etiqueta\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;css\u0026#39;) \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/css/admin_custom.css\u0026#34;\u0026gt; @stop // Codigo para autocompletar correctamente el campo slug con los datos del campo name. @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); \u0026lt;/script\u0026gt; @endsection Al hacer clic en el botón editar etiqueta los datos del formulario de la vista edit son enviados a la ruta admin.tags.update que es controlado por el método update del controlador TagController.php. En este método valido los datos recibidos en la variable $request y los actualizo en el registro almacenado en la variable $tag en la tabla tags de la base de datos. Conseguido esto, le pido que me redirija a la ruta admin.tags.edit a la que le paso un mensaje de éxito.\nMétodo update del tagController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 .................... /** * Update the specified resource in storage. * * @param \\Illuminate\\Http\\Request $request * @param App\\Models\\Tag$tag * @return \\Illuminate\\Http\\Response */ public function update(Request $request, Tag $tag) { $request-\u0026gt;validate([ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;slug\u0026#39; =\u0026gt; \u0026#34;required|unique:tags,slug,$tag-\u0026gt;id\u0026#34;, //ignora el slug de la etiqueta $tag que quiero actualizar \u0026#39;color\u0026#39; =\u0026gt; \u0026#39;required\u0026#39; ]); $tag-\u0026gt;update($request-\u0026gt;all()); return redirect()-\u0026gt;route(\u0026#39;admin.tags.edit\u0026#39;, $tag)-\u0026gt;with(\u0026#39;info\u0026#39;, \u0026#39;La etiqueta se actualizó con éxito.\u0026#39;); } ................... Eliminando una etiqueta\nSi hago clic en el botón eliminar la información de la etiqueta se envía a la ruta admin.tags.destroyque es administrada por el método destroy del controlador TagController.php. En este método elimino el registro en la base de datos y que me redirecciona a la ruta admin.tags.index donde me muestra una alerta de borrado del registro.\nMétodo destroy de TagController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ................ /** * Remove the specified resource from storage. * * @param App\\Models\\Tag $tag * @return \\Illuminate\\Http\\Response */ public function destroy(Tag $tag) { $tag-\u0026gt;delete(); return redirect()-\u0026gt;route(\u0026#39;admin.tags.index\u0026#39;)-\u0026gt;with(\u0026#39;info-del\u0026#39;, \u0026#39;La etiqueta se eliminó con éxito.\u0026#39;); } } ................ Contenido final del controlador:\nTagController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 \u0026lt;?php namespace App\\Http\\Controllers\\Admin; use App\\Http\\Controllers\\Controller; use App\\Models\\Tag; use Illuminate\\Http\\Request; class TagController extends Controller { /** * Display a listing of the resource. * * @return \\Illuminate\\Http\\Response */ public function index() { $tags = Tag::all(); return view(\u0026#39;admin.tags.index\u0026#39;, compact(\u0026#39;tags\u0026#39;)); } /** * Show the form for creating a new resource. * * @return \\Illuminate\\Http\\Response */ public function create() { $colors = [ \u0026#39;red\u0026#39; =\u0026gt; \u0026#39;Color rojo\u0026#39;, \u0026#39;yellow\u0026#39; =\u0026gt; \u0026#39;Color amarillo\u0026#39;, \u0026#39;blue\u0026#39; =\u0026gt; \u0026#39;Color azul\u0026#39;, \u0026#39;green\u0026#39; =\u0026gt; \u0026#39;Color verde\u0026#39;, \u0026#39;indigo\u0026#39; =\u0026gt; \u0026#39;Color índigo\u0026#39;, \u0026#39;pink\u0026#39; =\u0026gt; \u0026#39;Color rosa\u0026#39;, \u0026#39;purple\u0026#39; =\u0026gt; \u0026#39;Color morado\u0026#39; ]; return view(\u0026#39;admin.tags.create\u0026#39;, compact(\u0026#39;colors\u0026#39;)); } /** * Store a newly created resource in storage. * * @param \\Illuminate\\Http\\Request $request * @return \\Illuminate\\Http\\Response */ public function store(Request $request) { $request-\u0026gt;validate([ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;slug\u0026#39; =\u0026gt; \u0026#39;required|unique:tags\u0026#39;, \u0026#39;color\u0026#39; =\u0026gt; \u0026#39;required\u0026#39; ]); Tag::create($request-\u0026gt;all()); return redirect()-\u0026gt;route(\u0026#39;admin.tags.index\u0026#39;)-\u0026gt;with(\u0026#39;info\u0026#39;, \u0026#39;La etiqueta se creo con éxito.\u0026#39;); } /** * Display the specified resource. * * @param App\\Models\\Tag $tag * @return \\Illuminate\\Http\\Response */ public function show(Tag $tag) { // } /** * Show the form for editing the specified resource. * * @param App\\Models\\Tag $tag * @return \\Illuminate\\Http\\Response */ public function edit(Tag $tag) { $colors = [ \u0026#39;red\u0026#39; =\u0026gt; \u0026#39;Color rojo\u0026#39;, \u0026#39;yellow\u0026#39; =\u0026gt; \u0026#39;Color amarillo\u0026#39;, \u0026#39;blue\u0026#39; =\u0026gt; \u0026#39;Color azul\u0026#39;, \u0026#39;green\u0026#39; =\u0026gt; \u0026#39;Color verde\u0026#39;, \u0026#39;indigo\u0026#39; =\u0026gt; \u0026#39;Color índigo\u0026#39;, \u0026#39;pink\u0026#39; =\u0026gt; \u0026#39;Color rosa\u0026#39;, \u0026#39;purple\u0026#39; =\u0026gt; \u0026#39;Color morado\u0026#39; ]; return view(\u0026#39;admin.tags.edit\u0026#39;, compact(\u0026#39;tag\u0026#39;, \u0026#39;colors\u0026#39;)); } /** * Update the specified resource in storage. * * @param \\Illuminate\\Http\\Request $request * @param App\\Models\\Tag$tag * @return \\Illuminate\\Http\\Response */ public function update(Request $request, Tag $tag) { $request-\u0026gt;validate([ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;slug\u0026#39; =\u0026gt; \u0026#34;required|unique:tags,slug,$tag-\u0026gt;id\u0026#34;, //ignora el slug de la etiqueta $tag que quiero actualizar \u0026#39;color\u0026#39; =\u0026gt; \u0026#39;required\u0026#39; ]); $tag-\u0026gt;update($request-\u0026gt;all()); return redirect()-\u0026gt;route(\u0026#39;admin.tags.edit\u0026#39;, $tag)-\u0026gt;with(\u0026#39;info\u0026#39;, \u0026#39;La etiqueta se actualizó con éxito.\u0026#39;); } /** * Remove the specified resource from storage. * * @param App\\Models\\Tag $tag * @return \\Illuminate\\Http\\Response */ public function destroy(Tag $tag) { $tag-\u0026gt;delete(); return redirect()-\u0026gt;route(\u0026#39;admin.tags.index\u0026#39;)-\u0026gt;with(\u0026#39;info-del\u0026#39;, \u0026#39;La etiqueta se eliminó con éxito.\u0026#39;); } } ","pubDate":"2021-01-31","title":"Creando el crud de etiquetas - VIII "},{"link":"https://esaborit.github.io/posts/crud_categorias/","plain":"Creando un crud para las categorías del blog Genero en admin.php una ruta de tipo resources que me genere las rutas para el crud de las categorías. Antes creo un controlador para categorías que me genere ya los 7 métodos.\n1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller Admin/CategoryController -r Controller created successfully. CategoryController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 \u0026lt;?php namespace App\\Http\\Controllers\\Admin; use App\\Http\\Controllers\\Controller; use Illuminate\\Http\\Request; class CategoryController extends Controller { /** * Display a listing of the resource. * * @return \\Illuminate\\Http\\Response */ public function index() { // } /** * Show the form for creating a new resource. * * @return \\Illuminate\\Http\\Response */ public function create() { // } /** * Store a newly created resource in storage. * * @param \\Illuminate\\Http\\Request $request * @return \\Illuminate\\Http\\Response */ public function store(Request $request) { // } /** * Display the specified resource. * * @param int $id * @return \\Illuminate\\Http\\Response */ public function show($id) { // } /** * Show the form for editing the specified resource. * * @param int $id * @return \\Illuminate\\Http\\Response */ public function edit($id) { // } /** * Update the specified resource in storage. * * @param \\Illuminate\\Http\\Request $request * @param int $id * @return \\Illuminate\\Http\\Response */ public function update(Request $request, $id) { // } /** * Remove the specified resource from storage. * * @param int $id * @return \\Illuminate\\Http\\Response */ public function destroy($id) { // } } Dentro del archivo admin.php creo la ruta de tipo resources para categorías se la asigno al controlador CategoryController y le digo que los nombres de las rutas comiencen por admin.categories.\n1 2 3 4 5 6 7 use App\\Http\\Controllers\\Admin\\CategoryController; use App\\Http\\Controllers\\Admin\\HomeController; use Illuminate\\Support\\Facades\\Route; Route::get(\u0026#39;\u0026#39;, [HomeController::class, \u0026#39;index\u0026#39;])-\u0026gt;name(\u0026#39;admin.home\u0026#39;); Route::resource(\u0026#39;categories\u0026#39;, CategoryController::class)-\u0026gt;names(\u0026#39;admin.categories\u0026#39;); Si observo las rutas creadas veo que los parámetros que pasamos son de tipo categoy (en singular)\nEsto no coincide con los parámetros que pasamos en los métodos del controlador. Los cambio en el controlador para que sean objetos de tipo Category, y añado las vistas que quiero que muestren los metodos index, show, edit y create\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 \u0026lt;?php namespace App\\Http\\Controllers\\Admin; use App\\Http\\Controllers\\Controller; use App\\Models\\Category; use Illuminate\\Http\\Request; class CategoryController extends Controller { /** * Display a listing of the resource. * * @return \\Illuminate\\Http\\Response */ public function index() { return view(\u0026#39;admin.categories.index\u0026#39;); } /** * Show the form for creating a new resource. * * @return \\Illuminate\\Http\\Response */ public function create() { return view(\u0026#39;admin.categories.create\u0026#39;); } /** * Store a newly created resource in storage. * * @param \\Illuminate\\Http\\Request $request * @return \\Illuminate\\Http\\Response */ public function store(Request $request) { // } /** * Display the specified resource. * * @param int $id * @return \\Illuminate\\Http\\Response */ public function show(Category $category) { return view(\u0026#39;admin.categories.show\u0026#39;, compact(\u0026#39;category\u0026#39;)); } /** * Show the form for editing the specified resource. * * @param int $id * @return \\Illuminate\\Http\\Response */ public function edit(Category $category) { return view(\u0026#39;admin.categories.edit\u0026#39;, compact(\u0026#39;category\u0026#39;)); } /** * Update the specified resource in storage. * * @param \\Illuminate\\Http\\Request $request * @param int $id * @return \\Illuminate\\Http\\Response */ public function update(Request $request, Category $category) { // } /** * Remove the specified resource from storage. * * @param int $id * @return \\Illuminate\\Http\\Response */ public function destroy(Category $category) { // } } Creo las vistas de dichos métodos (index, show, edit y create) resources/views/admin/categories/index.blade.php, resources/views/admin/categories/show.blade.php, resources/views/admin/categories/edit.blade.php y resources/views/admin/categories/create.blade.php y extiendo la plantilla adminLTE a cada una de ellas. Por ejemplo:\ncreate.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Crear categoría\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui va un formulario para Crear categoria.\u0026lt;/p\u0026gt; @stop @section(\u0026#39;css\u0026#39;) \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/css/admin_custom.css\u0026#34;\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script\u0026gt; console.log(\u0026#39;Hi!\u0026#39;); \u0026lt;/script\u0026gt; @stop Quiero empezar mostrando el listado de las categorías en una tabla. Para ello modifico la plantilla resources/views/admin/categories/index.blade.php y el método index del controlador CategoryController.php.\nmétodo index de CategoryController.php\n1 2 3 4 5 6 7 8 9 10 11 /** * Display a listing of the resource. * * @return \\Illuminate\\Http\\Response */ public function index() { $categories = Category::all(); return view(\u0026#39;admin.categories.index\u0026#39;, compact(\u0026#39;categories\u0026#39;)); } index.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Lista de categorías.\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui aparece un listado de categorías\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-header\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34; btn btn-secondary float-right\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.categories.create\u0026#39;)}}\u0026#34;\u0026gt;Crear Categoría\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;table class=\u0026#34; table table-striped\u0026#34;\u0026gt; \u0026lt;thead\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;Id\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Nombre\u0026lt;/th\u0026gt; \u0026lt;th colspan=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;tbody\u0026gt; @foreach ($categories as $category) \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;{{$category-\u0026gt;id}}\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;{{$category-\u0026gt;name}}\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt;\u0026lt;a class=\u0026#34; btn btn-primary btn-sm\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.categories.edit\u0026#39;, $category)}}\u0026#34;\u0026gt;Editar\u0026lt;/a\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt; \u0026lt;form action=\u0026#34;{{route(\u0026#39;admin.categories.destroy\u0026#39;, $category)}}\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; @csrf @method(\u0026#39;delete\u0026#39;) \u0026lt;button class=\u0026#34;btn btn-danger btn-sm\u0026#34; type=\u0026#34;submit\u0026#34;\u0026gt;Eliminar\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; @endforeach \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;css\u0026#39;) \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/css/admin_custom.css\u0026#34;\u0026gt; @stop @section(\u0026#39;js\u0026#39;) @stop En esta vista he creado una tabla dentro de la que listo las categorías por su id y su nombre. Le añado a cada una un botón para editarla que me dirige a ala vista edit.blade.php y otro botón mediante un formulario que me permite utilizar la ruta admin.categories.destroy y el método destroy del controlador. Este formulario lo envío usando el método delete que recomienda laravel para lo cual debo incluir @method('delete')en el formulario.\nTambién he creado un botón para crear una nueva categoría que me redirige mediante la ruta admmin.categories.create a la vista create.blade.php donde un formulario me permite crear una nueva categoría. La vista index.blade.php se ve así.\nPara crear los formularios del blog me voy a ayudar de un componente de laravel llamado laravelcollective cuyo sitio web me indica en su sección docs que para poder usar el paquete debo usando composer desde la linea de comandos y escribir el siguiente comando:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 enrique@enrique-server:/var/www/laravel/blog_laravel$ composer require laravelcollective/html Using version ^6.2 for laravelcollective/html ./composer.json has been updated Running composer update laravelcollective/html Loading composer repositories with package information Updating dependencies Lock file operations: 1 install, 0 updates, 0 removals - Locking laravelcollective/html (v6.2.1) Writing lock file Installing dependencies from lock file (including require-dev) Package operations: 1 install, 0 updates, 0 removals - Downloading laravelcollective/html (v6.2.1) - Installing laravelcollective/html (v6.2.1): Extracting archive Generating optimized autoload files \u0026gt; Illuminate\\Foundation\\ComposerScripts::postAutoloadDump \u0026gt; @php artisan package:discover --ansi Discovered Package: facade/ignition Discovered Package: fideloper/proxy Discovered Package: fruitcake/laravel-cors Discovered Package: jenssegers/agent Discovered Package: jeroennoten/laravel-adminlte Discovered Package: laravel/fortify Discovered Package: laravel/jetstream Discovered Package: laravel/sail Discovered Package: laravel/sanctum Discovered Package: laravel/tinker Discovered Package: laravelcollective/html Discovered Package: livewire/livewire Discovered Package: nesbot/carbon Discovered Package: nunomaduro/collision Package manifest generated successfully. 75 packages you are using are looking for funding. Use the `composer fund` command to find out more! Ahora ya puedo ir a resources/views/admin/categories/create.blade.php y crear el formulario.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Crear categoría\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui va un formulario para Crear categoria.\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.categories.store\u0026#39;]) !!} \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre\u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el nombre de la categoria\u0026#39;]) !!} \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug\u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el slug de la categoria\u0026#39;, \u0026#39;readonly\u0026#39;]) !!} \u0026lt;/div\u0026gt; {!! Form::submit(\u0026#39;Crear categoría\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop Para automatizar la creación del slug voy a utilizar un pluging de JQuery, de manera que el usuario no tenga que escribir nada y evitar errores.\nLo descargo en la carpeta public/vendor desde su página web.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 enrique@enrique-server:/var/www/laravel/blog_laravel/public/vendor$ wget https://github.com/leocaseiro/jQuery-Plugin-stringToSlug/archive/1.3.zip --2021-01-14 15:34:04-- https://github.com/leocaseiro/jQuery-Plugin-stringToSlug/archive/1.3.zip Resolving github.com (github.com)... 140.82.121.4 Connecting to github.com (github.com)|140.82.121.4|:443... connected. HTTP request sent, awaiting response... 302 Found Location: https://codeload.github.com/leocaseiro/jQuery-Plugin-stringToSlug/zip/1.3 [following] --2021-01-14 15:34:04-- https://codeload.github.com/leocaseiro/jQuery-Plugin-stringToSlug/zip/1.3 Resolving codeload.github.com (codeload.github.com)... 140.82.121.10 Connecting to codeload.github.com (codeload.github.com)|140.82.121.10|:443... connected. HTTP request sent, awaiting response... 200 OK Length: unspecified [application/zip] Saving to: ‘1.3.zip’ 1.3.zip [ \u0026lt;=\u0026gt; ] 27.88K --.-KB/s in 0.09s 2021-01-14 15:34:05 (312 KB/s) - ‘1.3.zip’ saved [28544] lo descomprimo\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 enrique@enrique-server:/var/www/laravel/blog_laravel/public/vendor$ unzip 1.3.zip Archive: 1.3.zip b553fe235853f0afb4fcfa2b5d08d9381a274e7e creating: jQuery-Plugin-stringToSlug-1.3/ inflating: jQuery-Plugin-stringToSlug-1.3/README.md inflating: jQuery-Plugin-stringToSlug-1.3/jquery.StringToSlug.jquery.json inflating: jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.js inflating: jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js inflating: jQuery-Plugin-stringToSlug-1.3/samples.html creating: jQuery-Plugin-stringToSlug-1.3/tests/ inflating: jQuery-Plugin-stringToSlug-1.3/tests/index.html inflating: jQuery-Plugin-stringToSlug-1.3/tests/minimal-test.html inflating: jQuery-Plugin-stringToSlug-1.3/tests/qunit.css inflating: jQuery-Plugin-stringToSlug-1.3/tests/qunit.js inflating: jQuery-Plugin-stringToSlug-1.3/tests/tests.js Creo una sección js debajo de la sección content y copio dos script, uno para importar el archivo jquery.stringToSlug.min.js y otra donde escribo el código que relaciona los inputs de name y slug.\ncreate.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Crear categoría\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui va un formulario para Crear categoria.\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.categories.store\u0026#39;]) !!} \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre\u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el nombre de la categoria\u0026#39;]) !!} \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug\u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el slug de la categoria\u0026#39;, \u0026#39;readonly\u0026#39;]) !!} \u0026lt;/div\u0026gt; {!! Form::submit(\u0026#39;Crear categoría\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); \u0026lt;/script\u0026gt; @endsection Al hacer clic en el botón de submit los datos del formulario se envían por la ruta admin.categories.storeal método store del controlador CategoryController.php. En este método valido los datos y los almaceno en la tabla categories de la base de datos. Dedo habilitar la asignación masiva en el modelo app/Models/Category.php. Para lo cual declaro la propiedad fillable dentro de la entidad Category.php.\nCategory.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Database\\Eloquent\\Model; class Category extends Model { use HasFactory; protected $fillable = [\u0026#39;name\u0026#39;, \u0026#39;slug\u0026#39;]; //habilito la asignación masiva en name y slug // Relaccion uno a muchos posts public function posts() { return $this-\u0026gt;hasMany(Post::class); } } Ambos campos son requeridos y ademas el campo slug debe de ser único en la tabla categorias.\nCategoryController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ...... /** * Store a newly created resource in storage. * * @param \\Illuminate\\Http\\Request $request * @return \\Illuminate\\Http\\Response */ public function store(Request $request) { $request-\u0026gt;validate([ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;slug\u0026#39; =\u0026gt; \u0026#39;required|unique:categories\u0026#39; ]); Category::create($request-\u0026gt;all()); return redirect()-\u0026gt;route(\u0026#39;admin.categories.index\u0026#39;); } ..... Inserto los posibles errores de validación (dentro de la directiva de blade @error) de los campos name y slug en la vista\ncreate.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 .......... @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui va un formulario para Crear categoría.\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::open([\u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.categories.store\u0026#39;]) !!} \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre\u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el nombre de la categoria\u0026#39;]) !!} @error(\u0026#39;name\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug\u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el slug de la categoria\u0026#39;, \u0026#39;readonly\u0026#39;]) !!} @error(\u0026#39;slug\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; {!! Form::submit(\u0026#39;Crear categoría\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop .......... Compruebo el funcionamiento del formulario para crear una categoría haciendo clic en el botón crear categoría de la lista de categorias. Aparece una vista donde puedo crear una nueva categoría.\nAl rellenar el campo de nombre, se auto rellena el de slug y al hacer clic en el botón Crear categoría se validan los campos antes de crear el registro en la tabla, si hay errores en algún campo se muestran debajo de el.\nSi la validación ha sido correcta, guarda el registro en la tabla categories y me redirige al listado de categorías.\nActualizar o editar un registro\nHago clic en el boton editar de una categoria cualquiera y la ruta admin.categories.edit me dirige al método edit del controllador el cual pasa a la vista edit.blade.php el objeto almacenado en la variable $category para mostrarlo en el formulario de la vista en el que se va a editar sus campos. Me baso en el formulario realizado para la vista create.blade.php y lo modifico.\nedit.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Edita una categoría.\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Editar detalle de la categoría.\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::model($category, [\u0026#39;route\u0026#39; =\u0026gt; [\u0026#39;admin.categories.update\u0026#39;, $category], \u0026#39;method\u0026#39; =\u0026gt; \u0026#39;put\u0026#39;]) !!} \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre\u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el nombre de la categoría\u0026#39;]) !!} @error(\u0026#39;name\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug\u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el slug de la categoría\u0026#39;, \u0026#39;readonly\u0026#39;]) !!} @error(\u0026#39;slug\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; {!! Form::submit(\u0026#39;Actualizar categoría\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script src=\u0026#34;{{asset(\u0026#39;vendor/jQuery-Plugin-stringToSlug-1.3/jquery.stringToSlug.min.js\u0026#39;)}}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; $(document).ready( function() { $(\u0026#34;#name\u0026#34;).stringToSlug({ setEvents: \u0026#39;keyup keydown blur\u0026#39;, getPut: \u0026#39;#slug\u0026#39;, space: \u0026#39;-\u0026#39; }); }); \u0026lt;/script\u0026gt; @endsection El método utilizado para enviar este formulario es el método put y la ruta debe de ser admin.categories.update a la que debo pasar como parámetro $category. Para rellenar los campos con los datos de la categoría a editar para ello cambio Form::open por Form::model y le paso la variable $category. Quedaría así: {!! Form::model($category, ['route' =\u0026gt; ['admin.categories.update', $category], 'method' =\u0026gt; 'put']) !!}.\nSi hago clic en el botón actualizar categoría la información del formulario se envía a la ruta admin.categories.updateque es administrada por el método update del controlador CategoryController.php. En este método valido la información recibida y si pasa la validación la actualizo en la base de datos y que me redireccione a la ruta admin.categories.edit. Además quiero que ignore el slug del registro que quiero actualizar (cambio 'required|unique:categories' por \u0026quot;required|unique:categories,slug,$category-\u0026gt;id\u0026quot; ignorando el slug de la categoría que quiero actualizar).\nPor último quiero que se muestre una alerta indicando que se ha actualizado el registro con éxito. Lo condigo enviando un mensaje de sesión (with('info', 'La categoría se actualizó con éxito.')) que debo de recoger la vista admin.categories.edit.\nMétodo update de CategoryController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ........ /** * Update the specified resource in storage. * * @param \\Illuminate\\Http\\Request $request * @param int $id * @return \\Illuminate\\Http\\Response */ public function update(Request $request, Category $category) { $request-\u0026gt;validate([ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required\u0026#39;, \u0026#39;slug\u0026#39; =\u0026gt; \u0026#34;required|unique:categories,slug,$category-\u0026gt;id\u0026#34; //ignora el slug de la categoria que quiero actualizar ]); $category-\u0026gt;update($request-\u0026gt;all()); return redirect()-\u0026gt;route(\u0026#39;admin.categories.edit\u0026#39;, $category)-\u0026gt;with(\u0026#39;info\u0026#39;, \u0026#39;La categoría se actualizó con éxito.\u0026#39;); } ......... edit.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Editar detalle de la categoría.\u0026lt;/p\u0026gt; @if (session(\u0026#39;info\u0026#39;)) \u0026lt;div class=\u0026#34; alert alert-success\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;{{session(\u0026#39;info\u0026#39;)}}\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @endif \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; {!! Form::model($category, [\u0026#39;route\u0026#39; =\u0026gt; [\u0026#39;admin.categories.update\u0026#39;, $category], \u0026#39;method\u0026#39; =\u0026gt; \u0026#39;put\u0026#39;]) !!} \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;name\u0026#39;, \u0026#39;Nombre\u0026#39;) !!} {!! Form::text(\u0026#39;name\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el nombre de la categoría\u0026#39;]) !!} @error(\u0026#39;name\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; {!! Form::label(\u0026#39;slug\u0026#39;, \u0026#39;Slug\u0026#39;) !!} {!! Form::text(\u0026#39;slug\u0026#39;, null, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;form-control\u0026#39;, \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;ingresa el slug de la categoría\u0026#39;, \u0026#39;readonly\u0026#39;]) !!} @error(\u0026#39;slug\u0026#39;) \u0026lt;span class=\u0026#34; text-danger\u0026#34;\u0026gt;{{$message}}\u0026lt;/span\u0026gt; @enderror \u0026lt;/div\u0026gt; {!! Form::submit(\u0026#39;Actualizar categoría\u0026#39;, [\u0026#39;class\u0026#39; =\u0026gt; \u0026#39;btn btn-primary\u0026#39;]) !!} {!! Form::close() !!} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop Esta alerta se puede crear en el método store para que se muestre en la plantilla index al crear una categoría nueva.\nEliminar una categoría\nSi hago clic en el botón eliminar la información de la categoría se envía a la ruta admin.categories.destroyque es administrada por el método destroy del controlador CategoryController.php. En este método elimino el registro en la base de datos y que me redirecciona a la ruta admin.categories.index donde me muestra una alerta de borrado del registro.\n1 2 3 4 5 6 7 8 9 10 11 12 /** * Remove the specified resource from storage. * * @param int $id * @return \\Illuminate\\Http\\Response */ public function destroy(Category $category) { $category-\u0026gt;delete(); return redirect()-\u0026gt;route(\u0026#39;admin.categories.index\u0026#39;)-\u0026gt;with(\u0026#39;info-del\u0026#39;, \u0026#39;La categoría se ha eliminado con éxito\u0026#39;); } En la vista añado una condición al if para que recoja la variable de sesión infodel y muestre la alerta de borrado de la categoría.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Aqui aparecerán las categorías\u0026lt;/p\u0026gt; @if (session(\u0026#39;info\u0026#39;)) \u0026lt;div class=\u0026#34; alert alert-success\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;{{session(\u0026#39;info\u0026#39;)}}\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @elseif(session(\u0026#39;info-del\u0026#39;)) \u0026lt;div class=\u0026#34; alert alert-danger\u0026#34;\u0026gt; \u0026lt;strong\u0026gt;{{session(\u0026#39;info-del\u0026#39;)}}\u0026lt;/strong\u0026gt; \u0026lt;/div\u0026gt; @endif \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-header\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34; btn btn-secondary\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.categories.create\u0026#39;)}}\u0026#34;\u0026gt;Crear Categoría\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;table class=\u0026#34; table table-striped\u0026#34;\u0026gt; \u0026lt;thead\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;Id\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Nombre\u0026lt;/th\u0026gt; \u0026lt;th colspan=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;tbody\u0026gt; @foreach ($categories as $category) \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;{{$category-\u0026gt;id}}\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;{{$category-\u0026gt;name}}\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt;\u0026lt;a class=\u0026#34; btn btn-primary btn-sm\u0026#34; href=\u0026#34;{{route(\u0026#39;admin.categories.edit\u0026#39;, $category)}}\u0026#34;\u0026gt;Editar\u0026lt;/a\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th width=\u0026#34;10px\u0026#34;\u0026gt; \u0026lt;form action=\u0026#34;{{route(\u0026#39;admin.categories.destroy\u0026#39;, $category)}}\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; @csrf @method(\u0026#39;delete\u0026#39;) \u0026lt;button class=\u0026#34;btn btn-danger btn-sm\u0026#34; type=\u0026#34;submit\u0026#34;\u0026gt;Eliminar\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; @endforeach \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @stop Pantalla después de haber borrado una categoría.\nURL amigables en categorías\nPara que el la url no aparezca el id de la categoría sino su lug debo crear un método getRouteKeyName en el modelo app/Models/Category.php\nCategory.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Database\\Eloquent\\Model; class Category extends Model { use HasFactory; protected $fillable = [\u0026#39;name\u0026#39;, \u0026#39;slug\u0026#39;]; public function getRouteKeyName() { return \u0026#34;slug\u0026#34;; } // Relaccion uno a muchos posts public function posts() { return $this-\u0026gt;hasMany(Post::class); } } Ahora ya muestra el slug como se puede apreciar el la siguiente imagen.\n","pubDate":"2021-01-30","title":"Creando el crud de categorías - VII "},{"link":"https://esaborit.github.io/posts/adminlte_en_el_proyecto/","plain":"Integrando AdminLTE en el proyecto Para la gestión de la parte administrativa voy a usar el paquete AdminLTE 3\nVoy a generar una url llamada admin que utilizaré para desarrollar la parte de administración del blog. Esta url no la voy a declarar en el fichero web.php sino que creo uno nuevo llamado routes/admin.php dentro del cual iré definiendo las rutas de administrador. Para que laravel reconozca al archivo admin.php como administrador de rutas debo especificárselo dentro del método boot del archivo app/Providers/RouteServiceProvider.php\nRouteServiceProvider.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 /** * Define your route model bindings, pattern filters, etc. * * @return void */ public function boot() { $this-\u0026gt;configureRateLimiting(); $this-\u0026gt;routes(function () { Route::prefix(\u0026#39;api\u0026#39;) -\u0026gt;middleware(\u0026#39;api\u0026#39;) -\u0026gt;namespace($this-\u0026gt;namespace) -\u0026gt;group(base_path(\u0026#39;routes/api.php\u0026#39;)); Route::middleware(\u0026#39;web\u0026#39;) -\u0026gt;namespace($this-\u0026gt;namespace) -\u0026gt;group(base_path(\u0026#39;routes/web.php\u0026#39;)); Route::middleware(\u0026#39;web\u0026#39;, \u0026#39;auth\u0026#39;) -\u0026gt;prefix(\u0026#39;admin\u0026#39;) -\u0026gt;namespace($this-\u0026gt;namespace) -\u0026gt;group(base_path(\u0026#39;routes/admin.php\u0026#39;)); }); } Como se puede ver al final he añadido a admin.php como administrador de rutas y he especificado el middleware auth para que solo se accesible si estamos autentificados y el método prefix para añadir el prefijo admin a todas las rutas y así no tener que escribirlo en todas.\nCreo la primera ruta dentro del fichero administrador de rutas admin.php que acabo de crear y le añado el nombre del controlador que va a gestionar la ruta.\n1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller Admin/HomeController Controller created successfully. Admin\\HomeController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;?php namespace App\\Http\\Controllers\\Admin; use App\\Http\\Controllers\\Controller; use Illuminate\\Http\\Request; class HomeController extends Controller { public function index() { return view(\u0026#39;admin.index\u0026#39;); } } admin.php\n1 2 3 4 5 6 \u0026lt;?php use App\\Http\\Controllers\\Admin\\HomeController; use Illuminate\\Support\\Facades\\Route; Route::get(\u0026#39;\u0026#39;, [HomeController::class, \u0026#39;index\u0026#39;]); Creo la vista resources/views/admin/index.blade.php y pongo un texto de prueba\nindex.blade.php\n1 Hola Administrador Voy al navegador me logeo y testeo la ruta y veo que funciona\nEl siguiente paso es instalar adminLTE.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 enrique@enrique-server:/var/www/laravel/blog_laravel$ composer require jeroennoten/laravel-adminlte Using version ^3.5 for jeroennoten/laravel-adminlte ./composer.json has been updated Running composer update jeroennoten/laravel-adminlte Loading composer repositories with package information Updating dependencies Lock file operations: 2 installs, 0 updates, 0 removals - Locking almasaeed2010/adminlte (v3.0.5) - Locking jeroennoten/laravel-adminlte (v3.5.0) Writing lock file Installing dependencies from lock file (including require-dev) Package operations: 2 installs, 0 updates, 0 removals - Downloading almasaeed2010/adminlte (v3.0.5) - Downloading jeroennoten/laravel-adminlte (v3.5.0) - Installing almasaeed2010/adminlte (v3.0.5): Extracting archive - Installing jeroennoten/laravel-adminlte (v3.5.0): Extracting archive Generating optimized autoload files \u0026gt; Illuminate\\Foundation\\ComposerScripts::postAutoloadDump \u0026gt; @php artisan package:discover --ansi Discovered Package: facade/ignition Discovered Package: fideloper/proxy Discovered Package: fruitcake/laravel-cors Discovered Package: jenssegers/agent Discovered Package: jeroennoten/laravel-adminlte Discovered Package: laravel/fortify Discovered Package: laravel/jetstream Discovered Package: laravel/sail Discovered Package: laravel/sanctum Discovered Package: laravel/tinker Discovered Package: livewire/livewire Discovered Package: nesbot/carbon Discovered Package: nunomaduro/collision Package manifest generated successfully. 75 packages you are using are looking for funding. Use the `composer fund` command to find out more! Como ya estoy usando un sistema de autenticación con jetstream me salto el paso de :\n1 2 composer require laravel/ui php artisan ui vue --auth y paso al siguiente:\n1 2 3 4 5 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan adminlte:install Basic assets installed successfully. Configuration file installed successfully. Translation files installed successfully. The installation is complete. Ya está instalado en el proyecto. Para poder usarlo sigo las instrucciones de su página y dentro de la vista ``resources/views/admin/index.blade.php`\nextiendo su plantilla.\nindex.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 @extends(\u0026#39;adminlte::page\u0026#39;) @section(\u0026#39;title\u0026#39;, \u0026#39;Blog con Laravel\u0026#39;) @section(\u0026#39;content_header\u0026#39;) \u0026lt;h1\u0026gt;Dashboard\u0026lt;/h1\u0026gt; @stop @section(\u0026#39;content\u0026#39;) \u0026lt;p\u0026gt;Welcome to this beautiful admin panel.\u0026lt;/p\u0026gt; @stop @section(\u0026#39;css\u0026#39;) \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/css/admin_custom.css\u0026#34;\u0026gt; @stop @section(\u0026#39;js\u0026#39;) \u0026lt;script\u0026gt; console.log(\u0026#39;Hi!\u0026#39;); \u0026lt;/script\u0026gt; @stop Vuelvo al navegador web para revisar los cambios.\nPersonalizando la plantilla adminLTE Para comenzar la personalización abro el archivo php config/adminlte.php y cambio su nombre en el logo y el enlace para que me dirija a página principal situada en el directorio raíz.\nadminlte.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 /* |-------------------------------------------------------------------------- | Logo |-------------------------------------------------------------------------- | | Here you can change the logo of your admin panel. | | For more detailed instructions you can look here: | https://github.com/jeroennoten/Laravel-AdminLTE/#63-logo | */ \u0026#39;logo\u0026#39; =\u0026gt; \u0026#39;\u0026lt;b\u0026gt;Blog\u0026lt;/b\u0026gt; de Buceo\u0026#39;, . . . . /* |-------------------------------------------------------------------------- | URLs |-------------------------------------------------------------------------- | | Here we can modify the url settings of the admin panel. | | For more detailed instructions you can look here: | https://github.com/jeroennoten/Laravel-AdminLTE/#65-urls | */ \u0026#39;use_route_url\u0026#39; =\u0026gt; false, \u0026#39;dashboard_url\u0026#39; =\u0026gt; \u0026#39;/\u0026#39;, Necesito incluir en el menú de navegación de la derecha situado en resources/views/livewire/navigation.blade.php, un enlace que permita a los administradores acceder al panel de administración. \u0026lt;a href=\u0026quot;{{route('admin.home')}}\u0026quot; class=\u0026quot;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026quot; role=\u0026quot;menuitem\u0026quot;\u0026gt;Dashboard\u0026lt;/a\u0026gt;\nnavigation.blade.php\n1 2 3 4 5 6 7 8 9 10 11 ......... \u0026lt;div x-show=\u0026#34;open\u0026#34; x-on:click.away=\u0026#34;open = false\u0026#34; class=\u0026#34;origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5\u0026#34; role=\u0026#34;menu\u0026#34; aria-orientation=\u0026#34;vertical\u0026#34; aria-labelledby=\u0026#34;user-menu\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;{{route(\u0026#39;profile.show\u0026#39;)}}\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Tu perfil\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;{{route(\u0026#39;admin.home\u0026#39;)}}\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Dashboard\u0026lt;/a\u0026gt; \u0026lt;form method=\u0026#34;POST\u0026#34; action=\u0026#34;{{ route(\u0026#39;logout\u0026#39;) }}\u0026#34;\u0026gt; @csrf \u0026lt;a href=\u0026#34;{{ route(\u0026#39;logout\u0026#39;) }}\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34; onclick=\u0026#34;event.preventDefault(); this.closest(\u0026#39;form\u0026#39;).submit();\u0026#34;\u0026gt;Cerra sesion\u0026lt;/a\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; .......... Lo siguiente que quiero es modificar es el menú de navegación de la barra lateral de la izquierda. Para ello dentro de adminlte.php modifico la sección Menu Items.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 /* |-------------------------------------------------------------------------- | Menu Items |-------------------------------------------------------------------------- | | Here we can modify the sidebar/top navigation of the admin panel. | | For more detailed instructions you can look here: | https://github.com/jeroennoten/Laravel-AdminLTE/#8-menu-configuration | */ \u0026#39;menu\u0026#39; =\u0026gt; [ [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;search\u0026#39;, \u0026#39;search\u0026#39; =\u0026gt; true, \u0026#39;topnav\u0026#39; =\u0026gt; true, ], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;blog\u0026#39;, \u0026#39;url\u0026#39; =\u0026gt; \u0026#39;admin/blog\u0026#39;, \u0026#39;can\u0026#39; =\u0026gt; \u0026#39;manage-blog\u0026#39;, ], [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;pages\u0026#39;, \u0026#39;url\u0026#39; =\u0026gt; \u0026#39;admin/pages\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;far fa-fw fa-file\u0026#39;, \u0026#39;label\u0026#39; =\u0026gt; 4, \u0026#39;label_color\u0026#39; =\u0026gt; \u0026#39;success\u0026#39;, ], Cambio el item pages por dashboard y cambio su icono y su url (uso la ruta en su lugar, es lo mismo).\n1 2 3 4 5 [ \u0026#39;text\u0026#39; =\u0026gt; \u0026#39;Dashboard\u0026#39;, \u0026#39;route\u0026#39; =\u0026gt; \u0026#39;admin.home\u0026#39;, \u0026#39;icon\u0026#39; =\u0026gt; \u0026#39;fas fa-tachometer-alt fa-fw\u0026#39;, ], El resultado se puede ver en la siguiente imagen\n","pubDate":"2021-01-29","title":"Creando el backend del blog -VI "},{"link":"https://esaborit.github.io/posts/mostrando_y_filtrando_posts/","plain":"Mostrando el detalle de un post Creo una ruta en web.php para mostrar el detalle de un post.\nweb.php\n1 Route::get(\u0026#39;posts/{post}\u0026#39;, [PostController::class, \u0026#39;show\u0026#39;])-\u0026gt;name(\u0026#39;posts.show\u0026#39;); Creo en método show en el controllador PostController.php al que le paso como parámetro un objeto post. Dentro de el recupero los post que pertenecen a la misma categoría que el en la variable $similares y se los paso junto con la variable $post a la vista posts.show.\nPostController.php\n1 2 3 4 5 6 7 8 9 10 11 public function show(Post $post) { $similares = Post::where(\u0026#39;category_id\u0026#39;, $post-\u0026gt;category_id) -\u0026gt;where(\u0026#39;status\u0026#39;, 2) -\u0026gt;where(\u0026#39;id\u0026#39;, \u0026#39;!=\u0026#39;, $post-\u0026gt;id) -\u0026gt;latest(\u0026#39;id\u0026#39;) -\u0026gt;take(4) -\u0026gt;get(); return view(\u0026#39;posts.show\u0026#39;, compact(\u0026#39;post\u0026#39;, \u0026#39;similares\u0026#39;)); } Creo la vista laravel/blog_laravel/resources/views/posts/category.blade.php. Dentro de ella extiendo la plantilla principal muestro un listado paginado de los posts asociados a la categoría correspondiente.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026lt;x-app-layout\u0026gt; \u0026lt;div class=\u0026#34; micontainer py-8\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34; text-4xl font-bold text-gray-600\u0026#34;\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/h1\u0026gt; \u0026lt;div class=\u0026#34; text-lg text-gray-500 mb-2\u0026#34;\u0026gt; {{$post-\u0026gt;extract}} \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;grid grid-cols-1 lg:grid-cols-3 gap-6\u0026#34;\u0026gt; {{-- Contenido principal --}} \u0026lt;div class=\u0026#34; lg:col-span-2\u0026#34;\u0026gt; \u0026lt;figure\u0026gt; \u0026lt;img class=\u0026#34; w-full h-80 object-cover object-center\u0026#34; src=\u0026#34;{{Storage::url($post-\u0026gt;image-\u0026gt;url)}}\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;/figure\u0026gt; \u0026lt;div class=\u0026#34; text-base text-gray-500 mt-4\u0026#34;\u0026gt; {{$post-\u0026gt;body}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; {{-- Contenido relacionado--}} \u0026lt;aside\u0026gt; \u0026lt;h1 class=\u0026#34; text-2xl font-bold text-gray-600 mb-4\u0026#34;\u0026gt;Más en: {{$post-\u0026gt;category-\u0026gt;name}}\u0026lt;/h1\u0026gt; \u0026lt;ul\u0026gt; @foreach ($similares as $similar) \u0026lt;li class=\u0026#34; mb-4\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34;flex\u0026#34; href=\u0026#34;{{Route(\u0026#39;posts.show\u0026#39;, $similar)}}\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34; w-40 h-20 object-cover object-center \u0026#34; src=\u0026#34;{{Storage::url($similar-\u0026gt;image-\u0026gt;url)}}\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34; ml-2 text-gray-600\u0026#34;\u0026gt;{{$similar-\u0026gt;name}}\u0026lt;/span\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt; @endforeach \u0026lt;/ul\u0026gt; \u0026lt;/aside\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/x-app-layout\u0026gt; Para poder mostrar el detalle del post debo añadir la ruta al enlace de cada post en el listado de la vista resources/views/posts/index.blade.php\nindex.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026lt;x-app-layout\u0026gt; \u0026lt;div class=\u0026#34;micontainer py-8\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\u0026#34;\u0026gt; @foreach ($posts as $post) \u0026lt;article class=\u0026#34; w-full h-80 bg-cover bg-center @if($loop-\u0026gt;first) md:col-span-2 @endif\u0026#34; style=\u0026#34;background-image: url({{Storage::url($post-\u0026gt;image-\u0026gt;url)}})\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34; w-full h-full px-8 flex flex-col justify-center\u0026#34;\u0026gt; \u0026lt;div\u0026gt; @foreach ($post-\u0026gt;tags as $tag) \u0026lt;a href=\u0026#34;\u0026#34; class=\u0026#34; inline-block px-3 h-6 bg-{{$tag-\u0026gt;color}}-600 text-white rounded-full\u0026#34;\u0026gt;{{$tag-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;h1 class=\u0026#34; text-4xl text-white leading-8 font-bold\u0026#34;\u0026gt; {{-- Enlace al detalle del post--}} \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.show\u0026#39;, $post)}}\u0026#34;\u0026gt; {{$post-\u0026gt;name}} \u0026lt;/a\u0026gt; \u0026lt;/h1\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/article\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34; mt-4\u0026#34;\u0026gt; {{$posts-\u0026gt;links()}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/x-app-layout\u0026gt; Filtrando post por categorías Creo una ruta en web.php para mostrar los post por categorías\nweb.php\n1 Route::get(\u0026#39;category/{category}\u0026#39;, [PostController::class, \u0026#39;category\u0026#39;])-\u0026gt;name(\u0026#39;posts.category\u0026#39;); Creo el método category en el controlador PostController.php al que le paso como parámetro un objeto de la clase category. Dentro de el recupero todos los posts que pertenecen a la categoría y se los paso en la variable $posts junto con la variable $category a la vista posts.category.\nPostController.php\n1 2 3 4 5 6 public function category(Category $category) { $posts = Post::where(\u0026#39;category_id\u0026#39;, $category-\u0026gt;id)-\u0026gt;where(\u0026#39;status\u0026#39;, 2)-\u0026gt;latest(\u0026#39;id\u0026#39;)-\u0026gt;paginate(5); return view(\u0026#39;posts.category\u0026#39;, compact(\u0026#39;posts\u0026#39;, \u0026#39;category\u0026#39;)); } Creo la vista laravel/blog_laravel/resources/views/posts/category.blade.php. Dentro de ella extiendo la plantilla principal muestro un listado paginado de los posts asociados a la categoría correspondiente.\ncategory.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;x-app-layout\u0026gt; \u0026lt;div class=\u0026#34; max-w-5xl mx-auto px-2 sm:px-6 lg:px-8 py-8\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34; uppercase text-center text-3xl font-bold\u0026#34;\u0026gt;Categoria: {{$category-\u0026gt;name}}\u0026lt;/h1\u0026gt; @foreach ($posts as $post) \u0026lt;article class=\u0026#34;mb-8 bg-white shadow-lg rounded-lg overflow-hidden\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34; w-full h-72 object-cover object-center\u0026#34; src=\u0026#34;{{Storage::url($post-\u0026gt;image-\u0026gt;url)}}\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;px-6 py-4\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34; font-bold text-xl mb-2\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.show\u0026#39;, $post)}}\u0026#34;\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/a\u0026gt; \u0026lt;/h1\u0026gt; \u0026lt;div class=\u0026#34; text-gray-700 text-base\u0026#34;\u0026gt; {{$post-\u0026gt;extract}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;px-6 pt-4 pb-2\u0026#34;\u0026gt; @foreach ($post-\u0026gt;tags as $tag) \u0026lt;a href=\u0026#34;\u0026#34; class=\u0026#34; inline-block bg-gray-200 rounded-full px-3 py-1 text-sm text-gray-700 mr-2\u0026#34;\u0026gt;{{$tag-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;/article\u0026gt; @endforeach \u0026lt;div class=\u0026#34; mb-4\u0026#34;\u0026gt; {{$posts-\u0026gt;links()}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/x-app-layout\u0026gt; Para poder acceder a la ruta debo de añadir el enlace en el menú navigation desarrollado con livewire . abro el archivo laravel/blog_laravel/resources/views/livewire/navigation.blade.phpy modifico el enlace\nnavigation.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 .............. \u0026lt;!-- barra de menu lg--\u0026gt; \u0026lt;div class=\u0026#34;hidden sm:block sm:ml-6\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;flex space-x-4\u0026#34;\u0026gt; @foreach ($categorias as $categoria) \u0026lt;!-- Current: \u0026#34;bg-gray-900 text-white\u0026#34;, Default: \u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white\u0026#34; --\u0026gt; \u0026lt;!--\u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;Dashboard\u0026lt;/a\u0026gt;--\u0026gt; \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.category\u0026#39;, $categoria)}}\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;{{$categoria-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ..................... Para reutilizar mejor el código voy a llevar el código que utilizo para crear la tarjeta que muestra los post por categorías a un componente anónimo blade, para ello creo la carpeta resources/views/components y dentro de ella el componente resources/views/components/card-post.blade.php.\nDentro de este componente pego el código que me genera la tarjeta de cada post y que se encontraba en category.blade.php\ncard-post.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026lt;article class=\u0026#34;mb-8 bg-white shadow-lg rounded-lg overflow-hidden\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34; w-full h-72 object-cover object-center\u0026#34; src=\u0026#34;{{Storage::url($post-\u0026gt;image-\u0026gt;url)}}\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;px-6 py-4\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34; font-bold text-xl mb-2\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.show\u0026#39;, $post)}}\u0026#34;\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/a\u0026gt; \u0026lt;/h1\u0026gt; \u0026lt;div class=\u0026#34; text-gray-700 text-base\u0026#34;\u0026gt; {{$post-\u0026gt;extract}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;px-6 pt-4 pb-2\u0026#34;\u0026gt; @foreach ($post-\u0026gt;tags as $tag) \u0026lt;a href=\u0026#34;\u0026#34; class=\u0026#34; inline-block bg-gray-200 rounded-full px-3 py-1 text-sm text-gray-700 mr-2\u0026#34;\u0026gt;{{$tag-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;/article\u0026gt; Llamo al componente creado \u0026lt;x-card-post :post=\u0026quot;$post\u0026quot;/\u0026gt; desde la vista resources/views/posts/category.blade.php\ncategory.blade.php\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;x-app-layout\u0026gt; \u0026lt;div class=\u0026#34; max-w-5xl mx-auto px-2 sm:px-6 lg:px-8 py-8\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34; uppercase text-center text-3xl font-bold\u0026#34;\u0026gt;Categoria: {{$category-\u0026gt;name}}\u0026lt;/h1\u0026gt; @foreach ($posts as $post) \u0026lt;x-card-post :post=\u0026#34;$post\u0026#34;/\u0026gt; @endforeach \u0026lt;div class=\u0026#34; mb-4\u0026#34;\u0026gt; {{$posts-\u0026gt;links()}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/x-app-layout\u0026gt; Y lo recibo en el componente card-post.blade.php utilizando la directiva de blade @props(['post']).\ncard-post.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 @props([\u0026#39;post\u0026#39;]) \u0026lt;article class=\u0026#34;mb-8 bg-white shadow-lg rounded-lg overflow-hidden\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34; w-full h-72 object-cover object-center\u0026#34; src=\u0026#34;{{Storage::url($post-\u0026gt;image-\u0026gt;url)}}\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;px-6 py-4\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34; font-bold text-xl mb-2\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.show\u0026#39;, $post)}}\u0026#34;\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/a\u0026gt; \u0026lt;/h1\u0026gt; \u0026lt;div class=\u0026#34; text-gray-700 text-base\u0026#34;\u0026gt; {{$post-\u0026gt;extract}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;px-6 pt-4 pb-2\u0026#34;\u0026gt; @foreach ($post-\u0026gt;tags as $tag) \u0026lt;a href=\u0026#34;\u0026#34; class=\u0026#34; inline-block bg-gray-200 rounded-full px-3 py-1 text-sm text-gray-700 mr-2\u0026#34;\u0026gt;{{$tag-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;/article\u0026gt; Ahora ya puedo aplicar este componente anónimo de blade a la plantilla que me muestre los post por etiquetas.\nFiltrando post por etiquetas Lo primero es crear una ruta en web.php\nweb.php\n1 Route::get(\u0026#39;tag/{tag}\u0026#39;, [PostController::class, \u0026#39;tag\u0026#39;])-\u0026gt;name(\u0026#39;posts.tag\u0026#39;); Luego creo el método tag en el controlador PostController.php al que paso como parámetro un objeto tipo tag . Dentro de el recupero coleccion de post publicados que tienen la etiqueta pasada por parametro. Por ultimo devuelvo la vista tag.blade.php a la que paso las variables $posts y $tag.\nPostController.php\n1 2 3 4 5 6 public function tag(Tag $tag) { $posts = $tag-\u0026gt;posts()-\u0026gt;where(\u0026#39;status\u0026#39;, 2)-\u0026gt;latest(\u0026#39;id\u0026#39;)-\u0026gt;paginate(5); return view(\u0026#39;posts.tag\u0026#39;, compact(\u0026#39;posts\u0026#39;, \u0026#39;tag\u0026#39;)); } Creo la lista resources/views/posts/tag.blade.php dentro de la cual extiendo la plantilla principal del proyecto y muestro los posts ayudándome del componente anónimo de blade recién creado para mostrar tarjetas \u0026lt;x-card-post :post=\u0026quot;$post\u0026quot;/\u0026gt; tag.blade.php\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;x-app-layout\u0026gt; \u0026lt;div class=\u0026#34; max-w-5xl mx-auto px-2 sm:px-6 lg:px-8 py-8\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34; uppercase text-center text-3xl font-bold\u0026#34;\u0026gt;Etiqueta: {{$tag-\u0026gt;name}}\u0026lt;/h1\u0026gt; @foreach ($posts as $post) \u0026lt;x-card-post :post=\u0026#34;$post\u0026#34;/\u0026gt; @endforeach \u0026lt;div class=\u0026#34; mb-4\u0026#34;\u0026gt; {{$posts-\u0026gt;links()}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/x-app-layout\u0026gt; Para completar este filtrado debo añadir las rutas a los enlaces en las vistas index.blade.phpy car-post.blade.php\ncard-post.blade.php\n1 2 3 4 5 \u0026lt;div class=\u0026#34;px-6 pt-4 pb-2\u0026#34;\u0026gt; @foreach ($post-\u0026gt;tags as $tag) \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.tag\u0026#39;, $tag)}}\u0026#34; class=\u0026#34; inline-block bg-gray-200 rounded-full px-3 py-1 text-sm text-gray-700 mr-2\u0026#34;\u0026gt;{{$tag-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; index.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 .............................. @foreach ($posts as $post) \u0026lt;article class=\u0026#34; w-full h-80 bg-cover bg-center @if($loop-\u0026gt;first) md:col-span-2 @endif\u0026#34; style=\u0026#34;background-image: url({{Storage::url($post-\u0026gt;image-\u0026gt;url)}})\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34; w-full h-full px-8 flex flex-col justify-center\u0026#34;\u0026gt; \u0026lt;div\u0026gt; @foreach ($post-\u0026gt;tags as $tag) \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.tag\u0026#39;, $tag)}}\u0026#34; class=\u0026#34; inline-block px-3 h-6 bg-{{$tag-\u0026gt;color}}-600 text-white rounded-full\u0026#34;\u0026gt;{{$tag-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;h1 class=\u0026#34; text-4xl text-white leading-8 font-bold pt-2\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;{{route(\u0026#39;posts.show\u0026#39;, $post)}}\u0026#34;\u0026gt; {{$post-\u0026gt;name}} \u0026lt;/a\u0026gt; \u0026lt;/h1\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/article\u0026gt; @endforeach .................................. ","pubDate":"2021-01-28","title":"Mostrando y filtrando posts - V"},{"link":"https://esaborit.github.io/posts/listado_de_posts_en_la_pagina_principal/","plain":"Listado de posts Voy a mostrar un listado con los pos almacenados en la base de datos, para ello debo empezar creando un controlador en el que recogeré una variable con los post y desde donde llamar a una vista para mostrarlos. Creo un controlador llamado PostController.\n1 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:controller PostController entro en la clase app/Http/Controllers/PostController.php y la edito como he dicho anteriormente\nPostController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026lt;?php namespace App\\Http\\Controllers; use App\\Models\\Post; use Illuminate\\Http\\Request; class PostController extends Controller { public function index() { $posts = Post::where(\u0026#39;status\u0026#39;, 2)-\u0026gt;get(); // Filtro para que solo recoga los publicados return view(\u0026#39;posts.index\u0026#39;, compact(\u0026#39;posts\u0026#39;)); } } Creo la vista resources/views/posts/index.blade.php en la que extiendo la plantilla principal app/View/Components/AppLayout.php.\nindex.blade.php\n1 2 3 4 5 6 7 8 \u0026lt;x-app-layout\u0026gt; @foreach ($posts as $post) \u0026lt;p\u0026gt;{{$post-\u0026gt;name}}\u0026lt;/p\u0026gt; @endforeach \u0026lt;/x-app-layout\u0026gt; En el controlador de rutas le asigno el control de la ruta principal del blog al controlador PostController.\nweb.php\n1 2 3 4 5 6 7 8 9 10 \u0026lt;?php use App\\Http\\Controllers\\PostController; use Illuminate\\Support\\Facades\\Route; Route::get(\u0026#39;/\u0026#39;, [PostController::class, \u0026#39;index\u0026#39;])-\u0026gt;name(\u0026#39;posts.index\u0026#39;); Route::middleware([\u0026#39;auth:sanctum\u0026#39;, \u0026#39;verified\u0026#39;])-\u0026gt;get(\u0026#39;/dashboard\u0026#39;, function () { return view(\u0026#39;dashboard\u0026#39;); })-\u0026gt;name(\u0026#39;dashboard\u0026#39;); Por si acaso refresco la cache de las rutas.\n1 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan route:cache Voy a crear una clase personalizada para dar los estilos comunes a todo el proyecto. Me apoyo en laravelmix para conseguirlo. Creo el archivo resources/css/common.css que contendrá mis clases personalizadas.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 .micontainer{ @apply max-w-7xl mx-auto px-2; } @media(min-width:640px){ .micontainer{ @apply px-6; } } @media(min-width:1024px){ .micontainer{ @apply px-8; } } Para que laravel reconozca el archivo commom.css debo importarlo dentro de resources/css/app.css\napp.css\n1 2 3 4 5 @import \u0026#39;tailwindcss/base\u0026#39;; @import \u0026#39;tailwindcss/components\u0026#39;; @import \u0026#39;tailwindcss/utilities\u0026#39;; @import \u0026#39;commom.css\u0026#39;; Compilo los cambios desde la terminal\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 enrique@enrique-server:/var/www/laravel/blog_laravel$ npm run dev \u0026gt; @ dev /var/www/laravel/blog_laravel \u0026gt; npm run development \u0026gt; @ development /var/www/laravel/blog_laravel \u0026gt; cross-env NODE_ENV=development node_modules/webpack/bin/webpack.js --progress --config=node_modules/laravel-mix/setup/webpack.config.js 98% after emitting SizeLimitsPlugin DONE Compiled successfully in 59375ms 11:06:21 AM Asset Size Chunks Chunk Names /css/app.css 4.38 MiB /js/app [emitted] /js/app /js/app.js 669 KiB /js/app [emitted] /js/app Quiero mostrar los post de forma paginada y solo 8 cada vez por lo que modifico el método index dePostController.php\nPostController.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026lt;?php namespace App\\Http\\Controllers; use App\\Models\\Post; use Illuminate\\Http\\Request; class PostController extends Controller { public function index() { $posts = Post::where(\u0026#39;status\u0026#39;, 2)-\u0026gt;latest(\u0026#39;id\u0026#39;)-\u0026gt;paginate(8); return view(\u0026#39;posts.index\u0026#39;, compact(\u0026#39;posts\u0026#39;)); } } Modifico la vista para que me muestre la imagen de cada post, su titulo y las etiquetas que posee. LE añado tambien la paginacion y lo hago responsive.\nindex.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026lt;x-app-layout\u0026gt; \u0026lt;div class=\u0026#34;micontainer py-8\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\u0026#34;\u0026gt; \u0026lt;!-- Añado md: y lg: para hacerlo responsive--\u0026gt; @foreach ($posts as $post) \u0026lt;article class=\u0026#34; w-full h-80 bg-cover bg-center @if($loop-\u0026gt;first) md:col-span-2 @endif\u0026#34; style=\u0026#34;background-image: url({{Storage::url($post-\u0026gt;image-\u0026gt;url)}})\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34; w-full h-full px-8 flex flex-col justify-center\u0026#34;\u0026gt; \u0026lt;div\u0026gt; @foreach ($post-\u0026gt;tags as $tag) \u0026lt;a href=\u0026#34;\u0026#34; class=\u0026#34; inline-block px-3 h-6 bg-{{$tag-\u0026gt;color}}-600 text-white rounded-full\u0026#34;\u0026gt;{{$tag-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;h1 class=\u0026#34; text-4xl text-white leading-8 font-bold\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;\u0026#34;\u0026gt; {{$post-\u0026gt;name}} \u0026lt;/a\u0026gt; \u0026lt;/h1\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/article\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34; mt-4\u0026#34;\u0026gt; {{$posts-\u0026gt;links()}} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/x-app-layout\u0026gt; ","pubDate":"2021-01-28","title":"Crear un listado de post en la página principal - IV"},{"link":"https://esaborit.github.io/posts/crear_un_menu_responsive_con_tailwind_y_alpine/","plain":"Menú responsive. El menú de navegación lo voy a incluir dentro de un componente de livewire\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:livewire navigation COMPONENT CREATED 🤙 CLASS: app/Http/Livewire/Navigation.php VIEW: resources/views/livewire/navigation.blade.php _._ / /o\\ \\ || () () __ |_\\ /_| || || \\\\// /_\\ \\\\ // || |~~ /_\\ |`|`| || || \\/ \\\\_ \\^/ || || \\\\_ Congratulations, you\u0026#39;ve created your first Livewire component! 🎉🎉🎉 Would you like to show some love by starring the repo? (yes/no) [no]: \u0026gt; no I understand, but am not going to pretend I\u0026#39;m not sad about it... Se han creado dos archivos, la clase app/Http/Livewire/Navigation.phpy la vista resources/views/livewire/navigation.blade.php\nLa clase Navigation.php renderiza el contenido de la vista navigation.blade.php\n¿Como llamo al componente y donde? Lo voy a llamar en la plantilla principal app.blade.php situada en la ruta resources/views/layouts/app.blade.php\napp.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 \u0026lt;!DOCTYPE \u0026gt; \u0026lt; lang=\u0026#34;{{ str_replace(\u0026#39;_\u0026#39;, \u0026#39;-\u0026#39;, app()-\u0026gt;getLocale()) }}\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;csrf-token\u0026#34; content=\u0026#34;{{ csrf_token() }}\u0026#34;\u0026gt; \u0026lt;title\u0026gt;{{ config(\u0026#39;app.name\u0026#39;, \u0026#39;Laravel\u0026#39;) }}\u0026lt;/title\u0026gt; \u0026lt;!-- Fonts --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700\u0026amp;display=swap\u0026#34;\u0026gt; \u0026lt;!-- Styles --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;{{ mix(\u0026#39;css/app.css\u0026#39;) }}\u0026#34;\u0026gt; @livewireStyles \u0026lt;!-- Scripts --\u0026gt; \u0026lt;script src=\u0026#34;{{ mix(\u0026#39;js/app.js\u0026#39;) }}\u0026#34; defer\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body class=\u0026#34;font-sans antialiased\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;min-h-screen bg-gray-100\u0026#34;\u0026gt; @livewire(\u0026#39;navigation-dropdown\u0026#39;) \u0026lt;!-- Page Heading --\u0026gt; \u0026lt;header class=\u0026#34;bg-white shadow\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8\u0026#34;\u0026gt; {{ $header }} \u0026lt;/div\u0026gt; \u0026lt;/header\u0026gt; \u0026lt;!-- Page Content --\u0026gt; \u0026lt;main\u0026gt; {{ $slot }} \u0026lt;/main\u0026gt; \u0026lt;/div\u0026gt; @stack(\u0026#39;modals\u0026#39;) @livewireScripts \u0026lt;/body\u0026gt; \u0026lt;/\u0026gt; En esta plantilla elimino toda la etiqueta header y sustituyo @livewire('navigation-dropdown') por nuestro componente livewire recien creado @livewire('navigation') .\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;!DOCTYPE \u0026gt; \u0026lt; lang=\u0026#34;{{ str_replace(\u0026#39;_\u0026#39;, \u0026#39;-\u0026#39;, app()-\u0026gt;getLocale()) }}\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;csrf-token\u0026#34; content=\u0026#34;{{ csrf_token() }}\u0026#34;\u0026gt; \u0026lt;title\u0026gt;{{ config(\u0026#39;app.name\u0026#39;, \u0026#39;Laravel\u0026#39;) }}\u0026lt;/title\u0026gt; \u0026lt;!-- Fonts --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700\u0026amp;display=swap\u0026#34;\u0026gt; \u0026lt;!-- Styles --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;{{ mix(\u0026#39;css/app.css\u0026#39;) }}\u0026#34;\u0026gt; @livewireStyles \u0026lt;!-- Scripts --\u0026gt; \u0026lt;script src=\u0026#34;{{ mix(\u0026#39;js/app.js\u0026#39;) }}\u0026#34; defer\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body class=\u0026#34;font-sans antialiased\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;min-h-screen bg-gray-100\u0026#34;\u0026gt; @livewire(\u0026#39;navigation\u0026#39;) \u0026lt;!-- Page Content --\u0026gt; \u0026lt;main\u0026gt; {{ $slot }} \u0026lt;/main\u0026gt; \u0026lt;/div\u0026gt; @stack(\u0026#39;modals\u0026#39;) @livewireScripts \u0026lt;/body\u0026gt; \u0026lt;/\u0026gt; De esta forma estoy llamando a la clase Navigation.php que renderiza el contenido de la vista navigation.blade.php. Si lo dejo así no me mostraria ningún menú pues el contenido de navigation.blade.php es un div vacío. Lo que hago es copiar el ejemplo de menú en la pagina de tailwind y pegarlo dentro.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 \u0026lt;nav class=\u0026#34;bg-gray-800\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;max-w-7xl mx-auto px-2 sm:px-6 lg:px-8\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;relative flex items-center justify-between h-16\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;absolute inset-y-0 left-0 flex items-center sm:hidden\u0026#34;\u0026gt; \u0026lt;!-- Mobile menu button--\u0026gt; \u0026lt;button class=\u0026#34;inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white\u0026#34; aria-expanded=\u0026#34;false\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;Open main menu\u0026lt;/span\u0026gt; \u0026lt;!-- Icon when menu is closed. --\u0026gt; \u0026lt;!-- Heroicon name: menu Menu open: \u0026#34;hidden\u0026#34;, Menu closed: \u0026#34;block\u0026#34; --\u0026gt; \u0026lt;svg class=\u0026#34;block h-6 w-6\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34; fill=\u0026#34;none\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; stroke=\u0026#34;currentColor\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;path stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; stroke-width=\u0026#34;2\u0026#34; d=\u0026#34;M4 6h16M4 12h16M4 18h16\u0026#34; /\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;!-- Icon when menu is open. --\u0026gt; \u0026lt;!-- Heroicon name: x Menu open: \u0026#34;block\u0026#34;, Menu closed: \u0026#34;hidden\u0026#34; --\u0026gt; \u0026lt;svg class=\u0026#34;hidden h-6 w-6\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34; fill=\u0026#34;none\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; stroke=\u0026#34;currentColor\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;path stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; stroke-width=\u0026#34;2\u0026#34; d=\u0026#34;M6 18L18 6M6 6l12 12\u0026#34; /\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;flex-1 flex items-center justify-center sm:items-stretch sm:justify-start\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;flex-shrink-0 flex items-center\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;block lg:hidden h-8 w-auto\u0026#34; src=\u0026#34;https://tailwindui.com/img/logos/workflow-mark-indigo-500.svg\u0026#34; alt=\u0026#34;Workflow\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;hidden lg:block h-8 w-auto\u0026#34; src=\u0026#34;https://tailwindui.com/img/logos/workflow-logo-indigo-500-mark-white-text.svg\u0026#34; alt=\u0026#34;Workflow\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;hidden sm:block sm:ml-6\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;flex space-x-4\u0026#34;\u0026gt; \u0026lt;!-- Current: \u0026#34;bg-gray-900 text-white\u0026#34;, Default: \u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white\u0026#34; --\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;Dashboard\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;Team\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;Projects\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;Calendar\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0\u0026#34;\u0026gt; \u0026lt;button class=\u0026#34;bg-gray-800 p-1 rounded-full text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;View notifications\u0026lt;/span\u0026gt; \u0026lt;!-- Heroicon name: bell --\u0026gt; \u0026lt;svg class=\u0026#34;h-6 w-6\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34; fill=\u0026#34;none\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; stroke=\u0026#34;currentColor\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;path stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; stroke-width=\u0026#34;2\u0026#34; d=\u0026#34;M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9\u0026#34; /\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;!-- Profile dropdown --\u0026gt; \u0026lt;div class=\u0026#34;ml-3 relative\u0026#34;\u0026gt; \u0026lt;div\u0026gt; \u0026lt;button class=\u0026#34;bg-gray-800 flex text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white\u0026#34; id=\u0026#34;user-menu\u0026#34; aria-haspopup=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;Open user menu\u0026lt;/span\u0026gt; \u0026lt;img class=\u0026#34;h-8 w-8 rounded-full\u0026#34; src=\u0026#34;https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1\u0026amp;ixid=eyJhcHBfaWQiOjEyMDd9\u0026amp;auto=format\u0026amp;fit=facearea\u0026amp;facepad=2\u0026amp;w=256\u0026amp;h=256\u0026amp;q=80\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!-- Profile dropdown panel, show/hide based on dropdown state. Entering: \u0026#34;transition ease-out duration-100\u0026#34; From: \u0026#34;transform opacity-0 scale-95\u0026#34; To: \u0026#34;transform opacity-100 scale-100\u0026#34; Leaving: \u0026#34;transition ease-in duration-75\u0026#34; From: \u0026#34;transform opacity-100 scale-100\u0026#34; To: \u0026#34;transform opacity-0 scale-95\u0026#34; --\u0026gt; \u0026lt;div class=\u0026#34;origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5\u0026#34; role=\u0026#34;menu\u0026#34; aria-orientation=\u0026#34;vertical\u0026#34; aria-labelledby=\u0026#34;user-menu\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Your Profile\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Settings\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Sign out\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!-- Mobile menu, toggle classes based on menu state. Menu open: \u0026#34;block\u0026#34;, Menu closed: \u0026#34;hidden\u0026#34; --\u0026gt; \u0026lt;div class=\u0026#34;hidden sm:hidden\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;px-2 pt-2 pb-3 space-y-1\u0026#34;\u0026gt; \u0026lt;!-- Current: \u0026#34;bg-gray-900 text-white\u0026#34;, Default: \u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white\u0026#34; --\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;bg-gray-900 text-white block px-3 py-2 rounded-md text-base font-medium\u0026#34;\u0026gt;Dashboard\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium\u0026#34;\u0026gt;Team\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium\u0026#34;\u0026gt;Projects\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium\u0026#34;\u0026gt;Calendar\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/nav\u0026gt; Lo guardo todo y veo los cambios desde el navegador web.\nComento los diferentes div del menú para su mejor identificación.\nComienzo a dar funcionalidad al menú móvil que tiene la propiedadhidden que le voy a quitar. Le mantengo la clase sm:hiddenque me permite ocultar el menú móvil en pantallas de resolución superior a 640 px.\nAl realizar la instalación de laravel con jetstream se instaló también Alpine por lo que ya puedo usarlo sin tener que instalar nada mas.\nPara ello considero al div del menú de la derecha como un componente de alpine y le agrego la propiedad x-data dentro de la que defino una variable llamada open que inicializo a false. Toda la interactividad que agrege va a ser a nivel de este componente y no fuera\n1 2 3 4 \u0026lt;!-- Profile dropdown --\u0026gt; \u0026lt;div class=\u0026#34;ml-3 relative\u0026#34; x-data=\u0026#34;{open: false}\u0026#34;\u0026gt; ....... \u0026lt;/div\u0026gt; Puedo utilizar el valor de esta variable para ocultar o mostrar el valor de algún div que se encuentre dentro del div al que hemos añadido la propiedad x-data. El div que quiero ocultar es el que me muestra las opciones del menú de la derecha. Para hacerlo le añado el metodo x-show={open}.\n1 2 3 4 5 \u0026lt;div x-show={open} class=\u0026#34;origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5\u0026#34; role=\u0026#34;menu\u0026#34; aria-orientation=\u0026#34;vertical\u0026#34; aria-labelledby=\u0026#34;user-menu\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Your Profile\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Settings\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Sign out\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; Además le debo de pasar un evento al botón que muestra el menú de la derecha x-on:click=\u0026quot;open = true\u0026quot;. para que la hacer click sobre el se muestre el menú.\n1 2 3 4 5 6 7 8 9 \u0026lt;!-- Profile dropdown --\u0026gt; \u0026lt;div class=\u0026#34;ml-3 relative\u0026#34; x-data=\u0026#34;{open: false}\u0026#34;\u0026gt; \u0026lt;div\u0026gt; \u0026lt;button x-on:click=\u0026#34;open = true\u0026#34; class=\u0026#34;bg-gray-800 flex text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white\u0026#34; id=\u0026#34;user-menu\u0026#34; aria-haspopup=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;Open user menu\u0026lt;/span\u0026gt; \u0026lt;img class=\u0026#34;h-8 w-8 rounded-full\u0026#34; src=\u0026#34;https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1\u0026amp;ixid=eyJhcHBfaWQiOjEyMDd9\u0026amp;auto=format\u0026amp;fit=facearea\u0026amp;facepad=2\u0026amp;w=256\u0026amp;h=256\u0026amp;q=80\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ........... Para completar la funcionalidad del menú le añado el método x-on:click.away=\u0026quot;open = false\u0026quot; al div que muestra las opciones del menú de la redera lo que me permitirá que cuando haga clic fuera de el se ocultará automaticamente.\nLa funcionalidad del componente queda así:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 \u0026lt;!-- Barra menu derecha--\u0026gt; \u0026lt;div class=\u0026#34;absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0\u0026#34;\u0026gt; \u0026lt;!-- Boton de alertas--\u0026gt; \u0026lt;button class=\u0026#34;bg-gray-800 p-1 rounded-full text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;View notifications\u0026lt;/span\u0026gt; \u0026lt;!-- Heroicon name: bell --\u0026gt; \u0026lt;svg class=\u0026#34;h-6 w-6\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34; fill=\u0026#34;none\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; stroke=\u0026#34;currentColor\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;path stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; stroke-width=\u0026#34;2\u0026#34; d=\u0026#34;M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9\u0026#34; /\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;!-- Profile dropdown --\u0026gt; \u0026lt;div class=\u0026#34;ml-3 relative\u0026#34; x-data=\u0026#34;{open: false}\u0026#34;\u0026gt; \u0026lt;div\u0026gt; \u0026lt;button x-on:click=\u0026#34;open = true\u0026#34; class=\u0026#34;bg-gray-800 flex text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white\u0026#34; id=\u0026#34;user-menu\u0026#34; aria-haspopup=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;Open user menu\u0026lt;/span\u0026gt; \u0026lt;img class=\u0026#34;h-8 w-8 rounded-full\u0026#34; src=\u0026#34;https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1\u0026amp;ixid=eyJhcHBfaWQiOjEyMDd9\u0026amp;auto=format\u0026amp;fit=facearea\u0026amp;facepad=2\u0026amp;w=256\u0026amp;h=256\u0026amp;q=80\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!-- Profile dropdown panel, show/hide based on dropdown state. Entering: \u0026#34;transition ease-out duration-100\u0026#34; From: \u0026#34;transform opacity-0 scale-95\u0026#34; To: \u0026#34;transform opacity-100 scale-100\u0026#34; Leaving: \u0026#34;transition ease-in duration-75\u0026#34; From: \u0026#34;transform opacity-100 scale-100\u0026#34; To: \u0026#34;transform opacity-0 scale-95\u0026#34; --\u0026gt; \u0026lt;div x-show=\u0026#34;open\u0026#34; x-on:click.away=\u0026#34;open = false\u0026#34; class=\u0026#34;origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5\u0026#34; role=\u0026#34;menu\u0026#34; aria-orientation=\u0026#34;vertical\u0026#34; aria-labelledby=\u0026#34;user-menu\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Your Profile\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Settings\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Sign out\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; Al otro div que voy a dar funcionalidad de la misma manera es a la etiqueta \u0026lt;nav\u0026gt; para que al hacer clic sobre el botón del menú móvil se despliegue y cierre el menú móvil que solo puede ser visible para pantalla de resolución inferios a 640 px.\nDotando de funcionalidad al menú Primero de todo extiendo la plantilla principal a la ruta raiz de mi proyecto. para ello edito resources/views/welcome.blade.php y añado la etiqueta \u0026lt;x-app-layout /\u0026gt; . Todo lo que escriba en su interior se rendizará dentro de la plantilla principal dentro de {{slot}}.\nwelcome.blade.php\n1 2 3 \u0026lt;x-app-layout\u0026gt; hola \u0026lt;/x-app-layout\u0026gt; app.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;!DOCTYPE \u0026gt; \u0026lt; lang=\u0026#34;{{ str_replace(\u0026#39;_\u0026#39;, \u0026#39;-\u0026#39;, app()-\u0026gt;getLocale()) }}\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;csrf-token\u0026#34; content=\u0026#34;{{ csrf_token() }}\u0026#34;\u0026gt; \u0026lt;title\u0026gt;{{ config(\u0026#39;app.name\u0026#39;, \u0026#39;Laravel\u0026#39;) }}\u0026lt;/title\u0026gt; \u0026lt;!-- Fonts --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700\u0026amp;display=swap\u0026#34;\u0026gt; \u0026lt;!-- Styles --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;{{ mix(\u0026#39;css/app.css\u0026#39;) }}\u0026#34;\u0026gt; @livewireStyles \u0026lt;!-- Scripts --\u0026gt; \u0026lt;script src=\u0026#34;{{ mix(\u0026#39;js/app.js\u0026#39;) }}\u0026#34; defer\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body class=\u0026#34;font-sans antialiased\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;min-h-screen bg-gray-100\u0026#34;\u0026gt; @livewire(\u0026#39;navigation\u0026#39;) \u0026lt;!-- Page Content --\u0026gt; \u0026lt;main\u0026gt; {{ $slot }} \u0026lt;/main\u0026gt; \u0026lt;/div\u0026gt; @stack(\u0026#39;modals\u0026#39;) @livewireScripts \u0026lt;/body\u0026gt; \u0026lt;/\u0026gt; Lo siguiente es añadir la funcionalidad a nuestro menú.\nnavigation.blade.php\nCambio el div que contiene a el logotipo por una etiqueta \u0026lt;a\u0026gt;que me dirija a la página principal.\n1 2 3 4 \u0026lt;a href=\u0026#34;/\u0026#34; class=\u0026#34;flex-shrink-0 flex items-center\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;block lg:hidden h-8 w-auto\u0026#34; src=\u0026#34;https://tailwindui.com/img/logos/workflow-mark-indigo-500.svg\u0026#34; alt=\u0026#34;Workflow\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;hidden lg:block h-8 w-auto\u0026#34; src=\u0026#34;https://tailwindui.com/img/logos/workflow-logo-indigo-500-mark-white-text.svg\u0026#34; alt=\u0026#34;Workflow\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; Encierro el menú derecho en una directiva @auth de blade que solo lo mostrará si estoy autentificado y si no mostrará dos enlaces: al registro y al login.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 \u0026lt;!-- Barra menu derecha--\u0026gt; @auth \u0026lt;div class=\u0026#34;absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0\u0026#34;\u0026gt; \u0026lt;!-- Boton de alertas--\u0026gt; \u0026lt;button class=\u0026#34;bg-gray-800 p-1 rounded-full text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;View notifications\u0026lt;/span\u0026gt; \u0026lt;!-- Heroicon name: bell --\u0026gt; \u0026lt;svg class=\u0026#34;h-6 w-6\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34; fill=\u0026#34;none\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; stroke=\u0026#34;currentColor\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;path stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; stroke-width=\u0026#34;2\u0026#34; d=\u0026#34;M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9\u0026#34; /\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;!-- Profile dropdown --\u0026gt; \u0026lt;div class=\u0026#34;ml-3 relative\u0026#34; x-data=\u0026#34;{open: false}\u0026#34;\u0026gt; \u0026lt;div\u0026gt; \u0026lt;button x-on:click=\u0026#34;open = true\u0026#34; class=\u0026#34;bg-gray-800 flex text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white\u0026#34; id=\u0026#34;user-menu\u0026#34; aria-haspopup=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;Open user menu\u0026lt;/span\u0026gt; \u0026lt;img class=\u0026#34;h-8 w-8 rounded-full\u0026#34; src=\u0026#34;https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1\u0026amp;ixid=eyJhcHBfaWQiOjEyMDd9\u0026amp;auto=format\u0026amp;fit=facearea\u0026amp;facepad=2\u0026amp;w=256\u0026amp;h=256\u0026amp;q=80\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div x-show=\u0026#34;open\u0026#34; x-on:click.away=\u0026#34;open = false\u0026#34; class=\u0026#34;origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5\u0026#34; role=\u0026#34;menu\u0026#34; aria-orientation=\u0026#34;vertical\u0026#34; aria-labelledby=\u0026#34;user-menu\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Your Profile\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Settings\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Sign out\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; @else \u0026lt;a href=\u0026#34;{{route(\u0026#39;login\u0026#39;)}}\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;Login\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;{{route(\u0026#39;register\u0026#39;)}}\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;Register\u0026lt;/a\u0026gt; @endauth Edito el cierre de sesión. Es una ruta de tipo post dentro de un formulario, voy a reutilizar la de jetstream en su vista navigation-dropdown.blade.php.\nLo mando a través de un evento.\n1 2 3 4 5 6 7 8 \u0026lt;div x-show=\u0026#34;open\u0026#34; x-on:click.away=\u0026#34;open = false\u0026#34; class=\u0026#34;origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5\u0026#34; role=\u0026#34;menu\u0026#34; aria-orientation=\u0026#34;vertical\u0026#34; aria-labelledby=\u0026#34;user-menu\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Tu perfil\u0026lt;/a\u0026gt; \u0026lt;!--\u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34;\u0026gt;Settings\u0026lt;/a\u0026gt;--\u0026gt; \u0026lt;form method=\u0026#34;POST\u0026#34; action=\u0026#34;{{ route(\u0026#39;logout\u0026#39;) }}\u0026#34;\u0026gt; @csrf \u0026lt;a href=\u0026#34;{{ route(\u0026#39;logout\u0026#39;) }}\u0026#34; class=\u0026#34;block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\u0026#34; role=\u0026#34;menuitem\u0026#34; onclick=\u0026#34;event.preventDefault(); this.closest(\u0026#39;form\u0026#39;).submit();\u0026#34;\u0026gt;Cerra sesion\u0026lt;/a\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; Lo siguiente que quiero actualizar es la barra de menú que aparece a la izquierda, quiero sustituir los enlaces de muestra que aparecen por las categorías del blog. Lo primero es almacenar todas las categorías en una variable dentro de la clase del componente App\\Http\\Livewire\\Navigation.php y pasárselas a la vista del componente.\nNavigation.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;?php namespace App\\Http\\Livewire; use Livewire\\Component; use App\\Models\\Category; class Navigation extends Component { public function render() { $categorias = Category::all(); return view(\u0026#39;livewire.navigation\u0026#39;, compact(\u0026#39;categorias\u0026#39;)); } } Luego, ya en la vista resources/views/livewire/navigation.blade.php recooro el array categorias con un bucle foreach y creo un enlace para cada categoría dentro de la barra del menú izquierdo.\nnavigation.blade.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 \u0026lt;!-- Barra menu izquierdo--\u0026gt; \u0026lt;div class=\u0026#34;flex-1 flex items-center justify-center sm:items-stretch sm:justify-start\u0026#34;\u0026gt; \u0026lt;!-- logotipo--\u0026gt; \u0026lt;a href=\u0026#34;/\u0026#34; class=\u0026#34;flex-shrink-0 flex items-center\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;block lg:hidden h-8 w-auto\u0026#34; src=\u0026#34;https://tailwindui.com/img/logos/workflow-mark-indigo-500.svg\u0026#34; alt=\u0026#34;Workflow\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;hidden lg:block h-8 w-auto\u0026#34; src=\u0026#34;https://tailwindui.com/img/logos/workflow-logo-indigo-500-mark-white-text.svg\u0026#34; alt=\u0026#34;Workflow\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;!-- barra de menu lg--\u0026gt; \u0026lt;div class=\u0026#34;hidden sm:block sm:ml-6\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;flex space-x-4\u0026#34;\u0026gt; @foreach ($categorias as $categoria) \u0026lt;!-- Current: \u0026#34;bg-gray-900 text-white\u0026#34;, Default: \u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white\u0026#34; --\u0026gt; \u0026lt;!--\u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;Dashboard\u0026lt;/a\u0026gt;--\u0026gt; \u0026lt;a href=\u0026#34;\u0026#34; class=\u0026#34;text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium\u0026#34;\u0026gt;{{$categoria-\u0026gt;name}}\u0026lt;/a\u0026gt; @endforeach \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ","pubDate":"2021-01-28","title":"Crear un menú responsive con Tailwind y Alpine - III"},{"link":"https://esaborit.github.io/posts/insertar_datos_de_prueba_con_seeders_y_factories/","plain":"Inserción de datos de prueba en la base de datos Voy a crear un factory para cada una de las entidades/tablas de mi base de datos, salvo para User que ya se creo con el proyecto.\nUserFactory.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026lt;?php namespace Database\\Factories; use App\\Models\\User; use Illuminate\\Database\\Eloquent\\Factories\\Factory; use Illuminate\\Support\\Str; class UserFactory extends Factory { /** * The name of the factory\u0026#39;s corresponding model. * * @var string */ protected $model = User::class; /** * Define the model\u0026#39;s default state. * * @return array */ public function definition() { return [ \u0026#39;name\u0026#39; =\u0026gt; $this-\u0026gt;faker-\u0026gt;name, \u0026#39;email\u0026#39; =\u0026gt; $this-\u0026gt;faker-\u0026gt;unique()-\u0026gt;safeEmail, \u0026#39;email_verified_at\u0026#39; =\u0026gt; now(), \u0026#39;password\u0026#39; =\u0026gt; \u0026#39;$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi\u0026#39;, // password \u0026#39;remember_token\u0026#39; =\u0026gt; Str::random(10), ]; } } Empiezo a crealos.\n1 2 3 4 5 6 7 8 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:factory CategoryFactory Factory created successfully. enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:factory PostFactory Factory created successfully. enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:factory TagFactory Factory created successfully. enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:factory ImageFactory Factory created successfully. Ahora abro cada uno de los factories creados y los edito. Debo de indicar en cada uno de ellos que campos de la tabla quiero que se llenen y con que tipo de datos.\nCategoryFactory.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 namespace Database\\Factories; use App\\Models\\Category; use Illuminate\\Database\\Eloquent\\Factories\\Factory; use Illuminate\\Support\\Str; class CategoryFactory extends Factory { /** * The name of the factory\u0026#39;s corresponding model. * * @var string */ protected $model = Category::class; /** * Define the model\u0026#39;s default state. * * @return array */ public function definition() { $name = $this-\u0026gt;faker-\u0026gt;unique()-\u0026gt;word(20); //genera una palabra aleatorioa y única return [ \u0026#39;name\u0026#39; =\u0026gt; $name, \u0026#39;slug\u0026#39; =\u0026gt; Str::slug($name) // Uso Str para que me genere el slug de $name ]; } } PostFactory.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 \u0026lt;?php namespace Database\\Factories; use App\\Models\\Category; use App\\Models\\Post; use App\\Models\\User; use Illuminate\\Database\\Eloquent\\Factories\\Factory; use Illuminate\\Support\\Str; class PostFactory extends Factory { /** * The name of the factory\u0026#39;s corresponding model. * * @var string */ protected $model = Post::class; /** * Define the model\u0026#39;s default state. * * @return array */ public function definition() { $name = $this-\u0026gt;faker-\u0026gt;unique()-\u0026gt;sentence(); // Para el titulo del post return [ \u0026#39;name\u0026#39; =\u0026gt; $name, \u0026#39;slug\u0026#39; =\u0026gt; Str::slug($name), \u0026#39;extract\u0026#39; =\u0026gt; $this-\u0026gt;faker-\u0026gt;text(250), //Expecifico que el texto sea de 250 caracteres \u0026#39;body\u0026#39; =\u0026gt; $this-\u0026gt;faker-\u0026gt;text(2000), //Expecifico que el texto sea de 250 caracteres \u0026#39;category_id\u0026#39; =\u0026gt; Category::all()-\u0026gt;random()-\u0026gt;id, // Llamo al modelo Category, traigo todos los registros, elijo uno al azar y pido su id. \u0026#39;user_id\u0026#39; =\u0026gt; User::all()-\u0026gt;random()-\u0026gt;id // Llamo al modelo User, traigo todos los registros, elijo uno al azar y pido su id. ]; TagFactory.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 namespace Database\\Factories; use App\\Models\\Tag; use Illuminate\\Database\\Eloquent\\Factories\\Factory; use Illuminate\\Support\\Str; class TagFactory extends Factory { /** * The name of the factory\u0026#39;s corresponding model. * * @var string */ protected $model = Tag::class; /** * Define the model\u0026#39;s default state. * * @return array */ public function definition() { $name = $this-\u0026gt;faker-\u0026gt;unique()-\u0026gt;word(20); return [ \u0026#39;name\u0026#39; =\u0026gt; $name, \u0026#39;slug\u0026#39; =\u0026gt; Str::slug($name), \u0026#39;color\u0026#39; =\u0026gt; $this-\u0026gt;faker-\u0026gt;randomElement([\u0026#39;red\u0026#39;, \u0026#39;yellow\u0026#39;, \u0026#39;green\u0026#39;, \u0026#39;blue\u0026#39;, \u0026#39;indigo\u0026#39;, \u0026#39;purple\u0026#39;, \u0026#39;pink\u0026#39;]) ]; } } cuando subimos una imagen al servidor esta se almacena en la carpeta var/www/laravel/blog_laravel/storage/app\n1 2 3 4 5 6 enrique@enrique-server:/var/www/laravel/blog_laravel$ ls -la storage/app/ total 16 drwxrwsr-x 3 enrique www-data 4096 Dec 8 15:51 . drwxrwsr-x 5 enrique www-data 4096 Dec 8 15:51 .. -rw-rw-r-- 1 enrique www-data 23 Dec 8 15:51 .gitignore drwxrwsr-x 2 enrique www-data 4096 Dec 8 15:51 public Pero a la única carpeta a la que podemos acceder desde el navegador es a la carpeta public\n1 2 3 4 5 6 7 8 9 10 11 12 13 enrique@enrique-server:/var/www/laravel/blog_laravel$ ls -la public/ total 36 drwxrwsr-x 4 enrique www-data 4096 Dec 9 22:58 . drwxrwsr-x 13 enrique www-data 4096 Dec 9 22:57 .. -rw-rw-r-- 1 enrique www-data 603 Dec 8 15:51 .htaccess drwxr-sr-x 2 enrique www-data 4096 Dec 9 22:30 css -rw-rw-r-- 1 enrique www-data 0 Dec 8 15:51 favicon.ico -rw-rw-r-- 1 enrique www-data 1731 Dec 8 15:51 index.php drwxrwsr-x 2 enrique www-data 4096 Dec 9 22:58 js -rw-rw-r-- 1 enrique www-data 71 Dec 9 22:58 mix-manifest.json -rw-rw-r-- 1 enrique www-data 24 Dec 8 15:51 robots.txt lrwxrwxrwx 1 enrique www-data 48 Dec 9 22:30 storage -\u0026gt; /var/www/laravel/blog_laravel/storage/app/public -rw-rw-r-- 1 enrique www-data 1194 Dec 8 15:51 web.config En esta carpeta public hay un acceso directo a una carpeta llamada storage, pero esta carpeta storage no es la misma que var/www/laravel/blog_laravel/storage/app, sino a /var/www/laravel/blog_laravel/storage/app/public.\nEntonces lo que debo lograr es que las imágenes se suban a la carpeta /var/www/laravel/blog_laravel/storage/app/public para conseguirlo voy a la carpeta config y abro el archivo /var/www/laravel/blog_laravel/config/filesystems.php donde cambio el valor de la variable FILESYSTEM_DRIVER de local a public.\nfilesystems.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;?php return [ /* |-------------------------------------------------------------------------- | Default Filesystem Disk |-------------------------------------------------------------------------- | | Here you may specify the default filesystem disk that should be used | by the framework. The \u0026#34;local\u0026#34; disk, as well as a variety of cloud | based disks are available to your application. Just store away! | */ //\u0026#39;default\u0026#39; =\u0026gt; env(\u0026#39;FILESYSTEM_DRIVER\u0026#39;, \u0026#39;local\u0026#39;), \u0026#39;default\u0026#39; =\u0026gt; env(\u0026#39;FILESYSTEM_DRIVER\u0026#39;, \u0026#39;public\u0026#39;), ImageFactory.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026lt;?php namespace Database\\Factories; use App\\Models\\Image; use Illuminate\\Database\\Eloquent\\Factories\\Factory; class ImageFactory extends Factory { /** * The name of the factory\u0026#39;s corresponding model. * * @var string */ protected $model = Image::class; /** * Define the model\u0026#39;s default state. * * @return array */ public function definition() { return [ \u0026#39;url\u0026#39; =\u0026gt; \u0026#39;posts/\u0026#39;.$this-\u0026gt;faker-\u0026gt;image(\u0026#39;public/storage/posts\u0026#39;, 640, 480, null, false) //lo almacena en posts/imagen.jpg ]; } } Para que estos factories puedan rellenar la base de datos con valores falsos debo de llamarlos desde databaseSeeders.php\nCreo un seeder para meter mis usuarios junto con datos aleatorios creados por el UserFactory.php\n1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:seeder UserSeeder Seeder created successfully. UserSeeder.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;?php namespace Database\\Seeders; use App\\Models\\User; use Illuminate\\Database\\Seeder; class UserSeeder extends Seeder { /** * Run the database seeds. * * @return void */ public function run() { User::create([ \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;Enrique Saborit Crespo\u0026#39;, \u0026#39;email\u0026#39; =\u0026gt; \u0026#39;esaborit@gmail.com\u0026#39;, \u0026#39;password\u0026#39; =\u0026gt; bcrypt(\u0026#39;esaborit\u0026#39;) ]); User::factory(99)-\u0026gt;create(); } } Debo llamar este UserSeeder desde el DatabaseSeederya que es el único documento que se va a leer a la hora de ejecutar los seeders.\nDatabaseSeeder.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026lt;?php namespace Database\\Seeders; use Illuminate\\Database\\Seeder; class DatabaseSeeder extends Seeder { /** * Seed the application\u0026#39;s database. * * @return void */ public function run() { $this-\u0026gt;call(UserSeeder::class); // Llamo al UserSeeder Category::factory(4)-\u0026gt;create(); // Para que me cree 4 categorias Tag::factory(8)-\u0026gt;create(); // me crea 8 etiquetas } } Para crear los posts falsos necesito que me cree a la vez una imagen con cada uno por lo que los voy a crear con u seeder a parte que incluiré después en DaabaseSeeder.php\nenrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:seeder PostSeeder Seeder created successfully. PostSeeder.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026lt;?php namespace Database\\Seeders; use App\\Models\\Image; use App\\Models\\Post; use Illuminate\\Database\\Seeder; class PostSeeder extends Seeder { /** * Run the database seeds. * * @return void */ public function run() { $posts = Post::factory(100)-\u0026gt;create(); foreach ($posts as $post) { // añado una imagen a cada post (como el ImageFactory solo añade la url el resto lo añado aqui) Image::factory(1)-\u0026gt;create([ \u0026#39;imageable_id\u0026#39; =\u0026gt; $post-\u0026gt;id, \u0026#39;imageable_type\u0026#39; =\u0026gt; Post::class ]); // Añado 2 etiquetas a cada post $post-\u0026gt;tags()-\u0026gt;attach([ // attach() rellena la tabla post_tag rand(1, 4), rand(5, 8) ]); } } } Llamo a este seeder desde DatabaseSeeder.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026lt;?php namespace Database\\Seeders; use App\\Models\\Category; use App\\Models\\Tag; use Illuminate\\Database\\Seeder; use Illuminate\\Support\\Facades\\Storage; class DatabaseSeeder extends Seeder { /** * Seed the application\u0026#39;s database. * * @return void */ public function run() { // \\App\\Models\\User::factory(10)-\u0026gt;create(); Storage::deleteDirectory(\u0026#39;posts\u0026#39;); // Elimina el directorio cada vez que hago un seed Storage::makeDirectory(\u0026#39;posts\u0026#39;); $this-\u0026gt;call(UserSeeder::class); Category::factory(4)-\u0026gt;create(); Tag::factory(8)-\u0026gt;create(); $this-\u0026gt;call(PostSeeder::class); } } Ejecuto los seeders\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan migrate:fresh --seed Dropped all tables successfully. Migration table created successfully. Migrating: 2014_10_12_000000_create_users_table Migrated: 2014_10_12_000000_create_users_table (7,283.34ms) Migrating: 2014_10_12_100000_create_password_resets_table Migrated: 2014_10_12_100000_create_password_resets_table (3,186.33ms) Migrating: 2014_10_12_200000_add_two_factor_columns_to_users_table Migrated: 2014_10_12_200000_add_two_factor_columns_to_users_table (4,433.22ms) Migrating: 2019_08_19_000000_create_failed_jobs_table Migrated: 2019_08_19_000000_create_failed_jobs_table (3,505.14ms) Migrating: 2019_12_14_000001_create_personal_access_tokens_table Migrated: 2019_12_14_000001_create_personal_access_tokens_table (6,432.68ms) Migrating: 2020_12_09_223020_create_sessions_table Migrated: 2020_12_09_223020_create_sessions_table (11,400.94ms) Migrating: 2020_12_10_151428_create_categories_table Migrated: 2020_12_10_151428_create_categories_table (2,110.62ms) Migrating: 2020_12_10_152625_create_posts_table Migrated: 2020_12_10_152625_create_posts_table (14,110.12ms) Migrating: 2020_12_10_154814_create_tags_table Migrated: 2020_12_10_154814_create_tags_table (2,421.83ms) Migrating: 2020_12_10_155345_create_post_tag_table Migrated: 2020_12_10_155345_create_post_tag_table (17,809.01ms) Migrating: 2020_12_10_182248_create_images_table Migrated: 2020_12_10_182248_create_images_table (2,946.20ms) Seeding: Database\\Seeders\\UserSeeder Seeded: Database\\Seeders\\UserSeeder (47,335.58ms) Seeding: Database\\Seeders\\PostSeeder Seeded: Database\\Seeders\\PostSeeder (172,518.66ms) Database seeding completed successfully. Desde phpmyadmin puedo ver las tablas de mi proyecto con los registros falsos creados.\n","pubDate":"2021-01-28","title":"Inserción de datos de prueba con seeders y factories - II"},{"link":"https://esaborit.github.io/posts/creacion_proyecto_diseno_bbdd/","plain":"Creación del proyecto La pieza fundamental para construir el proyecto es tener claro la estructura de la base de datos del blog.\nDiagrama EER\nUna vez que tengo planificada la base de datos para crear el proyecto con laravel debo situarme en el directorio /var/www/laravel/ dentro del cual creo todos los proyectos.\n1 enrique@enrique-server:$ cd /var/www/laravel/ Creo un proyecto de nombre blog_laravel con jetstream y livewire.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 enrique@enrique-server:/var/www/laravel$ laravel new blog_laravel --jet | | | |,---.|--- ,---.|--- ,---.,---.,---.,-.-. ||---\u0026#39;| `---.| | |---\u0026#39;,---|| | | `---\u0026#39;`---\u0026#39;`---\u0026#39;`---\u0026#39;`---\u0026#39;` `---\u0026#39;`---^` \u0026#39; \u0026#39; Which Jetstream stack do you prefer? [0] livewire [1] inertia \u0026gt; 0 Will your application use teams? (yes/no) [no]: \u0026gt; no Sigue el proceso de instalación hasta el fin y cuando termina me pide que ejecute los comandos npm install y npm run dev desde dentro del proyecto.\n1 2 3 4 5 6 7 8 9 10 11 12 13 Package manifest generated successfully. 75 packages you are using are looking for funding. Use the `composer fund` command to find out more! Copied Directory [/vendor/laravel/sanctum/database/migrations] To [/database/migrations] Copied File [/vendor/laravel/sanctum/config/sanctum.php] To [/config/sanctum.php] Publishing complete. Livewire scaffolding installed successfully. Please execute the \u0026#34;npm install \u0026amp;\u0026amp; npm run dev\u0026#34; command to build your assets. The [/var/www/laravel/blog_laravel/public/storage] link has been connected to [/var/www/laravel/blog_laravel/storage/app/public]. The links have been created. Application ready! Build something amazing. Desde la terminal me sitúo dentro del proyecto blog_laravel y ejecuto dichos comandos.\n1 enrique@enrique-server:/var/www/laravel/blog_laravel$ npm install Mientras se ejecuta el primero de ellos modifico los parámetros para la conexión con al base de datos en el archivo .env\n1 2 3 4 5 6 7 DB_CONNECTION=mysql DB_HOST=127.0.0.1 # DB_HOST=mysql DB_PORT=3306 DB_DATABASE=blog_laravel DB_USERNAME=root DB_PASSWORD=esaborit Vuelvo a la consola y ejecuto.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 enrique@enrique-server:/var/www/laravel/blog_laravel$ npm run dev \u0026gt; @ dev /var/www/laravel/blog_laravel \u0026gt; npm run development \u0026gt; @ development /var/www/laravel/blog_laravel \u0026gt; cross-env NODE_ENV=development node_modules/webpack/bin/webpack.js --progress --config=node_modules/laravel-mix/setup/webpack.config.js Additional dependencies must be installed. This will only take a moment. Running: npm install vue-template-compiler --save-dev --production=false npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.13 (node_modules/fsevents): npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.2.13: wanted {\u0026#34;os\u0026#34;:\u0026#34;darwin\u0026#34;,\u0026#34;arch\u0026#34;:\u0026#34;any\u0026#34;} (current: {\u0026#34;os\u0026#34;:\u0026#34;linux\u0026#34;,\u0026#34;arch\u0026#34;:\u0026#34;x64\u0026#34;}) npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.1.3 (node_modules/watchpack/node_modules/fsevents): npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.1.3: wanted {\u0026#34;os\u0026#34;:\u0026#34;darwin\u0026#34;,\u0026#34;arch\u0026#34;:\u0026#34;any\u0026#34;} (current: {\u0026#34;os\u0026#34;:\u0026#34;linux\u0026#34;,\u0026#34;arch\u0026#34;:\u0026#34;x64\u0026#34;}) Okay, done. The following packages have been installed and saved to your package.json dependencies list: - vue-template-compiler 98% after emitting SizeLimitsPlugin DONE Compiled successfully in 50548ms 10:58:34 PM Asset Size Chunks Chunk Names /css/app.css 4.38 MiB /js/app [emitted] /js/app /js/app.js 669 KiB /js/app [emitted] /js/app enrique@enrique-server:/var/www/laravel/blog_laravel$ Una vez que termina la compilación creo la tabla blog_laravelen mi gestor de bases de datos para lo que utilizaré phpmyadmin y un virtualhost en Apache.\n1 2 enrique@enrique-server:/etc/apache2/sites-available$ sudo cp livewire.conf blog_laravel.conf enrique@enrique-server:/etc/apache2/sites-available$ sudo nano blog_laravel.conf Modifico su contenido y lo dejo como sigue;\nblog_laravel.conf\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026lt;VirtualHost *:80\u0026gt; ServerName blog_laravel.test ServerAdmin admin@blog_laravel.test DocumentRoot /var/www/laravel/blog_laravel/public \u0026lt;Directory /var/www/laravel/blog_laravel/\u0026gt; Options Indexes FollowSymLinks MultiViews AllowOverride All Order Allow,Deny Allow from all Require all granted \u0026lt;/Directory\u0026gt; ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined \u0026lt;/VirtualHost\u0026gt; Guardo el archivo y lo habilito.\n1 2 3 4 enrique@enrique-server:/etc/apache2/sites-available$ sudo a2ensite blog_laravel.conf Enabling site blog_laravel. To activate the new configuration, you need to run: systemctl reload apache2 Compruebo que sintácticamente no hay errores.\n1 2 3 enrique@enrique-server:/etc/apache2/sites-available$ sudo apachectl configtest AH00558: apache2: Could not reliably determine the server\u0026#39;s fully qualified domain name, using 127.0.1.1. Set the \u0026#39;ServerName\u0026#39; directive globally to suppress this message Syntax OK Reinicio Apache.\n1 enrique@enrique-server:/etc/apache2/sites-available$ sudo systemctl restart apache2 Incluyo blog_laravel.test dentro del hosts de mi equipo anfitrión y ya podría acceder al proyecto desde mi navegador web, pero como he creado el proyecto laravel incluyendo jetstream si intento acceder al mismo sin hacer la migración de las tablas que necesita jetstream me devolvería un mensaje de error como el siguiente.\nPor lo que desde la terminal de vscode realizo la migración de las tablas.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan migrate Migration table created successfully. Migrating: 2014_10_12_000000_create_users_table Migrated: 2014_10_12_000000_create_users_table (3,653.58ms) Migrating: 2014_10_12_100000_create_password_resets_table Migrated: 2014_10_12_100000_create_password_resets_table (3,246.81ms) Migrating: 2014_10_12_200000_add_two_factor_columns_to_users_table Migrated: 2014_10_12_200000_add_two_factor_columns_to_users_table (4,505.40ms) Migrating: 2019_08_19_000000_create_failed_jobs_table Migrated: 2019_08_19_000000_create_failed_jobs_table (3,372.28ms) Migrating: 2019_12_14_000001_create_personal_access_tokens_table Migrated: 2019_12_14_000001_create_personal_access_tokens_table (4,506.46ms) Migrating: 2020_12_09_223020_create_sessions_table Migrated: 2020_12_09_223020_create_sessions_table (11,528.22ms) Ahora ya puedo acceder al proyecto desde mi navegador web\nDiseño de la base de datos Comienzo a crear la tablas y los modelos dentro del proyecto. Para ello empiezo por aquellas que son entidades fuertes.\n1 2 3 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:model Category -m Model created successfully. Created Migration: 2020_12_10_151428_create_categories_table Me ha creado dos archivos, App\\Models\\Category.php y database\\migrations\\2020_12_10_151428_create_categories_table.php un modelo y una migración para la tabla categories.\nComienzo por el archivo de la migración donde incluiré dentro del método up los campos que va a tener la tabla.\n2020_12_10_151428_create_categories_table.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;?php use Illuminate\\Database\\Migrations\\Migration; use Illuminate\\Database\\Schema\\Blueprint; use Illuminate\\Support\\Facades\\Schema; class CreateCategoriesTable extends Migration { /** * Run the migrations. * * @return void */ public function up() { Schema::create(\u0026#39;categories\u0026#39;, function (Blueprint $table) { $table-\u0026gt;id(); $table-\u0026gt;string(\u0026#39;name\u0026#39;, 45); $table-\u0026gt;string(\u0026#39;slug\u0026#39;, 45); $table-\u0026gt;timestamps(); }); } /** * Reverse the migrations. * * @return void */ public function down() { Schema::dropIfExists(\u0026#39;categories\u0026#39;); } } Hago lo mismo para crear la tabla posts\n1 2 3 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:model Post -m Model created successfully. Created Migration: 2020_12_10_152625_create_posts_table Dentro del archivo de la migración incluyo los campos de la tabla posts.\n2020_12_10_152625_create_posts_table.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 \u0026lt;?php use Illuminate\\Database\\Migrations\\Migration; use Illuminate\\Database\\Schema\\Blueprint; use Illuminate\\Support\\Facades\\Schema; class CreatePostsTable extends Migration { /** * Run the migrations. * * @return void */ public function up() { Schema::create(\u0026#39;posts\u0026#39;, function (Blueprint $table) { $table-\u0026gt;id(); $table-\u0026gt;string(\u0026#39;name\u0026#39;); $table-\u0026gt;string(\u0026#39;slug\u0026#39;); $table-\u0026gt;text(\u0026#39;extract\u0026#39;); $table-\u0026gt;longText(\u0026#39;body\u0026#39;); $table-\u0026gt;enum(\u0026#39;status\u0026#39;, [1,2])-\u0026gt;default(1); //1 es borrador y 2 publicado $table-\u0026gt;unsignedBigInteger(\u0026#39;category_id\u0026#39;); $table-\u0026gt;unsignedBigInteger(\u0026#39;user_id\u0026#39;); $table-\u0026gt;foreign(\u0026#39;category_id\u0026#39;)-\u0026gt;references(\u0026#39;id\u0026#39;)-\u0026gt;on(\u0026#39;categories\u0026#39;)-\u0026gt;onDelete(\u0026#39;cascade\u0026#39;); $table-\u0026gt;foreign(\u0026#39;user_id\u0026#39;)-\u0026gt;references(\u0026#39;id\u0026#39;)-\u0026gt;on(\u0026#39;users\u0026#39;)-\u0026gt;onDelete(\u0026#39;cascade\u0026#39;); $table-\u0026gt;timestamps(); }); } /** * Reverse the migrations. * * @return void */ public function down() { Schema::dropIfExists(\u0026#39;posts\u0026#39;); } } Repito este proceder con la tabla tags.\n1 2 3 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:model Tag -m Model created successfully. Created Migration: 2020_12_10_154814_create_tags_table 2020_12_10_154814_create_tags_table.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 \u0026lt;?php use Illuminate\\Database\\Migrations\\Migration; use Illuminate\\Database\\Schema\\Blueprint; use Illuminate\\Support\\Facades\\Schema; class CreateTagsTable extends Migration { /** * Run the migrations. * * @return void */ public function up() { Schema::create(\u0026#39;tags\u0026#39;, function (Blueprint $table) { $table-\u0026gt;id(); $table-\u0026gt;string(\u0026#39;name\u0026#39;); $table-\u0026gt;string(\u0026#39;slug\u0026#39;); $table-\u0026gt;string(\u0026#39;color\u0026#39;); $table-\u0026gt;timestamps(); }); } /** * Reverse the migrations. * * @return void */ public function down() { Schema::dropIfExists(\u0026#39;tags\u0026#39;); } } Como la tabla tags y la tabla posts tiene una relación muchos a muchos debo crear una tabla que llamaré post_tag .\n1 2 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:migration create_post_tag_table Created Migration: 2020_12_10_155345_create_post_tag_table Creo en la migración los campos de la tabla dentro de su método up.\n2020_12_10_155345_create_post_tag_table.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 \u0026lt;?php use Illuminate\\Database\\Migrations\\Migration; use Illuminate\\Database\\Schema\\Blueprint; use Illuminate\\Support\\Facades\\Schema; class CreatePostTagTable extends Migration { /** * Run the migrations. * * @return void */ public function up() { Schema::create(\u0026#39;post_tag\u0026#39;, function (Blueprint $table) { $table-\u0026gt;id(); $table-\u0026gt;unsignedBigInteger(\u0026#39;post_id\u0026#39;); $table-\u0026gt;unsignedBigInteger(\u0026#39;tag_id\u0026#39;); $table-\u0026gt;foreign(\u0026#39;post_id\u0026#39;)-\u0026gt;references(\u0026#39;id\u0026#39;)-\u0026gt;on(\u0026#39;posts\u0026#39;)-\u0026gt;onDelete(\u0026#39;cascade\u0026#39;); $table-\u0026gt;foreign(\u0026#39;tag_id\u0026#39;)-\u0026gt;references(\u0026#39;id\u0026#39;)-\u0026gt;on(\u0026#39;tags\u0026#39;)-\u0026gt;onDelete(\u0026#39;cascade\u0026#39;); $table-\u0026gt;timestamps(); }); } /** * Reverse the migrations. * * @return void */ public function down() { Schema::dropIfExists(\u0026#39;post_tag\u0026#39;); } } Por último creo la tabla images y su modelo.\n1 2 3 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan make:model Image -m Model created successfully. Created Migration: 2020_12_10_182248_create_images_table Creo en la migración los campos de la tabla dentro de su método up.\n2020_12_10_182248_create_images_table.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 \u0026lt;?php use Illuminate\\Database\\Migrations\\Migration; use Illuminate\\Database\\Schema\\Blueprint; use Illuminate\\Support\\Facades\\Schema; class CreateImagesTable extends Migration { /** * Run the migrations. * * @return void */ public function up() { Schema::create(\u0026#39;images\u0026#39;, function (Blueprint $table) { $table-\u0026gt;id(); $table-\u0026gt;string(\u0026#39;url\u0026#39;); $table-\u0026gt;unsignedBigInteger(\u0026#39;imageable_id\u0026#39;); $table-\u0026gt;string(\u0026#39;imageable_type\u0026#39;); $table-\u0026gt;timestamps(); }); } /** * Reverse the migrations. * * @return void */ public function down() { Schema::dropIfExists(\u0026#39;images\u0026#39;); } } Realizo las migraciones de las tablas.\n1 2 3 4 5 6 7 8 9 10 11 enrique@enrique-server:/var/www/laravel/blog_laravel$ php artisan migrate Migrating: 2020_12_10_151428_create_categories_table Migrated: 2020_12_10_151428_create_categories_table (3,943.96ms) Migrating: 2020_12_10_152625_create_posts_table Migrated: 2020_12_10_152625_create_posts_table (14,776.35ms) Migrating: 2020_12_10_154814_create_tags_table Migrated: 2020_12_10_154814_create_tags_table (1,760.09ms) Migrating: 2020_12_10_155345_create_post_tag_table Migrated: 2020_12_10_155345_create_post_tag_table (12,294.46ms) Migrating: 2020_12_10_182248_create_images_table Migrated: 2020_12_10_182248_create_images_table (3,181.90ms) Lo siguiente es realizar las relaciones a nivel de modelos. Categorias y users tienen una relación uno a muchos con posts.\nEn el modelo Category creo el método posts\nCategory.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Database\\Eloquent\\Model; class Category extends Model { use HasFactory; // Relación uno a muchos posts public function posts() { return $this-\u0026gt;hasMany(Post::class); // Una categoría puede estar en muchos posts } } Creo el mismo método en el modelo user.\nUser.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 \u0026lt;?php namespace App\\Models; use Illuminate\\Contracts\\Auth\\MustVerifyEmail; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Foundation\\Auth\\User as Authenticatable; use Illuminate\\Notifications\\Notifiable; use Laravel\\Fortify\\TwoFactorAuthenticatable; use Laravel\\Jetstream\\HasProfilePhoto; use Laravel\\Sanctum\\HasApiTokens; class User extends Authenticatable { use HasApiTokens; use HasFactory; use HasProfilePhoto; use Notifiable; use TwoFactorAuthenticatable; /** * The attributes that are mass assignable. * * @var array */ protected $fillable = [ \u0026#39;name\u0026#39;, \u0026#39;email\u0026#39;, \u0026#39;password\u0026#39;, ]; /** * The attributes that should be hidden for arrays. * * @var array */ protected $hidden = [ \u0026#39;password\u0026#39;, \u0026#39;remember_token\u0026#39;, \u0026#39;two_factor_recovery_codes\u0026#39;, \u0026#39;two_factor_secret\u0026#39;, ]; /** * The attributes that should be cast to native types. * * @var array */ protected $casts = [ \u0026#39;email_verified_at\u0026#39; =\u0026gt; \u0026#39;datetime\u0026#39;, ]; /** * The accessors to append to the model\u0026#39;s array form. * * @var array */ protected $appends = [ \u0026#39;profile_photo_url\u0026#39;, ]; //relación uno a muchos posts public function posts() { return $this-\u0026gt;hasMany(Post::class); } } Y el modelo Post tiene la misma pero inversa, por lo que creo un método llamado user y otro category.\nPost.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Database\\Eloquent\\Model; class Post extends Model { use HasFactory; // Relacion uno a muchos inversa users public function user() { return $this-\u0026gt;belongsTo(User::class); } // Relacion uno a muchos inversa categories public function category() { return $this-\u0026gt;belongsTo(Category::class); } } La siguiente relación es la de posts y tags , esta es de muchos a muchos.\nEn el modelo Post añado el siguiente método categories.\nPost.php\n1 2 3 4 5 // Relacion muchos a muchos categorias public function tags() { return $this-\u0026gt;belongsToMany(Tag::class); } Y en el modelo Tag creo el método posts.\nTag.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Database\\Eloquent\\Model; class Tag extends Model { use HasFactory; // relacion muchos a muchos con posts public function posts() { return $this-\u0026gt;belongsToMany(Post::class); } } Por último queda la relación polimórfica del modelo Image y el modelo Post.\nEn el modelo Image.php el método imageable.\nImage.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Database\\Eloquent\\Model; class Image extends Model { use HasFactory; // Relación uno a uno polimórfica public function imageable() { return $this-\u0026gt;morphTo(); } } En el modelo Post creo el método image.\nPost.php\n1 2 3 4 5 // Relacion uno a uno polimórfica con image public function image() { return $this-\u0026gt;morphOne(Image::class, \u0026#39;imageable\u0026#39;); // Debo pasar el método imageable creado en Image.php } Ya tengo relacionados todos los modelos.\n","pubDate":"2021-01-28","title":"Creación del proyecto y diseño de la base de datos del blog - I"},{"link":"https://esaborit.github.io/posts/certificado_real_casa_moneda/","plain":"Una de las formas de acreditar nuestra identidad a la hora de realizar distintos trámites con la administración pública española es utilizando el certificado de la Real Casa de la Moneda para personas físicas. En este artículo describo la secuencia de pasos que he tenido que seguir para poder obtenerlo usando mi DNIe e instalarlo en un ordenador con sistema operativo Gnu/linux.\nCertificado Real Casa de la Moneda para persona física Para obtener el certificado nos dirigimos a la página de la Fabrica nacional de moneda y timbre y seleccionamos la opción \u0026ldquo;obtenga/renueve su certificado Ciudadano\u0026rdquo;.\nNos lleva a otra pagina dentro del sitio web de la Casa de la Moneda donde seleccionamos la opción \u0026ldquo;Obtener certificado con DNIe\u0026rdquo;.\nLa página que aparece ante nosotros nos muestra un resumen de los pasos a realizar para obtener el certificado con sus correspondientes enlaces para acceder a cada uno de los pasos.\nEmpezamos por el primero de ellos y seguimos el orden indicado.\nPaso 1. - Configuración previa Para evitar posibles errores durante el proceso de obtención del certificado debemos recordar que es imprescindible:\nNo formatear el ordenador, entre el proceso de solicitud y el de descarga del certificado. Se debe realizar todo el proceso de obtención desde el mismo equipo y mismo usuario. Es importante leer atentamente la Declaración de Prácticas de Certificación previamente a la solicitud del certificado. En ella se encuentran las condiciones bajo las cuales se prestan los servicios de certificación. Navegadores compatibles\nÚltima versión de cualquiera de los siguientes navegadores:\nMozilla Firefox Google Chrome Microsoft EDGE Opera Safari Antes de comenzar con el proceso de solicitud del Certificado, mi equipo debe tener instaladas las siguientes **aplicaciones para la generación del certificado. **\nSoftware necesario para la solicitud del certificado:\nAUTOFIRMA Aplicación de firma electrónica desarrollada por el Ministerio de Hacienda y Administraciones Públicas. Al poder ser ejecutada desde el navegador, permite la firma en páginas de Administración Electrónica cuando se requiere la firma en un procedimiento administrativo.\nEn esta página puedo encontrar el enlace de descarga según mi SO:\nÁrea de Descarga de la web Firma Electrónica\nLo descargo desde aquí: AutoFirma 1.8.2 para Debian Linux y para su instalación sigo las indicaciones del siguiente artículo.\nSoftware necesario para leer el DNIe Para el uso del DNIe es necesario instalar el software criptográfico DNIe e instalar también los certificados raíces del DNIe, en esta página puedo encontrar el enlace:\nÁrea de Descargas de la web del dni electrónico\nPara su instalación en un equipo con debian sigo las instrucciones del siguiente artículo.\nConfigurador FNMT-RCM La Fábrica Nacional de Moneda y Timbre ha desarrollado esta aplicación para solicitar las claves necesarias en la obtención de un certificado digital. Puede ser ejecutada en cualquier navegador y sistema Operativo. Puedo descargalo desde el siguiente enlace:\nÁrea de Descarga de Configurador FNMT\nUna vez descargado e instalado el software no es necesario hacer nada, este se ejecutará cuando el navegador lo requiera.\nDescarga software generación de claves Nota: Los antivirus y proxies pueden impedir el uso de esta aplicación, por favor no utilice proxy o permita el acceso a esta aplicación en su proxy.\nDescargo el software necesario para mi sistema operativo debian desde este enlace:\nConfigurador FNMT-RCM para GNU/Linux 64 bits (DEB)\nY lo instalo desde la consola.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 ESC@esc-pc:~/Descargas $ sudo dpkg -i configuradorfnmt_1.0.1-0_amd64.deb [sudo] password for ESC: Seleccionando el paquete configuradorfnmt previamente no seleccionado. (Leyendo la base de datos ... 314537 ficheros o directorios instalados actualmente.) Preparando para desempaquetar configuradorfnmt_1.0.1-0_amd64.deb ... Desempaquetando configuradorfnmt (1.0.1-0) ... Configurando configuradorfnmt (1.0.1-0) ... cp: no se puede crear el fichero regular \u0026#39;/etc/firefox/pref\u0026#39;: No existe el fichero o el directorio jun 14, 2023 5:11:31 PM es.gob.fnmt.cert.certrequest.util.FnmtLogManager install INFORMACIÓN: La ruta para el fichero de registro (\u0026#39;/root/.fnmt\u0026#39;) no existe, se creara jun 14, 2023 5:11:31 PM es.gob.fnmt.cert.certrequest.CertRequest main INFORMACIÓN: Modo de depuracion desactivado jun 14, 2023 5:11:31 PM es.gob.fnmt.cert.certrequest.CertRequest main INFORMACIÓN: Version actual de la aplicacion: \u0026#39;1\u0026#39; Procesando disparadores para gnome-menus (3.36.0-1) ... Procesando disparadores para mailcap (3.69) ... Procesando disparadores para desktop-file-utils (0.26-1) ... ESC@esc-pc:~/Descargas Concluido esto podemos continuar con el siguiente paso.\nPaso 2. - Solicitud con certificado Para poder completar este paso necesito poder utilizar el certificado almacenado en mi DNIe. Al hacer click sobre el enlace Solicitud con certificado se abre una ventana emergente solicitando un certificado de autenticacion. Utilizo el del DNIe. Una vez autenticado se abre una ventana donde nos indica que dea comienzo el proceso de creación de las claves publica y pribada asociadas al certificado que solicitamos a nuestro nombre.\nDespués de leer y aceptar las condiciones de expedición pulsamos sobre el botón siguiente se abre el Configurador FNMT-RCM y aparece una ventana emergente pidiendo que creemos una contraseña para proteger las claves del certificado durante el proceso de solicitud y descarga.\nUna vez aceptada la contraseña propuesta, se abre una ventana con el siguiente formulario. Cumplimento los datos y envío la solicitud.\nNos piden que confirmemos o corrijamos los datos y que firmemos la solicitut del certificado FNMT.\nLo reviso, confirmo que son correctos y los firmo con mi certificado del DNIe y la aplicación Autofirma solicitada por la sede electrónica al pulsar sobre el botón Firmar.\nPaso 3. - Acreditar identidad Me pide que acredite mi identidad para lo que elijo el certificado de autenticación del DNIe que me aparece en pantalla en una ventana emergente. Una vez validada mi identidad aparece otra ventana emergente en la que me pide que establezca una contraseña para proteger los certificados y para poder descargarlos en el último paso. Establecida la contraseña aparece la siguiente pantalla en la que me indica que la solicitud se ha procesado correctamente y que se enviaran a mi correo electrónico el codigo de solicitud para poder descargar e instalar el certificado.\n4.- Descargar certificado Una vez que he recibido el correo con el código vuelvo a la sede electrónica de la Real Casa de la Moneda para descargarlo. Introduzco los datos, acepto los términos y condiciones de uso y presiono el botón descargar.\nEn este momento comienza la instalación del certificado.\nSe abre el Configurador FNMT-RCM y aparece una ventana emergente en la que tecleo la contraseña que cree anteriormente y doy a aceptar.\nMe pregunta con una nueva ventana emergente si quiero crear una copia de seguridad para poder utilizar el certificado en otro ordenador, tableta o teléfono móvil. Le contesto afirmativamente.\nCuando se ha descargado correctamente nos lo indica por pantalla.\nHace lo mismo cuando se ha instalado correctamente en nuestro navegador ordenador\nPor ultimo nos informa de donde podemos descargar la declaración general de practicas de servicios de Confianza y de certificación electrónica a si como de la politica y practicas de certificación para la Autoridad de certificación de usuarios de FNMT.\nA partir de este momento ya podemos utilizar el certificado en nuestro navegador para identificarnos ante los servidores de la administración.\n","pubDate":"2023-11-10","title":"Obtención del certificado de la Real Casa de la Moneda para persona física "},{"link":"https://esaborit.github.io/posts/instalando-pi-hole/","plain":"Voy a instalar un bloqueador de anuncios para que todos los equipos que se conecten a mi intranet se puedan beneficiar de navegar por Internet sin la gran mayoría de anuncios, además de poder moderar los contenidos a los que acceden los niños.\nUsaré Pi-Hole, que es un bloqueador de anuncios, gratuito y de código abierto, para Raspberry Pi.\nSu código fuente está disponible en GitHub y se puede instalar en el sistema operativo Raspberry Pi con la siguiente línea de comando:\n1 curl -sSL https://install.pi-hole.net | sudo bash Instalación Pi-Hole El proceso de instalación, es sencillo. Pi-Hole es un software liviano y está diseñado especialmente para Raspberry Pi, por lo que puedo instalarlo sin más en mi Raspberry Pi 3b con el comando arriba descrito.\nEn mi Raspberry acabo de instalar Raspberry Pi OS Lite (32bit) y he realizado la configuración básica desde la linea de comandos con sudo raspi-config , a saber:\nDistribución del teclado Idioma del sistema Zona horaria Acceso SSH Contraseña por defecto del usuario pi.\nPor último establezco una dirección IP estática para mi Raspberry Pi. Es algo que voy a necesitar luego al instalar pi-hole y así lo dejo hecho.\nPara ello edito /etc/dhcpcd.conf con nano y añado las siguientes líneas al final.\n1 2 3 4 interface eth0 static ip_address=192.168.100.10/24 static routers=192.168.100.1 static domain_name_servers=1.1.1.1 8.8.8.8 Guardo los cambios y cierro el archivo (CTRL+O, Enter, CTRL+X y reinicio la Raspberry para que los cambios tengan efecto.\nCompruebo con ifconfig su correcta configuración.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 pi@raspberrypi:~ $ ifconfig eth0: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500 inet 192.168.100.10 netmask 255.255.255.0 broadcast 192.168.100.255 inet6 fe80::77f2:ed47:dd7c:d9c7 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt; ether b8:72:eb:25:c0:88 txqueuelen 1000 (Ethernet) RX packets 141304 bytes 60950856 (58.1 MiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 65434 bytes 29202381 (27.8 MiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 lo: flags=73\u0026lt;UP,LOOPBACK,RUNNING\u0026gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10\u0026lt;host\u0026gt; loop txqueuelen 1000 (Local Loopback) RX packets 537642 bytes 37986658 (36.2 MiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 537642 bytes 37986658 (36.2 MiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 No voy a activar la Wi-Fi pues la conectaré directamente al router por cable.\nCompruebo que tengo Internet por ejemplo con un ping y la preparo para poder conectarme por SSH desde mi portátil.\n1 2 3 4 5 6 7 8 9 10 11 pi@raspberrypi:~ $ ping google.com PING google.com (142.250.200.110) 56(84) bytes of data. 64 bytes from mad41s13-in-f14.1e100.net (142.250.200.110): icmp_seq=1 ttl=110 time=30.2 ms 64 bytes from mad41s13-in-f14.1e100.net (142.250.200.110): icmp_seq=2 ttl=110 time=29.6 ms 64 bytes from mad41s13-in-f14.1e100.net (142.250.200.110): icmp_seq=3 ttl=110 time=29.5 ms 64 bytes from mad41s13-in-f14.1e100.net (142.250.200.110): icmp_seq=4 ttl=110 time=29.2 ms 64 bytes from mad41s13-in-f14.1e100.net (142.250.200.110): icmp_seq=5 ttl=110 time=29.6 ms ^C --- google.com ping statistics --- 5 packets transmitted, 5 received, 0% packet loss, time 4007ms rtt min/avg/max/mdev = 29.154/29.630/30.246/0.351 ms Me conecto vía SSH\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 user@user-pc:~ $ ssh pi@192.168.100.10 pi@192.168.100.10\u0026#39;s password: Linux raspberrypi 5.10.63-v7+ #1459 SMP Wed Oct 6 16:41:10 BST 2021 armv7l The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Tue Nov 30 11:23:51 2021 from 192.168.100.3 Wi-Fi is currently blocked by rfkill. Use raspi-config to set the country before use. pi@raspberrypi:~ $ Y actualizo el sistema antes de instalar Pi-hole.\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade -y Y eso es todo, ¡está listo para comenzar!\nInstalación de Pi-Hole Pi-Hole está disponible en este repositorio de GitHub y tienen un comando de una línea para instalarlo fácilmente.\nCopio y pego este comando:\n1 $ curl -sSL https://install.pi-hole.net | sudo bash La instalación comienza con un asistente\nRespondo Ok a las tres primeras preguntas.\nLuego, el siguiente mensaje dice que necesita una IP estática (ya la he configurado). No es obligatorio, pero si cambiase la IP, perdería Internet, por lo que es recomendable mantenerla estática.\nElijo la interfaz para usar, eth0 para una conexión por cable, wlan0 en WiFi.\nLo siguiente es elegir un proveedor de DNS . Pi-Hole reenviará todas las solicitudes a los servidores DNS después de filtrarlas. Tomo la predeterminada (Google) y la cambiaré más tarde.\nEl asistente ahora me pide que seleccione listas de terceros para usar para bloquear anuncios :\n​\tcreo que puedo conservarlas todas y cambiar / agregar algunas más tarde.\nLa siguiente pregunta es sobre los protocolos IPv4 / IPv6, donde deshabilito las direcciones IPv6.\nLuego me pregunta acerca de la configuración de IP estática: recomiendo hacer clic en Sí para corregir su dirección IP.\nLa siguiente pantalla es un mensaje de advertencia sobre el uso de DHCP e IP estática en el mismo rango de red: pero la mayoría de las veces el enrrutador detectará su Raspberry Pi y no asignará esta IP a otra.\nLuego me daría la dirección IPv6 si decidiese mantenerla habilitada.\nLuego, el asistente me pide que habilite la interfaz de administración web, recomiendo habilitarla, es una característica importante en Pi-Hole.\nEn el siguiente paso, debo confirmar la instalación de Lighttpd. Es obligatorio para que la interfaz funcione, así que elijo \u0026ldquo;Activado\u0026rdquo;.\nAhora, debo elegir si deseo habilitar el registro de consultas . El software almacenará cualquier solicitud de DNS que realice y mostrará estadísticas sobre ella. Recomiendo habilitarlo por el momento, puede deshabilitarlo más tarde en la interfaz.\nFinalmente, hay un modo de privacidad para seleccionar entre cinco niveles. Lo mismo, puedo cambiarlo más tarde: si lo estuviera instalando para una empresa, debería asegurarme de tener permiso para habilitar el registro de consultas y mostrar los detalles de cada solicitud, probablemente sea algo para consultar con el departamento legal.\nDespués de esto, el proceso de instalación continúa descargando e instalando nuevos paquetes según sus opciones.\nLa última pantalla, da la dirección de la interfaz web y la contraseña de inicio de sesión:\nConfiguración del cliente Configuración DHCP La forma más sencilla de configurar todos los dispositivos a la vez es cambiar la configuración en el servidor DHCP. En casa, probablemente es el router del ISP el que asuma este papel. No explicaré esto en detalle, ya que es diferente en cada enrutador. Puede estar en la configuración de DHCP o en la configuración de DNS.\nEn este caso lo único que hay que hacer es eliminar todos los valores y configurar como servidor DNS primario mi raspberry pi, por lo que asigno su IP 192.168.100.10 . No configuraré un servidor DNS IPv4 secundario, excepto si tuviese dos Raspberry Pi con Pi-Hole en la red.\nDe esta manera, cualquier dispositivo que use DHCP ahora usará el bloqueador de anuncios Pi-Hole de mi red local como servidor DNS. Puede llevar algunas horas actualizar la configuración del dispositivo en todos los dispositivos, hay que tener paciencia o desconéctelos / volver a conectarlos manualmente.\nNota: Es importante tener en cuenta que si el servicio de Pi-hole actuará como servidor de DHCP, se debe deshabilitar previamente cualquier otro servicio de DHCP en la red (por lo general viene activo en el router).\nConfiguración estática Cuando no tengo acceso a la configuración anterior en el router de mi ISP, puedo editar manualmente la configuración de los equipos conectados:\nEn Windows 10:\nHago clic con el botón derecho en el \u0026ldquo;Menú de inicio\u0026rdquo; y selecciono \u0026ldquo;Conexiones de red\u0026rdquo; Luego hago clic en \u0026ldquo;Cambiar la configuración del adaptador\u0026rdquo; Hago clic derecho en mi conexión actual y elijo \u0026ldquo;Propiedades\u0026rdquo; Hago doble clic en \u0026ldquo;Protocolo de Internet versión 4 (TCP / IPv4)\u0026rdquo; Configuro el servidor DNS en estático e ingreso la dirección IP de la Raspberry Pi. Mantengo el servidor DNS secundario vacío En Linux y Mac OS:\nSi tengo una interfaz gráfica, encontraré la configuración de red en Preferencias del sistema Si no es así, puedo editar el archivo /etc/resolv.conf y reemplazar el servidor DNS actual con la dirección IP de Raspberry Pi En el móvil , está en la configuración del WiFi.\nInterfaz web Pi-Hole Pi-Hole viene con una excelente interfaz web, veamos esto ahora.\nPrimer inicio de sesión Para acceder a la interfaz web, abro un navegador web y voy a http: // \u0026lt;RASPBERRYPI_IP\u0026gt; / admin . En mi caso, es http://192.168.100.10/admin\nUna vez en la página web, hago clic en Iniciar sesión y escribo la contraseña que elegí durante la instalación anteriormente. Si todo está correcto, obtendré algo como esto:\nEn esta página, podré ver todas las estadísticas sobre el uso de Internet:\nConsultas totales : cuántas solicitudes realicé Consultas bloqueadas : cuántas solicitudes han sido bloqueadas Porcentaje bloqueado = consultas bloqueadas / consultas totales Dominios en lista negra : cuántos nombres de dominio tengo en las listas negras También hay gráficos sobre consultas y evolución de clientes en las últimas horas. Dos gráficos circulares muestran datos sobre los tipos de consultas. Y debajo (no se ve en la imagen), enumera los dominios principales y los dominios bloqueados principales, y lo mismo para los clientes.\nSecciones del menú En el menú principal encontraré enlaces a las otras páginas y secciones:\nPanel de control : la página que acabamos de ver Registro de consultas : si está habilitado, todas las consultas que realizó y si Pi-Hole las bloqueó o no Datos a largo plazo : el tablero muestra datos sobre las últimas 24 horas, en esta sección, puede especificar el rango de fechas Lista blanca : aquí puede agregar dominios a la lista blanca (si están en una lista negra y no desea bloquearlos). Por ejemplo, estoy usando Google Analytics para este sitio web y está en la lista negra, así que agregué la URL aquí. Desactivar : a veces es posible que deba desactivar Pi-Hole durante unos minutos o de forma permanente para hacer algo específico en su computadora. Aquí es donde puedes hacerlo Herramientas : un montón de herramientas para depurar Pi-Hole, te dejaré descubrir esta parte Configuración : todos los menús de configuración, llegaremos a esto en el siguiente párrafo Cerrar sesión / Donar / Ayuda : estos deben estar claros 🙂 Ajustes Profundizando en la parte de la configuración. Al hacer clic en el elemento del menú \u0026ldquo;Configuración\u0026rdquo;, obtengo varias pestañas con formularios de configuración:\nBásicamente, puedo editar aquí todas las cosas que elegí anteriormente en el asistente de instalación.\nSistema : En esta primera pestaña, puedo verificar información sobre la red y la versión y uso de Pi-Hole. También tiene una \u0026ldquo;Zona de peligro\u0026rdquo; para reiniciar servicios, reiniciar Raspberry Pi o borrar registros Listas de anuncios : en esta pestaña, puedo administrar los dominios incluidos en la lista negra. Puedo deshabilitar o eliminar listas negras predeterminadas o agregar una nueva DNS : la pestaña DNS es donde puedo cambiar los proveedores de DNS y configurar ajustes de DNS más avanzados DHCP : esta pestaña me permite habilitar un servidor DHCP en Pi-Hole. Esa es otra forma de configurar clientes si mi enrutador actual no lo hiciese. No debo olvidar deshabilitar el antiguo servidor DNS si quiero probar esta opción. Interfaz API / Web : la siguiente pestaña es para varias configuraciones sobre la interfaz. Puedo enmascarar dominios para el tablero y personalizar la visualización de la interfaz Privacidad : en esta pestaña, puedo cambiar el nivel de privacidad que vi en el asistente de instalación para aumentar o disminuir el nivel de privacidad en la interfaz Teletransportador : Finalmente, lo que ellos llaman \u0026ldquo;Teletransportador\u0026rdquo; es solo una herramienta de Importación / Exportación, para mover la configuración de una Raspberry Pi a otra. Consejos Antes de finalizar este tutorial, hay algunas otras cosas que es importante saber sobre Pi-Hole.\nActualizar la lista negra Las listas negras de dominios cambian todos los días, se deben actualizar periódicamente para mantener una buena protección.\nPara hacer esto, debo ir a Herramientas\u0026gt; Actualizar gravedad y hacer clic en Actualizar .\nPi-Hole descargará cada archivo de lista negra de las fuentes especificadas y volverá a cargar la configuración.\nActualiza el software Pi-Hole publica actualizaciones y arreglos con regularidad, por lo que debo actualizarlo. Para hacer esto, el procedimiento es simple:\nDebo conectarme a mi Raspberry Pi a través de SSH y escribir el comando sudo pihole -up :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 pi@raspberrypi:~ $ sudo pihole -up [✓] Update local cache of available packages [i] Existing PHP installation detected : PHP version 7.4.25 [✓] Checking for git [✓] Checking for iproute2 [✓] Checking for whiptail [✓] Checking for ca-certificates [i] Checking for updates... [i] Pi-hole Core:\tup to date [i] Web Interface:\tup to date [i] FTL:\tup to date [✓] Everything is up to date! pi@raspberrypi:~ $ ¿Hay alguna forma de usar Pi-Hole para bloquear más dominios que anuncios? Sí, puedo agregar mi lista y nombres de dominio personalizados. Por lo tanto, puedo usarlo para bloquear cualquier dominio: no es seguro para niños, dominios específicos o sitios web conocidos por instalar malware.\n¿Qué puedo hacer si bloqueo un sitio web útil? Si sitios web que utilizo con frecuencia no funcionan después de la configuración de Pi-Hole, puedo agregar el nombre de dominio en el menú de la lista blanca para desbloquearlo.\n¿Qué hace y cómo funciona Pi-Hole? Básicamente lo que hace Pi-hole es ponerse entre mis dispositivos y los servicios DNS que me dan acceso a todas las páginas de internet, y filtrar todos los anuncios y servicios de tracking gracias a que consulta una serie de listas con dominios de internet que están «fichados». Con Pi-hole voy a conseguir lo siguiente:\nProtección de la red: En lugar de los plugins de los navegadores u otro software en cada ordenador, instalo Pi-hole y toda mi red estará protegida. Bloquear anuncios en aplicaciónes: El bloqueo a nivel de red te permite bloquear los anuncios en aplicaciones móviles y televisores inteligentes (SmartTV), independientemente del hardware o del sistema operativo. Mejorar el rendimiento de la red: Como los anuncios se bloquean antes de ser descargados, el rendimiento de la red mejora. Control de estadísticas: voy poder controlar las estadísticas de bloqueos en mi red y averiguar que servicios son los menos respetan mi privacidad. Usar listas negras adicionales (malware, spam, phishing, etc.) Si las listas negras (blacklists) por defecto de Pi-hole no son suficientes, siempre se pueden añadir listas adicionales para optimizar el filtrado.\nDesde el apartado Group Management -\u0026gt; Adlists se pueden modificar las listas que Pi-hole usa para admitir o bloquear direcciones.\nEn mi caso, uso las listas de “The Blocklist Project“ y las listas que aparecen en verde en The Firebog, que incluye múltiples catálogos de filtrado con base en temas como ads, malware, phishing, ransomware, spam, tracking, etc. Para usarlo, simplemente se escoge la categoría a filtrar y el sitio web provee de la URL para añadir a la lista negra. (otra opción es https://filterlists.com/).\nUna vez he agregado las listas, procedo a actualizarlas desde el menú “Tools” “Upadte Gravity”\nUsar filtrados adicionales desde el DNS Los servicios de DNS como Cloudflare (quienes gestionan el servicio de DNS 1.1.1.1) incluyen mejoras en sus DNS que permiten el filtrado tanto de malware como de contenido para adultos en su servicio 1.1.1.1 for Families.\nEn este caso, simplemente se cambia el DNS superior (upstream DNS) de Pi-hole desde “Settings” -\u0026gt; “DNS” y se configuran los siguientes valores, dependiendo de los filtrados que se quieran incorporar:\n1 2 3 4 5 6 7 8 9 10 11 12 13 Malware: - 1.1.1.2 - 1.0.0.2 - 2606:4700:4700::1112 - 2606:4700:4700::1002 Malware y contenido para adultos: - 1.1.1.3 - 1.0.0.3 - 2606:4700:4700::1113 - 2606:4700:4700::1003 Para probarlos, simplemente hay que visitar los siguientes dominios:\nmalware.testcategory.com phishing.testcategory.com Instalando cloudflared La instalación es bastante sencilla, sin embargo, hay que tener en cuenta en qué arquitectura estoy realizando la instalación.\narquitectura armhf (Raspberry Pi de 32 bits) Descargo el binario precompilado y lo copio en el directorio /usr/local/bin/ para permitir la ejecución por parte del usuario cloudflared. Procedo a ejecutar el binario con la bandera -v para comprobar que todo funciona\n1 2 3 4 $ wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm $ sudo cp ./cloudflared-linux-arm /usr/local/bin/cloudflared $ sudo chmod +x /usr/local/bin/cloudflared cloudflared -v Configuración cloudflaredpara ejecutarse al inicio Manera manual Creo un usuario llamado cloudflared para ejecutar el demonio:\n1 $ sudo useradd -s /usr/sbin/nologin -r -M cloudflared Procedo a crear un archivo de configuración para el usuario cloudflared:\n1 $ sudo nano /etc/default/cloudflared Edito el archivo de configuración copiando lo siguiente en /etc/default/cloudflared. Este archivo contiene las opciones de la línea de comandos que se pasan a cloudflared en el inicio:\n1 2 # Commandline args for cloudflared, using Cloudflare DNS CLOUDFLARED_OPTS=--port 5053 --upstream https://1.1.1.1/dns-query --upstream https://1.0.0.1/dns-query Actualizo los permisos para el archivo de configuración y el binario cloudflared para permitir el acceso al usuario de cloudflared:\n1 2 $ sudo chown cloudflared:cloudflared /etc/default/cloudflared $ sudo chown cloudflared:cloudflared /usr/local/bin/cloudflared Luego creo el servicio cloudflared.service con el siguiente script y lo guardo en /etc/systemd/system/. Esto controlará la ejecución del servicio y permitirá que se ejecute en el inicio:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ sudo nano /etc/systemd/system/cloudflared.service [Unit] Description=cloudflared DNS over HTTPS proxy After=syslog.target network-online.target [Service] Type=simple User=cloudflared EnvironmentFile=/etc/default/cloudflared ExecStart=/usr/local/bin/cloudflared proxy-dns $CLOUDFLARED_OPTS Restart=on-failure RestartSec=10 KillMode=process [Install] WantedBy=multi-user.target Habilito el servicio cloudflared.service para que se ejecute en el inicio, luego inicio el servicio y verifico su estado:\n1 2 3 $ sudo systemctl enable cloudflared $ sudo systemctl start cloudflared $ sudo systemctl status cloudflared Ahora compruebo que está funcionando correctamente, ejecuto el comando dig que deberá devolver una respuesta similar a la siguiente:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 $ pi@raspberrypi:~ $ dig @127.0.0.1 -p 5053 google.com ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.11.5-P4-5.1-Raspbian \u0026lt;\u0026lt;\u0026gt;\u0026gt; @127.0.0.1 -p 5053 google.com ; (1 server found) ;; global options: +cmd ;; Got answer: ;; -\u0026gt;\u0026gt;HEADER\u0026lt;\u0026lt;- opcode: QUERY, status: NOERROR, id: 12157 ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 4096 ; COOKIE: 22179adb227cd67b (echoed) ;; QUESTION SECTION: ;google.com. IN A ;; ANSWER SECTION: google.com. 191 IN A 172.217.22.14 ;; Query time: 0 msec ;; SERVER: 127.0.0.1#5053(127.0.0.1) ;; WHEN: Wed Dec 04 09:29:50 EET 2019 ;; MSG SIZE rcvd: 77 Configuración de Pi-hole Finalmente, configuro Pi-hole para usar el servicio local cloudflared como servidor DNS ascendente especificando 127.0.0.1#5053 como DNS personalizado (IPv4)\nDesinstalar cloudflared Si se instala de forma manual Cortesía de https://discourse.pi-hole.net/t/uninstall-cloudflare/21459/3\n1 2 3 4 5 6 7 $ sudo systemctl stop cloudflared $ sudo systemctl disable cloudflared $ sudo systemctl daemon-reload $ sudo deluser cloudflared $ sudo rm /etc/default/cloudflared $ sudo rm /etc/systemd/system/cloudflared.service $ sudo rm /usr/local/bin/cloudflared ","pubDate":"2022-04-05","title":"Instalación de Pi-Hole en una raspberry pi"},{"link":"https://esaborit.github.io/posts/graficas_tablas_javascript/","plain":"Existen multitud de formas de representar en la web colecciones de datos visualizándolos como gráficas o como tablas.\nEn este post quiero exponer una sencilla forma de hacerlo, utilizando varias librerías de javascript, datatables ( pluging para la librería JQuery) para representar las tablas y la librería chart.js para las gráficas.\nLa forma más adecuada para almacenar los datos a representar en todas ellas es usar bases de datos por todas las ventajas y posibilidades que nos proporcionarían. Pero como sólo necesito representar varios centenares de datos que no van a ser modificados una vez escritos y realmente no tienen mayor valor que el sentimental, los voy a almacenar en un archivo txt para la tabla y en sencillos arrays dentro del código javascript para las gráficas. Esto me facilita su publicación web no teniendo que recurrir a lenguajes de backend ni BBDD.\nPara poder utilizar las librerías una de las formas es importarlas dentro de mi proyecto.\nImporto la siguiente librería para representar las gráficas usando Chart.js:\n1 2 \u0026lt;!-- Librería Chart.min.js --\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/chart.js@latest/dist/Chart.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; Y para la tabla con datatables importo estas otras.\n1 2 3 4 5 6 7 8 \u0026lt;!-- Librería JQuery --\u0026gt; \u0026lt;script src=\u0026#34;https://code.jquery.com/jquery-3.5.1.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!-- Para la tabla con ajax --\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/responsive/2.2.9/js/responsive.bootstrap5.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;assets/js/tabla.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; Además para formatear la tabla con CSS debo importar otras librerías.\n1 2 3 4 \u0026lt;!-- CSS para dataTables --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap5.min.css\u0026#34;\u0026gt; Con todo esto el archivo index.html de mi proyecto se vería así.\nindex.html\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;es\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;!-- CSS para dataTables --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap5.min.css\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Gráficas y tablas con JavaScritp\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h2\u0026gt;Ejemplo 1 - Gráfica de líneas\u0026lt;/h2\u0026gt; \u0026lt;canvas id=\u0026#34;grafica_lineas\u0026#34;\u0026gt;\u0026lt;/canvas\u0026gt; \u0026lt;!-- Librería JQuery --\u0026gt; \u0026lt;script src=\u0026#34;https://code.jquery.com/jquery-3.5.1.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!-- Para representar las gráficas con la librería Chart.min.js --\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/chart.js@latest/dist/Chart.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;assets/js/gráficas.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!-- Para la tabla con datatables y ajax --\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/responsive/2.2.9/js/responsive.bootstrap5.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;assets/js/tabla.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; En el código html anterior he añadido una etiqueta canvas con id=\u0026quot;grafica_lineas\u0026quot; donde dibujaré una gráfica multilinea que represente por ejemplo el numero de inmersiones que realice un buceador cada año a una determinada profundidad. Para poder dibujarla utilizo el siguiente código javascript.\ngraficas.js\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 $(function () { /* * Gráfica que representa las inmersiones por profundidades y año */ // Datos de la gráfica profundidades const datosInmersionProfundidad = { // Estas etiquetas aparecen en la leyenda y en la información del eje x labels: [\u0026#34;2003\u0026#34;, \u0026#34;2004\u0026#34;, \u0026#34;2005\u0026#34;, \u0026#34;2006\u0026#34;, \u0026#34;2007\u0026#34;, \u0026#34;2008\u0026#34;, \u0026#34;2009\u0026#34;], datasets: [ { label: \u0026#34;-10m\u0026#34;, // Nombre de la línea backgroundColor: \u0026#34;rgba(255, 159, 64, 0.2)\u0026#34;,// Color de fondo borderColor:\u0026#34;rgba(255, 159, 64, 1)\u0026#34;,// Color del borde borderWidth: 1,// Ancho del borde data: [7, 9, 3, 3, 19, 7, 12]// Datos }, { label: \u0026#34;-20m\u0026#34;, backgroundColor: \u0026#34;rgba(75, 192, 192, 0.2)\u0026#34;, borderColor:\u0026#34;rgba(75, 192, 192, 1)\u0026#34;, borderWidth: 1, data: [9, 20, 52, 35, 15, 16, 18] }, { label: \u0026#34;-30m\u0026#34;, backgroundColor: \u0026#34;rgba(153, 102, 255, 0.5)\u0026#34;, borderColor: \u0026#34;rgba(153, 102, 255, 1)\u0026#34;, borderWidth: 1,// Ancho del borde data: [8, 9, 5, 7, 0, 7, 4] }, { label: \u0026#34;-40m\u0026#34;, backgroundColor: \u0026#34;rgba(159, 255, 64, 0.5)\u0026#34;, borderColor: \u0026#34;rgba(159, 255, 64, 1)\u0026#34;, borderWidth: 1, data: [0, 2, 4, 11, 0, 2, 1] } ] }; // Opciones de representación de los datos const opciones = { responsive: true, transitions: { show: { animations: { x: { from: 0 }, y: { from: 0 } } }, hide: { animations: { x: { to: 0 }, y: { to: 0 } } } }, scales: { y: { beginAtZero: true } } }; // Obtengo la referencia al elemento canvas que quiero seleccionar const ctx = document.getElementById(\u0026#34;profundidades\u0026#34;).getContext(\u0026#39;2d\u0026#39;); // Represento la gráfica const profundidades = new Chart(ctx, { type: \u0026#34;line\u0026#34;, // Tipo de gráfica data: datosInmersionProfundidad, options: opciones }); }); El script anterior lo importo al archivo index.html del proyecto incluyendo la siguiente línea.\n1 \u0026lt;script src=\u0026#34;assets/js/gráficas.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; Si quiero añadir más gráficas a mi proyecto debo de crear nuevas etiquetas canvas en donde dibujarlas. Cada una de ellas identificada por su id único al que vincularé una gráfica.\n1 2 \u0026lt;canvas id=\u0026#34;lugares\u0026#34;\u0026gt;\u0026lt;/canvas\u0026gt; \u0026lt;canvas id=\u0026#34;anualidades\u0026#34;\u0026gt;\u0026lt;/canvas\u0026gt; Añado el código javascript para las otras dos gráficas al archivo graficas.js.\ngraficas.js\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 /* * Gráfica que representa inmersiones por lugares de inmersión */ // Datos de las inmersiones por lugares de inmersión const datosInmersionLugar = { datasets: [{ data: [294, 2, 7, 2, 9], backgroundColor: [ \u0026#39;rgba(255, 99, 132, 0.5)\u0026#39;, \u0026#39;rgba(255, 159, 64, 0.5)\u0026#39;, \u0026#39;rgba(255, 205, 86, 0.5)\u0026#39;, \u0026#39;rgba(75, 192, 192, 0.5)\u0026#39;, \u0026#39;rgba(54, 162, 235, 0.5)\u0026#39; ], borderColor: [ \u0026#39;rgba(255, 99, 132, 1)\u0026#39;, \u0026#39;rgba(255, 159, 64, 1)\u0026#39;, \u0026#39;rgba(255, 205, 86, 1)\u0026#39;, \u0026#39;rgba(75, 192, 192, 1)\u0026#39;, \u0026#39;rgba(54, 162, 235, 1)\u0026#39; ], borderWidth: 1 }], // Estas etiquetas aparecen en la leyenda y en la información del eje x labels: [ \u0026#39;I. de Mouro\u0026#39;, \u0026#39;Tablas de Daimiel\u0026#39;, \u0026#39;P. Riomiera\u0026#39;, \u0026#39;Niño Reef\u0026#39;, \u0026#39;I. Mauricio\u0026#39; ] }; // Represento la gráfica de las inmersiones por lugares de inmersión const myPieChart = new Chart(\u0026#34;lugares\u0026#34;,{ type: \u0026#39;pie\u0026#39;,// Grafica tipo tarta data: datosInmersionLugar, options: opciones }); /* * Gráfica que representa inmersiones por anualidades */ // Datos de inmersiones por año para la gráfica const datosInmersionAnualidad = { datasets: [{ label: \u0026#34;Inmersiones totales por año\u0026#34;, data: [ 24, 40, 63, 71, 34], backgroundColor: [ \u0026#39;rgba(255, 99, 132, 0.5)\u0026#39;, \u0026#39;rgba(255, 159, 64, 0.5)\u0026#39;, \u0026#39;rgba(255, 205, 86, 0.5)\u0026#39;, \u0026#39;rgba(75, 192, 192, 0.5)\u0026#39;, \u0026#39;rgba(54, 162, 235, 0.5)\u0026#39; ], borderColor: [ \u0026#39;rgba(255, 99, 132, 1)\u0026#39;, \u0026#39;rgba(255, 159, 64, 1)\u0026#39;, \u0026#39;rgba(255, 205, 86, 1)\u0026#39;, \u0026#39;rgba(75, 192, 192, 1)\u0026#39;, \u0026#39;rgba(54, 162, 235, 1)\u0026#39; ], borderWidth: 1 }], // Estas etiquetas aparecen en la leyenda y en la información del eje x labels: [\u0026#39;2003\u0026#39;, \u0026#39;2004\u0026#39;, \u0026#39;2005\u0026#39;, \u0026#39;2006\u0026#39;, \u0026#39;2007\u0026#39;] }; // Represento la gráfica de las inmersiones por año const diagramaBarras = new Chart(\u0026#34;anualidades\u0026#34;, { type: \u0026#39;bar\u0026#39;, // tipo de gráfica de barras data: datosInmersionAnualidad, options: opciones }); Con esto ya tengo representadas las gráficas. Lo siguiente que quiero es crear un tabla que por ejemplo muestre el detalle de cada una de las inmersiones de dicho buceador.\nPara ello añado el código html que representará la tabla a mi archivo index.html del proyecto.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026lt;table id=\u0026#34;tabla\u0026#34; class=\u0026#34;display table table-striped table-sm\u0026#34; style=\u0026#34;width:100%\u0026#34;\u0026gt; \u0026lt;thead class=\u0026#34; text-primario\u0026#34;\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;Nº\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Lugar\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Fecha\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Prof.\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Tiempo\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;%O2\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Tª\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Inicio\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Fin\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Int sup\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;CNS o2\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Prof. media\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Cons. Bares\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Botella\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Cons. litros\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;l/min\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Observaciones\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;/table\u0026gt; Utilizo el siguiente scritp que llama a la librería Datatable para construir la tabla.\ntabla.js\n1 2 3 4 5 6 7 8 9 $(document).ready(function() { $(\u0026#39;#tabla\u0026#39;).DataTable( { \u0026#34;ajax\u0026#34;: \u0026#39;/diario_de_inmersiones/assets/ajax/data/buceo.txt\u0026#39;, \u0026#34;language\u0026#34;: { \u0026#34;url\u0026#34;: \u0026#34;//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json\u0026#34; }, \u0026#34;scrollY\u0026#34;: \u0026#34;300px\u0026#34;, } ); } ); Este a su vez llama al archivo buceo.txt donde he almacenado en un array los datos de cada inmersión.\nbuceo.txt\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 { \u0026#34;data\u0026#34;: [ [ \u0026#34;462\u0026#34;, \u0026#34;Isla de Mouro\u0026#34;, \u0026#34;02/09/2021\u0026#34;, \u0026#34;14,7\u0026#34;, \u0026#34;47\u0026#34;, \u0026#34;21\u0026#34;, \u0026#34;14\u0026#34;, \u0026#34;17:58:00\u0026#34;, \u0026#34;18:45:00\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;7,9\u0026#34;, \u0026#34;112\u0026#34;, \u0026#34;12\u0026#34;, \u0026#34;1342\u0026#34;, \u0026#34;28,60\u0026#34;, \u0026#34;Zona de la Corvera, el agua estaba muy fría y bastante sucia. Fuimos todos en grupo. Lo mejor una docena de lubinas de las gordas gordas que descubrió pepe en una grieta. !!Espectacular!! \u0026#34; ], [ \u0026#34;461\u0026#34;, \u0026#34;Isla de Mouro\u0026#34;, \u0026#34;17/08/2021\u0026#34;, \u0026#34;11,1\u0026#34;, \u0026#34;65\u0026#34;, \u0026#34;21\u0026#34;, \u0026#34;20\u0026#34;, \u0026#34;17:44:00\u0026#34;, \u0026#34;18:49:00\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;6,2\u0026#34;, \u0026#34;125\u0026#34;, \u0026#34;12\u0026#34;, \u0026#34;1500\u0026#34;, \u0026#34;23,08\u0026#34;, \u0026#34;\u0026#34; ], [ \u0026#34;460\u0026#34;, \u0026#34;Laredo\u0026#34;, \u0026#34;08/08/2020\u0026#34;, \u0026#34;24,3\u0026#34;, \u0026#34;37\u0026#34;, \u0026#34;21\u0026#34;, \u0026#34;14\u0026#34;, \u0026#34;09:10:00\u0026#34;, \u0026#34;10:27:00\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;18,1\u0026#34;, \u0026#34;115\u0026#34;, \u0026#34;12\u0026#34;, \u0026#34;1380\u0026#34;, \u0026#34;37,30\u0026#34;, \u0026#34;Aquí el agua estaba muy fría\u0026#34; ] ] } El archivo index.html que representa a las tres gráficas y la tabla quedaría así:\nindex.html\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;es\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;!-- CSS para dataTables --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap5.min.css\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Gráficas y tablas con JavaScritp\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h2\u0026gt;Ejemplo 1 - Gráfica de líneas\u0026lt;/h2\u0026gt; \u0026lt;canvas id=\u0026#34;grafica_lineas\u0026#34;\u0026gt;\u0026lt;/canvas\u0026gt; \u0026lt;h2\u0026gt;Ejemplo 2 - Gráfica de porciones\u0026lt;/h2\u0026gt; \u0026lt;canvas id=\u0026#34;lugares\u0026#34;\u0026gt;\u0026lt;/canvas\u0026gt; \u0026lt;h2\u0026gt;Ejemplo 3 - Gráfica de barras\u0026lt;/h2\u0026gt; \u0026lt;canvas id=\u0026#34;anualidades\u0026#34;\u0026gt;\u0026lt;/canvas\u0026gt; \u0026lt;h2\u0026gt;Ejemplo 4 - Tabla\u0026lt;/h2\u0026gt; \u0026lt;table id=\u0026#34;tabla\u0026#34; class=\u0026#34;display table table-striped table-sm\u0026#34; style=\u0026#34;width:100%\u0026#34;\u0026gt; \u0026lt;thead class=\u0026#34; text-primario\u0026#34;\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;Nº\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Lugar\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Fecha\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Prof.\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Tiempo\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;%O2\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Tª\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Inicio\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Fin\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Int sup\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;CNS o2\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Prof. media\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Cons. Bares\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Botella\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Cons. litros\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;l/min\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Observaciones\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;!-- Librería JQuery --\u0026gt; \u0026lt;script src=\u0026#34;https://code.jquery.com/jquery-3.5.1.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!-- Para representar las gráficas con la librería Chart.min.js --\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/chart.js@latest/dist/Chart.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;assets/js/gráficas.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!-- Para la tabla con datatables y ajax --\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.datatables.net/responsive/2.2.9/js/responsive.bootstrap5.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;assets/js/tabla.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Con esto es suficiente para representar las tres gráficas y la tabla de inmersiones. Ya solo queda ponerlo un poco mas bonito con un poco de html y css, pero eso sería contenido para otro árticulo. Se pude ver el resultado aquí, y el código del proyecto aquí.\nFuentes\nhttps://www.chartjs.org/\nhttps://cdnjs.com/libraries/Chart.js\nhttps://www.datatables.net/\n","pubDate":"2022-03-26","title":"Visualización de gráficas y tablas con javascript"},{"link":"https://esaborit.github.io/posts/git-github-gitlab/","plain":"Github y GitLab son servicios web que permiten alojar el código de proyectos utilizando el software de control de versiones Git.\nAmbos servicios tienen cuentas gratuitas y de pago. La cuenta gratuita de ambas permite crear repositorios públicos y privados desde 2019, año en que Github cambió su política y permitió los repositorios privados en la cuenta gratuita.\nCreación de cuentas en GitHub/GitLab Este es un paso sencillo, basta con entrar en la web de GitHub o en la de GitLab y seguir el proceso para registrarse que desde ella me ofrece. Como quiero asociar mis cuentas con Git, lo mas cómodo es que el nombre del usuario y el correo electrónico sean el mismo en cada cuenta.\nAsociación de Git con las cuentas de GitHub/GitLab Antes que nada, necesito comprobar si tengo instalado Git en mi sistema, porque sino tendría que instalarlo.\nGit, es un software de control de versiones diseñado por Linus Torvalds. Su propósito es llevar registro de los cambios en archivos de computadora incluyendo coordinar el trabajo que varias personas realizan sobre archivos compartidos en un repositorio de código.\nPara comprobar si está instalado en el sistema escribo en la terminal:\n1 2 usuario@mi-pc:~ $ git --version git version 2.30.2 En mi caso si está instalado. Para instalar Git en una distribución GNU/Linux basada en Debian o Ubuntu bastaría con escribir lo siguiente en el terminal:\n1 usuario@mi-pc:~ $ sudo apt install git Configuración de Git Una vez que estoy seguro de tener instalado git es hora de empezar a configurarlo. Desde el terminal tecleo lo siguiente:\n1 2 usuario@mi-pc:~ $ git config --global user.name \u0026#34;Mi usuario aquí\u0026#34; usuario@mi-pc:~ $ git config --global user.email \u0026#34;usuario@email.com\u0026#34; El email tiene que ser el mismo que el de la cuenta de GitHub o GitLab\nConfigurada globalmente mi identidad puedo elegir el editor de texto por defecto que se utilizará cuando Git necesite que introduzca un mensaje. Si no indico nada, Git usará el editor por defecto de mi sistema, en este caso es nano.\n1 2 3 $ git config --global core.editor \u0026#34;nano -w\u0026#34; # O también elegir vs code $ git config --global core.editor \u0026#34;code --wait\u0026#34; Generar SSH KEY Para poder conectarme via ssh debo crear una ssh key. Esta llave se va a utilizar para establecer una conexión segura entre Github o GitLab y mi ordenador. Parto de la base que no tengo ninguna llave generada. Para comprobarlo escribo lo siguiente en el terminal:\n1 2 3 4 usuario@mi-pc:~$ cd ~/.ssh usuario@mi-pc:~/.ssh $ ls config known_hosts usuario@mi-pc:~/.ssh $ Si tuviera alguna llave generada tendría que aparecer alguno de estos dos archivos.\n1 2 id_rsa id_dsa.pub En el caso de tenerlo ignoraría el siguiente paso y pasaría directamente instalar xclip.\nGeneración de la clave\nPara generarla llave tecleo lo siguiente en el terminal:\n1 usuario@mi-pc:~ $ ssh-keygen -t rsa -C \u0026#34;usuario@email.com\u0026#34; Aparece lo siguiente:\n1 Generating public/private rsa key pair. # Enter file in which to save the key (/home/you/.ssh/id_rsa): Le doy al enter sin escribir nada y entonces me pide que escriba dos veces una contraseña. Esta contraseña me la va a pedir cada vez que quiera subir algo a mi cuenta. Me aparece esto:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 usuario@mi-pc:~/.ssh $ ssh-keygen -t rsa -C \u0026#34;usuario@email.com\u0026#34; Generating public/private rsa key pair. Enter file in which to save the key (/home/Usuario/.ssh/id_rsa): Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/Usuario/.ssh/id_rsa Your public key has been saved in /home/Usuario/.ssh/id_rsa.pub The key fingerprint is: SHA256:oEJknc0DLPMBHsclNK7OQ932mrWX8H2eSY/0o2mbzEg usuario@email.com The key\u0026#39;s randomart image is: +---[RSA 3072]----+ | =***. | | +o+*o+ | | o+... | | . o.o . | | + o o S | | + . . . | | + o E o | | . + .= =++B | | o .. ..XB +| +----[SHA256]-----+ usuario@mi-pc:~/.ssh $ Ahora la llave creada debería estar en:\n1 ~/.ssh/id_rsa.pub Puedo copiarla manualmente o usando el programa xclip desde la linea de comandos.\nInstalación de xclip\n1 usuario@mi-pc:~/.ssh $ sudo apt install xclip Instalo el programa xclip. Va a pedir la contraseña de Linux (no confundir con la contraseña de Git)\nUna vez instalado escribo lo siguiente para copiar la llave:\n1 usuario@mi-pc:~/.ssh $ xclip -sel clip \u0026lt; ~/.ssh/id_rsa.pub Añadir una llave SSH a GitHub o GitLab Para ello entro en mis cuenta de Github y GitLab y arriba a la derecha pulso sobre mi foto de usuario, voy a «Settings» y finalmente a «SSH Keys». En el caso de GitHub tengo que presionar también en «Add SSH Key»\nEn «title» puedo poner lo que me apetezca o dejarlo en blanco (va a aparecer mi correo). En la parte de «Key» pego lo que anteriormente copie con el programa xclip (simplemente botón derecho-pegar o ctrl + v). Finalmente le doy a «Add Key»\nFuncionamiento Para comprobar que lo tengo enlazado correctamente escribo lo siguiente:\nNota: aparece una ventana pidiendo una contraseña, debo introducir la contraseña puesta en la configuración de la SSH Key. Si no lo hago saldrá «Permission denied (publickey)»\nPara GitHub:\n1 2 3 4 5 6 7 8 usuario@mi-pc:~/.ssh $ ssh -T git@github.com The authenticity of host \u0026#39;github.com (140.82.121.4)\u0026#39; can\u0026#39;t be established. ECDSA key fingerprint is SHA256:p2QAJJNICHGJYWeIOttrVc98/R1BUFWu3/LiyKgUfQM. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;github.com,140.82.121.4\u0026#39; (ECDSA) to the list of known hosts. Enter passphrase for key \u0026#39;/home/Usuario/.ssh/id_rsa\u0026#39;: Hi usuario! You\u0026#39;ve successfully authenticated, but GitHub does not provide shell access. usuario@mi-pc:~/.ssh $ Para GitLab:\n1 2 3 4 5 6 7 8 usuario@mi-pc:~/.ssh $ ssh -T git@gitlab.com The authenticity of host \u0026#39;gitlab.com (172.65.251.78)\u0026#39; can\u0026#39;t be established. ECDSA key fingerprint is SHA256:Hbw3g8zVjNSksFbiTiUWPWg2Bq1x8xdGUrliXFzSnUw. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;gitlab.com,172.65.251.78\u0026#39; (ECDSA) to the list of known hosts. Enter passphrase for key \u0026#39;/home/Usuario/.ssh/id_rsa\u0026#39;: Welcome to GitLab, @usuario! usuario@mi-pc:~/.ssh $ Si aparece el mensaje «Permission denied (publickey)» en más ocasiones Github tiene una página dedicada a solucionar este problema: https://help.github.com/articles/error-permission-denied-publickey\nEmpezar a usar GitHub/GitLab Para subir mi código a GitHub o GitLab puedo subir el código de un repositorio local de mi ordenador, o hacer un fork de otro repositorio remoto.\nNota: un repositorio es básicamente un lugar/espacio centralizado donde se almacena, organiza, mantiene y difunde información digital, habitualmente archivos informáticos. Pueden ser locales o estar en una red informática (por ejemplo internet).\nSubir un proyecto almacenado en el ordenador personal. Primero necesito crear un nuevo repositorio remoto en Github y/o Gitlab donde almacenar el código.\nCrear un repositorio remoto GitHub Una vez entro en mi cuenta, en la pestaña de repositorios me aparecerá un botón verde con el nombre de «new repository» que me permitirá crear un nuevo proyecto.\nUna vez creado, se sitúa en el automáticamente y muestra una pantalla con instrucciones para iniciar a trabajar con el repositorio remoto y poder vincularlo a otro que tengamos o creemos en local. Nos da dos opciones, vía https o vía ssh.\nssh\nhttps\nGitLab Dentro en mi cuenta de GitLab, hay una sección para crear un proyecto. Donde va a aparecer una página en la que puedo configurar un nuevo repositorio indicando su nombre, descripción, licencia y si será privado o público.\nUna vez creado, muestra una pantalla con instrucciones para iniciar a trabajar con el repositorio remoto y poder vincularlo a otro que tengamos o creemos en local.\nCreando un repositorio local Me sitúo en la carpeta donde quiero crear el repositorio local y lo creo desde la línea de comandos\n1 2 usuario@mi-pc:~ $ mkdir proyecto_local_gh usuario@mi-pc:~ $ cd proyecto_local_gh/ Entro de la carpeta del que será el repositorio local creo un archivo markdown como primer contenido del mismo.\n1 usuario@mi-pc:~ $ echo \u0026#34;# Primer proyecto en github\u0026#34; \u0026gt;\u0026gt; README.md Transformo la carpeta en repositorio local creándose una carpeta oculta llamada .git.\n1 2 usuario@mi-pc:~ $ git init Inicializado repositorio Git vacío en /home/Enrique/repositorios_github/Pruebas/proyecto_local_gh/.git/ Para comprobar lo que se ha añadido al staging area para subir escribo:\n1 usuario@mi-pc:~ $ git status Los archivos que aparecen en verde ya están añadidos, y los archivos en rojo son los que faltan por añadir.\nYa puedo hacer un commit para confirmar los cambios y enviar los archivos de la zona de Index al repositorio local. Lo que sale entre comillas es el comentario que va a parecer en el commit.\n1 2 3 4 usuario@mi-pc:~ $ git commit -m \u0026#34;primer commit\u0026#34; [mainlab (commit-raíz) 53bdb81] primer commit 1 file changed, 1 insertion(+) create mode 100644 README.md Como se puede observar el nombre de la rama del mi repositorio local es mainlab porque he configurado git para que así sea con el comando siguiente\n1 usuario@mi-pc:~ $ git config --global init.defaultbranch mainlab Sino por defecto el nombre sería master.\nCambio el nombre de la rama local y lo dejo como quiero que se llame en el repositorio remoto de Github.\n1 usuario@mi-pc:~ $ git branch -M maingh Configurando repositorios remotos Lo siguiente es asignar el repositorio remoto al que quiero subir el proyecto local. Los repositorios remotos son proyectos alojados en servidores, como Github/Gitlab. git remote me permite usar un nombre corto (alias) para ejecutar comandos en lugar de escribir una URL remota completa. Yo en el ejemplo he optado hacerlo a través de ssh:\nGithub\n1 2 3 4 5 6 7 8 9 # Modelo mediante ssh usuario@mi-pc:~ $ git remote add origin git@github.com:nombre_de_usuario/nombre_del_repositorio.git # ejemplo usuario@mi-pc:~ $ git remote add origin_gh git@github.com:esaborit/proyecto_github.git # Modelo mediante https usuario@mi-pc:~ $ git remote add origin https://github.com/nombre_de_usuario/nombre_del_repositorio.git # ejemplo usuario@mi-pc:~ $ git remote add origin https://github.com/esaborit/proyecto_github.git Nota: git@github.com:nombre_de_usuario/nombre_del_repositorio.git, es una de las diferentes formas de especificar el acceso a un repositorio a través de SSH; esta es la \u0026ldquo;sintaxis de estilo scp\u0026rdquo; descrita en la documentación. Que el nombre de usuario en la sintaxis de estilo scp es git se debe a la forma en que GitHub trata con la identificación de usuarios: esencialmente, ese nombre de usuario se ignora y el usuario se identifica en función del SSH key-par que solían autenticar.\norigin, oring_gh y oring_gl son los nombres de las referencias de los repositorios remotos, que sirven de atajo para llamar a las url de los repositorios remotos, puedo usar cualquiera de los nombres en la línea de comandos en lugar de la URL entera\nGitlab\n1 2 3 4 5 6 7 # Modelo mediante ssh usuario@mi-pc:~ $ git remote add origin_gl git@gitlab.com:nombre_de_usuario/nombre_del_repositorio.git # ejemplo usuario@mi-pc:~ $ git remote add origin_gl git@gitlab.com:esaborit/proyecto_gitlab.git # Modelo mediante https usuario@mi-pc:~ $ git remote add origin_gl https://gitlab.com/nombre_de_usuario/nombre_del_repositorio.git Cargando el contenido del repositorio local a un repositorio remoto Finalmente escribo la orden para subirlo todo a mi GitHub dentro del repositorio que he creado anteriormente.\n1 2 3 4 5 6 7 8 9 usuario@mi-pc:~ $ git push -u origin_gh maingh Enter passphrase for key \u0026#39;/home/Enrique/.ssh/id_rsa\u0026#39;: Enumerando objetos: 3, listo. Contando objetos: 100% (3/3), listo. Escribiendo objetos: 100% (3/3), 234 bytes | 234.00 KiB/s, listo. Total 3 (delta 0), reusado 0 (delta 0), pack-reusado 0 To github.com:esaborit/proyecto_github.git * [new branch] maingh -\u0026gt; maingh Rama \u0026#39;maingh\u0026#39; configurada para hacer seguimiento a la rama remota \u0026#39;maingh\u0026#39; de \u0026#39;origin_gh\u0026#39;. El código de la rama local maingh se va a subir en la rama remota maingh, que si no existe se creará automáticamente con la ejecución del comando anterior.\nLa -u equivale a --set-upstream y se refiere al repositorio remoto principal al que haré pull y push, esta opción solo es necesario utilizarla una sola vez.\nCuando se tiene mas de un repositorio remoto se puede utilizar esta opción para configurar uno de ellos como el principal\u0026hellip; suponiendo que tengo un repositorio en BitBucket (bitbucket), otro en GitHub (origin_gh) y otro en GitLab (origin_lab) y quisiera utilizar GitHub (origin_gh) como principal, tendría que hacer git push -u origin_gh \u0026lt;branch\u0026gt; y las siguientes veces al hacer solo git push lo hará a GitHub sin tener que especificar el repositorio pero para los otros dos si tendría que hacerlo, ej. git push bitbucket \u0026lt;branch\u0026gt; o git push origin_lab \u0026lt;branch\u0026gt;.\nSi tienes un solo repositorio y quieres evitar estar escribiendo git push origin \u0026lt;branch\u0026gt; puedes utilizar esta opción y solo hacer git push las siguientes veces.\nA esta opción también se le conoce como \u0026ldquo;argument-less git-pull/push (git-pull/push sin argumentos)\u0026rdquo;\nPuedo ver como ha quedado configurada la rama remota maingh con el comando git remote show origin_gh:\n1 2 3 4 5 6 7 8 9 10 11 12 usuario@mi-pc:~ $ git remote show origin_gh Enter passphrase for key \u0026#39;/home/Enrique/.ssh/id_rsa\u0026#39;: * remoto origin_gh URL para obtener: git@github.com:esaborit/proyecto_github.git URL para publicar: git@github.com:esaborit/proyecto_github.git Rama HEAD: maingh Rama remota: maingh rastreada Rama local configurada para \u0026#39;git pull\u0026#39;: maingh fusiona con remoto maingh Referencia local configurada para \u0026#39;git push\u0026#39;: maingh publica a maingh (actualizado) Ahora si entro en GitHub y selecciono mi repositorio, podré ver todos los cambios que se han producido.\nVoy a añadir a mi repositorio local un segundo repositorio remoto, en este caso el creado en GitLab. Desde la consola me sitúo dentro de mi repositorio local y empiezo configurando el segundo repositorio remoto\n1 usuario@mi-pc:~ $ git remote add origin_gl git@gitlab.com:esaborit/proyecto_gitlab.git Escribo el comando push para subir la rama maingh del repositorio local al repositorio remoto en GitLab que acabo de crear y donde se almacenará en una rama del mismo nombre maingh.\n1 2 3 4 5 6 7 8 9 10 $ git push -u origin_gl maingh Enter passphrase for key \u0026#39;/home/Enrique/.ssh/id_rsa\u0026#39;: Enumerando objetos: 3, listo. Contando objetos: 100% (3/3), listo. Escribiendo objetos: 100% (3/3), 234 bytes | 234.00 KiB/s, listo. Total 3 (delta 0), reusado 0 (delta 0), pack-reusado 0 To gitlab.com:esaborit/proyecto_gitlab.git * [new branch] maingh -\u0026gt; maingh Rama \u0026#39;maingh\u0026#39; configurada para hacer seguimiento a la rama remota \u0026#39;maingh\u0026#39; de \u0026#39;origin_gl\u0026#39;. Ahora si entro en GitLab y selecciono mi repositorio, podré ver todos los cambios que se han producido.\nCompruebo la configuración de las ramas remotas\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # Ramas en github $ git remote show origin_gh Warning: Permanently added the ECDSA host key for IP address \u0026#39;140.82.121.3\u0026#39; to the list of known hosts. Enter passphrase for key \u0026#39;/home/Enrique/.ssh/id_rsa\u0026#39;: * remoto origin_gh URL para obtener: git@github.com:esaborit/proyecto_github.git URL para publicar: git@github.com:esaborit/proyecto_github.git Rama HEAD: maingh Rama remota: maingh rastreada Referencia local configurada para \u0026#39;git push\u0026#39;: maingh publica a maingh (actualizado) # Ramas en gitlab $ git remote show origin_gl Enter passphrase for key \u0026#39;/home/Enrique/.ssh/id_rsa\u0026#39;: * remoto origin_gl URL para obtener: git@gitlab.com:esaborit/proyecto_gitlab.git URL para publicar: git@gitlab.com:esaborit/proyecto_gitlab.git Rama HEAD: maingh Rama remota: maingh rastreada Rama local configurada para \u0026#39;git pull\u0026#39;: maingh fusiona con remoto maingh Referencia local configurada para \u0026#39;git push\u0026#39;: maingh publica a maingh (actualizado) Clonar un repositorio Git Cuando encuentro un repositorio que me resulta de utilidad y quiero trabajar con el en local puedo proceder de dos formas, lo puedo descargar en formato zip o lo puedo clonar. La clonación presenta algunas ventajas frente a la descarga en formato zip.\nCrea un repositorio Git en local con los cambios que el repositorio remoto ha tenido a lo largo del tiempo. Podré luego enviar cambios al repositorio remoto, una vez los haya realizado en local. Para clonar un repositorio Primero copiar la URL del repositorio remoto que deseo clonar (ver el icono \u0026ldquo;Copy to clipboard\u0026rdquo; en la siguiente imagen).\nLuego abro una ventana del terminal, para situarme sobre la carpeta del proyecto que quiero clonar. Es recomendable crear ya directamente una carpeta con el nombre del proyecto a clonar, o cualquier otro nombre que te parezca mejor para este repositorio. Me sitúo dentro de esa carpeta y desde ella lanzo el comando para hacer el clón, que sería algo como esto:\n1 usuario@mi-pc:~ $ git clone https://github.com/esaborit/prueba.git El último punto me indica que el clon lo va a colocar en la carpeta donde estoy situado. La salida de ese comando sería más o menos así:\n1 2 3 4 5 6 7 8 usuario@mi-pc:~/repositorios_github/Pruebas $ git clone https://github.com/esaborit/prueba.git Clonando en \u0026#39;prueba\u0026#39;... remote: Enumerating objects: 6, done. remote: Counting objects: 100% (6/6), done. remote: Compressing objects: 100% (2/2), done. remote: Total 6 (delta 0), reused 3 (delta 0), pack-reused 0 Recibiendo objetos: 100% (6/6), listo. usuario@mi-pc:~/repositorios_github/Pruebas $ Clonando para gitlab\n1 2 3 4 # Desde ssh usuario@mi-pc:~ $ git clone git@gitlab.com:esaborit/prueba.git # Desde https usuario@mi-pc:~ $ git clone https://gitlab.com/esaborit/prueba.git Instalar las dependencias Habitualmente los desarrollos de Git tienen ignoradas las dependencias mediante el archivo .gitignore, por ello es importante que las instalemos de nuevo en el repositorio clon, en local.\nPara cada tipo de proyecto, con cada lenguaje, existirán comandos para instalar las dependencias. Este comando lo tendría que conocer con anterioridad para poder aplicarlo, si es de PHP dependerá de Composer, si es de NodeJS (o Javascript) dependerá de npm.\nSubir cambios, realizados por mi, al repositorio remoto clonado Una vez modificado el código en local, puedo subir los cambios al repositorio remoto. Al clonar el repositorio en local, está asociado el origen remoto desde donde lo traje. Sin embargo, hay que tener en cuenta:\nLas normas del propietario del repositorio para enviar cambios, como por ejemplo trabajar siempre con ramas y enviar los cambios a una rama en concreto, que luego se puede fusionar con un pull request. Si no tengo permisos por no ser mío el repositorio remoto, no puedo enviar cambios y debería haber hecho un Fork. Suponiendo que el repositorio es mío y que puedo enviar cambios directamente a la rama main, para enviar cambios a GitHub o cualquier otro hosting de repositorios, haría:\n1 usuario@mi-pc:~ $ git push Con eso se envían los cambios al instante y los podré ver reflejados en el repo remoto.\nNota: para que se envíen los cambios del repositorio, local tienen que haber sido realizadas alguna/s modificación/es en el código del proyecto y confirmado con el correspondiente/s commit.\nHacer un fork de otro proyecto Si el repositorio que voy a modificar no es mío y pretendo continuar el desarrollo, agregando cambios que querré enviar a GitHub/GitLab, tendré \u0026lt; que clonar el repositorio de otra manera.\nPrimero debo crear un \u0026ldquo;fork\u0026rdquo;. Esto es, un repositorio que es copia de otro que ya está publicado en GitHub. Lo bueno de un fork es que el repositorio será exactamente igual, pero estará en mi cuenta de GitHub, con mi usuario, por lo que tendré permisos para hacer lo que yo quiera con él.\nHacer un fork de otro repositorio significa que lo copio hacia mi repositorio remoto en GitHub o GitLab. Esto significa que guarda los commits que se hayan hecho y sus ramas.\nHacer un fork es muy fácil, busco un repositorio que me interese, entro en el y selecciono «Fork» para copiarlo a mi cuenta.\nHay un botón para hacer el fork en la parte de arriba de la página del repositorio.\nUna vez hecho el fork, el repositorio ya me pertenece. Puedo clonar (el fork, no el repositorio original) y realizar los cambios que quiera y podré subirlos perfectamente a mi propio repositorio (mi fork).\nEl resto del proceso, para descargar el repositorio, modificarlo y enviar los cambios es exactamente igual que lo descrito anteriormente, incluido el git push para enviar los cambios.\nCrear nuevas ramas Esta opción la realizaré desde dentro de mi repositorio remoto. Selecciono «branch: main» y se abrirá una lista, y un lugar para escribir. Allí escribo el nombre de la rama que quiero usar, como no la encontrará me dirá que debo crear una nueva.\nSi en vez de en el repositorio remoto de Github o GitLab quiero crear una nueva rama en el repositorio local de mi ordenador puedo utilizar el comando\n1 usuario@mi-pc:~ $ git branch nombre_de_la_rama_nueva Comandos para seleccionar la rama Un poco más atrás he creado una nueva rama ahora debo seleccionarla para trabajar en ella.\nPara ver que ramas tengo debo escribir lo siguiente en el terminal:\n1 usuario@mi-pc:~ $ git show-branch Para moverme entre ramas uso el comando git checkout seguido del nombre de la rama que quiero que sea la activa. Para seleccionar la rama deseada escribo lo siguiente:\n1 usuario@mi-pc:~ $ git checkout nombre_de_la_rama_nueva Esta sencilla operación tiene mucha potencia, porque cambiará automáticamente todos los archivos del proyecto, los de todas las carpetas, para que tengan el contenido en el que se encuentren en la correspondiente rama.\nDe momento en el ejemplo las dos ramas tenían exactamente el mismo contenido, pero ahora podría empezar a hacer cambios en la rama nueva y sus correspondientes commit y entonces los archivos tendrán códigos diferentes, de modo que se pueda ver que al pasar de una rama a otra hay cambios en los archivos.\nSi estando en la rama nueva hago un par de commit, puedo observar que al hacer el show-branches muestra nuevos datos.\nCuando quiero crear la rama local en un repositorio remoto (agregar una rama remota) y vincularlas, la primera vez, debo usar la opción -u / --set-upstream . Garantiza que se construye una relación de seguimiento entre la rama local y la remota que he creado. A partir de ahora Git sabrá lo que quiero hacer cuando uso los comandos git fetch, git pull o git push en el futuro. Mantiene las ramas locales y remotas actualizadas con el seguimiento y mantenimiento de los comandos pull y push.\n1 2 3 4 usuario@mi-pc:~ $ git push --set-upstream \u0026lt;remote\u0026gt; \u0026lt;branch\u0026gt; usuario@mi-pc:~ $ git push -u \u0026lt;remote\u0026gt; \u0026lt;branch\u0026gt; # Por ejemplo usuario@mi-pc:~ $ git push --set-upstream origin experimental Ahora cada vez que haga\n1 usuario@mi-pc:~ $ git push se subirá dentro de la rama seleccionada dejando las demás tal como estaban.\nEl comando checkout tiene la posibilidad de permitirme crear una rama nueva y moverme a ella en un único paso. Para crear una nueva rama y situarme sobre ella tendré que darle un nombre y usar el parámetro -b.\n1 usuario@mi-pc:~ $ git checkout -b otra_rama Fusionar ramas A medida que cree ramas y cambie el estado del las carpetas o archivos, en el proyecto empezarán a divergir una rama de la otra. Llegará el momento en el que interese fusionar ramas para poder incorporar el trabajo realizado a la rama main (antes master).\nEl proceso de fusionado se conoce como \u0026quot;merge\u0026quot; y puede llegar a ser muy simple o más complejo si se encuentran cambios que Git no pueda procesar de manera automática. Git para procesar los merge usa un antecesor común y comprueba los cambios que se han introducido al proyecto desde entonces, combinando el código de ambas ramas.\nPara hacer un merge me sitúo en una rama, en este caso la main, y decido con qué otra rama se debe fusionar el código.\nEl siguiente comando, lanzado desde la rama main, permite fusionarla con la rama experimental.\n1 usuario@mi-pc:~ $ git merge experimental Un merge necesita un mensaje, igual que ocurre con los commit, por lo que al realizar ese comando, en mi caso, se abrirá el editor nano (o cualquier otro editor de consola que esté configurado) para poder introducir los comentarios oportunos. Esta operativa de indicar el mensaje se puede resumir con el comando -m:\n1 usuario@mi-pc:~ $ git merge experimental -m \u0026#39;Esto es un merge con mensaje\u0026#39; En resumen una secuencia de comandos podría ser: Primero el cambio a la rama main git checkout main, luego el git branch para confirmar en qué rama nos encontramos y por último el merge para fusionarla con la rama experimental.\nLuego puedo comprobar que la rama main tiene todo el código nuevo de la rama experimental y podré hacer nuevos commits en main para seguir el desarrollo del proyecto ya con la rama principal.\nFusionar los cambios de master en la rama en desarrollo Durante tu trabajo en el desarrollo del proyecto gestionado con Git también puede ser normal que se vayan haciendo cambios en la rama main, o en otras ramas en desarrollo, y quieras traerlos para tu rama actual. Por ejemplo, la rama experimental está tardando varios días o semanas en completarse y mientras tanto han agregado nuevas features que quieras que esté disponibles también en la rama experimental.\nEntonces seguramente querrás traerte los cambios de la rama master. Para ello, estando en la rama experimental, puedes lanzar el siguiente comando.\n1 usuario@mi-pc:~ $ git merge main -m \u0026#39;Un mensaje del merge de main en la rama experimental\u0026#39; Ya lo tienes! ahora tu rama está actualizada con todos los cambios en main. Puedes seguir desarrollando tu rama experimental sabiendo que tienes el proyecto actualizado.\nSubir una rama a un repositorio remoto Para que las ramas que creo en mi repositorio local se publiquen en Github o Gitlsb, tengo que realizar específicamente la acción de subir la rama que deseo.\nDebo utilizar el comando push, indicando la opción -u y el nombre de la rama que deseo subir. Por ejemplo de esta manera:\n1 2 3 usuario@mi-pc:~ $ git push -u origin experimental # o tambien usuario@mi-pc:~ $ git push --set-upstream origin experimental Así estoy haciendo un push, empujando hacia origin (que es el nombre que se suele dar a la URL del repositorio remoto), la rama con nombre \u0026ldquo;experimental\u0026rdquo;.\nNota: al subir el proyecto a Github podré ver también un diagrama de las ramas que he ido creando y fusionando a main, en la sección Graps / Network.\nBorrar una rama En ocasiones puede ser necesario eliminar una rama del repositorio, por ejemplo porque me haya equivocado en el nombre al crearla. Aquí la operativa puede ser diferente, dependiendo de si he subido ya esa rama a remoto o si todavía solamente está en local.\nBorrado de la rama en local Esto lo consigo con el comando git branch, solamente que ahora usando la opción -d para indicar que quiero borrarla.\n1 usuario@mi-pc:~ $ git branch -d rama_a_borrar Sin embargo, puede que esta acción no funcione porque haya hecho cambios que no se hayan salvado en el repositorio remoto, o no se hayan fusionado con otras ramas. En el caso que quiera forzar el borrado de la rama, para eliminarla independientemente de si se ha hecho el push o el merge, tendré que usar la opción -D.\n1 usuario@mi-pc:~ $ git branch -D rama_a_borrar Se debe prestar especial atención a esta opción -D, ya que al eliminar de este modo pueden haber cambios que ya no se puedan recuperar. Es bastante fácil de confundir con -d, opción más segura, ya que no permite borrado de ramas en situaciones donde se pueda perder código.\nEliminar una rama en remoto Si la rama que quiero eliminar está en el repositorio remoto, la operativa es un poco diferente. Tengo que hacer un push, indicando la opción --delete, seguida de la rama que se desea borrar.\n1 usuario@mi-pc:~ $ git push origin --delete rama_a_borrar Descargar una rama de remoto A veces ocurre que se generan ramas en remoto, por ejemplo cuando han sido creadas por otros usuarios y subidas a GitHub o similar, y necesito acceder a ellas en local para verificar los cambios o continuar el trabajo. En principio esas ramas en remoto creadas por otros usuarios no están disponibles para mi en local, pero las podré descargar.\nEl proceso para obtener una rama del repositorio remoto es bien sencillo. Lo consigo con el comando fetch.\n1 usuario@mi-pc:~ $ git fetch Lanzado ese comando he podido descargar la rama git de remoto. Ahora ya puedo acceder a ella.\n1 usuario@mi-pc:~ $ git checkout mi_rama_remota_descargada Otros comandos básicos Además de los comandos anteriores, existen otros comandos muy usados que son interesantes conocer.\nOperaciones con archivos Mostraré la operativa en git con los archivos para: borrar, mover y renombrar archivos.\nEliminar archivos La forma más fácil de borrar archivos del seguimiento y eventualmente del repositorio es git rm.\n1 2 usuario@mi-pc:~ $ git rm tes2.txt rm \u0026#39;test2.txt\u0026#39; Después de ejecutar este comando, el archivo test2.txt se elimina de la carpeta de trabajo y esta información de eliminación se ha añadido al área de preparación.\n1 2 3 4 5 6 usuario@mi-pc:~ $ git status On branch master Changes to be committed: (use \u0026#34;git reset HEAD \u0026lt;file\u0026gt;...\u0026#34; to unstage) deleted: test2.txt Renombrar archivos Si renombro el fichero en mi repositorio local directamente, git considera esta operación como dos operaciones, la primera es borrar los ficheros con el antiguo y el nuevo, y la segunda es añadir el fichero recién nombrado a la copia de trabajo.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 usuario@mi-pc:~ $ git status On branch master Changes not staged for commit: (use \u0026#34;git add/rm \u0026lt;file\u0026gt;...\u0026#34; to update what will be committed) (use \u0026#34;git checkout -- \u0026lt;file\u0026gt;...\u0026#34; to discard changes in working directory) deleted: test1.txt Untracked files: (use \u0026#34;git add \u0026lt;file\u0026gt;...\u0026#34; to include in what will be committed) test1_rename.txt no changes added to commit (use \u0026#34;git add\u0026#34; and/or \u0026#34;git commit -a\u0026#34;) El inconveniente de tal operación es que rompe el historial de revisiones del fichero, y no se podría obtener el historial de revisiones de este fichero recién nombrado antes de este momento de renombramiento. No es deseable en el control de versiones.\nGit tiene un comando de renombrado para resolver este problema de enlazamiento roto - mv.\n1 usuario@mi-pc:~ $ git mv test1.txt test1_rename.txt mv significa en realidad mover, pero aquí, moverse de test1.txt a test1_rename.txt también significa renombrar el fichero.\nSi compruebo el git status ahora, aparece renamed,\n1 2 3 4 5 6 usuario@mi-pc:~ $ git status On branch master Changes to be committed: (use \u0026#34;git reset HEAD \u0026lt;file\u0026gt;...\u0026#34; to unstage) renamed: test1.txt -\u0026gt; test1_rename.txt Mover archivos De manera similar a renombrar archivos, mover archivos en git también usa el comando git mv, pero el destino del archivo no es el mismo directorio del archivo movido.\n1 usuario@mi-pc:~ $ git mv test1_rename.txt move/test1.txt Aquí, move es el directorio de destino, y test1.txt es el nuevo nombre del archivo movido test1_rename.txt.\nCompruebo el git status,\n1 2 3 4 5 6 usuario@mi-pc:~ $ git status On branch master Changes to be committed: (use \u0026#34;git reset HEAD \u0026lt;file\u0026gt;...\u0026#34; to unstage) renamed: test1_rename.txt -\u0026gt; move/test1.txt Como se puede ver, también es una operación renamed, pero con un destino diferente.\nModificar el último commit hecho Aveces se da el caso de necesitar modificar el último commit por que encontramos una errata u otros pequeños fallos en el código. Podría revisar el código y hacer otro commit en el repositorio de nuevo. Pero también puedo reescribir la última confirmación añadiéndoselos .\nLa bandera --amend después de git commit le dice a git que esta confirmación reemplazará la anterior que ya no estará en su rama de trabajo.\n1 usuario@mi-pc:~ $ git commit --amend -m \u0026#34;new information is updated\u0026#34; Nota: nunca se debe modificar una confirmación que no sea la más reciente, porque otro miembro del equipo u otras ramas tienen la versión basada en esa confirmación. Después de modificar, pierden su punto de referencia y es difícil recuperarle.\nEliminar un «commit» Sirve por si algo ha fallado o se quiere eliminar:\n1 usuario@mi-pc:~ $ git revert \u0026lt;sha del decommit\u0026gt; Eliminar origen remoto Primero debo saber la referencia a el origen a eliminar, para lo cual listo todos los que disponga en el repositorio local con el siguiente comando:\n1 git remote -v Para eliminar un origen remoto, necesito eliminar su referencia en mi repositorio local. Al eliminar un origen remoto se eliminará el origen remoto y todos sus datos del repositorio local. Ejecuto el siguiente comando.\n1 git remote rm \u0026lt;remote\u0026gt; Aquí \u0026lt;remote\u0026gt; es el nombre del origen remoto que quiero eliminar.\nPor ejemplo, para eliminar el origen remoto origin:\n1 git remote rm origin Después de eliminar un origen remoto, puedo volver a agregarlo a través del siguiente comando:\n1 git remote add origin your_Remote_Url luego ejecuto:\n1 git push -u origin master Con ello configuro la rama master para hacer seguimiento a la rama remota master desde la url contenida en origin.\nUn ejemplo práctico es:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 Enrique@esc-pc:~/repositorios_github/esaborit.github.io $ git remote -v origin\thttps://github.com/esaborit/esaborit.github.io.git (fetch) origin\thttps://github.com/esaborit/esaborit.github.io.git (push) Enrique@esc-pc:~/repositorios_github/esaborit.github.io $ git remote rm origin Enrique@esc-pc:~/repositorios_github/esaborit.github.io $ git remote -v Enrique@esc-pc:~/repositorios_github/esaborit.github.io $ git remote add origin git@github.com:esaborit/esaborit.github.io.git Enrique@esc-pc:~/repositorios_github/esaborit.github.io $ git remote -v origin\tgit@github.com:esaborit/esaborit.github.io.git (fetch) origin\tgit@github.com:esaborit/esaborit.github.io.git (push) Enrique@esc-pc:~/repositorios_github/esaborit.github.io $ git push -u origin master Enter passphrase for key \u0026#39;/home/Enrique/.ssh/id_rsa\u0026#39;: Enumerando objetos: 328, listo. Contando objetos: 100% (328/328), listo. Compresión delta usando hasta 4 hilos Comprimiendo objetos: 100% (213/213), listo. Escribiendo objetos: 100% (238/238), 10.42 MiB | 4.75 MiB/s, listo. Total 238 (delta 86), reusado 30 (delta 0), pack-reusado 0 remote: Resolving deltas: 100% (86/86), completed with 45 local objects. To github.com:esaborit/esaborit.github.io.git 8607447..04c3477 master -\u0026gt; master Rama \u0026#39;master\u0026#39; configurada para hacer seguimiento a la rama remota \u0026#39;master\u0026#39; de \u0026#39;origin\u0026#39;. Enrique@esc-pc:~/repositorios_github/esaborit.github.io $ De esta forma he conseguido actualizar el origen del repositorio remoto pasando de https a ssh\n1 2 3 https://github.com/esaborit/esaborit.github.io.git git@github.com:esaborit/esaborit.github.io.git Tambien se puede hacer utilizando un solo comando\n1 2 3 git remote set-url origen_a_cambiar newUrl # Por ejemplo git remote set-url origin git@github.com:esaborit/esaborit.github.io.git Otros comandos 1 2 usuario@mi-pc:~ $ git log usuario@mi-pc:~ $ git log -p Sirve para ver los commits fusionados y ver sus sha. El segundo aparte de del commit también me muestra los cambios.\n1 usuario@mi-pc:~ $ git reset --hard HEAD~1 Esto revierte el último commit que he echo antes de hacer un push y borra los cambios producidos.\n1 usuario@mi-pc:~ $ git reset --soft HEAD~1 Retrocede un commit, pero no borra ni pierdo los cambios, osea, que saldrá como si estuviera pendiente de hacer el commit, bastante útil para hacer cambios de última hora.\nEn ambos, una vez hecho push, no queda mas remedio que hacer revert.\nConceptos de main , origin y HEAD. HEAD es un nombre que se refiere siempre al commit en el que tenemos posicionado el repositorio en el momento actual. Independientemente de la rama en la que estemos, de cómo se llame la rama principal o el repositorio principal remoto.\nmain la rama predeterminada que se crea automáticamente cuando se crea un repositorio.\nNota: hasta mediados del año 2020 esta rama se llamaba \u0026ldquo;master\u0026rdquo; y no \u0026ldquo;main\u0026rdquo;.\nPor regla general a main se la considera la rama principal y la raíz de la mayoría de las demás ramas. Lo más habitual es que en main se encuentre el \u0026ldquo;código definitivo\u0026rdquo;, que luego va a producción, y es la rama en la que se mezclan todas las demás tarde o temprano para dar por finalizada una tarea e incorporarla al producto final.\nEsta manera de trabajar con ramas nos permite llevar en paralelo varios desarrollos relacionados sin importar que cada uno de ellos termine en momentos muy diferentes, ya que no interfieren, pudiendo mezclarlos todos al final.\nLo más habitual es que para poder mezclar otra rama cualquiera con main haya que pedir permiso y que alguien lo revise todo antes de permitirlo. Es lo que se denomina un \u0026ldquo;pull request\u0026rdquo;. O simplemente que la rama main se encuentre protegida de modo que solo si se pasan todos los test y aseguramos que el producto funciona, sea posible mezclarse con ella. De este modo impedimos que cualquiera pueda llevar al producto final código que no cumple unos mínimos de calidad.\norigin es simplemente el nombre predeterminado que recibe el repositorio remoto principal contra el que trabajamos. Cuando clonamos un repositorio por primera vez desde GitHub o cualquier otro sistema remoto, el nombre que se le da a ese repositorio \u0026ldquo;maestro\u0026rdquo; es precisamente origin\nHacer un pull sin especificar cómo reconciliar las ramas es poco recomendable\n1 usuario@mi-pc:~ $ git config --global pull.rebase false Inspecciono el repositorio remoto con el comando $ git remote show origin.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 usuario@mi-pc:~ $ git remote show origin * remoto origin URL para obtener: https://github.com/esaborit/prueba.git URL para publicar: https://github.com/esaborit/prueba.git Rama HEAD: master Ramas remotas: experimental rastreada master rastreada Ramas locales configuradas para \u0026#39;git pull\u0026#39;: experimental fusiona con remoto experimental master fusiona con remoto master Referencias locales configuradas para \u0026#39;git push\u0026#39;: experimental publica a experimental (actualizado) master publica a master (actualizado) El comando lista la URL del repositorio remoto y la información del rastreo de ramas. El comando te indica claramente que si estás en la rama maestra y ejecutas el comando git pull, automáticamente combinará la rama maestra remota con tu rama local, luego de haber traído toda la información de ella. También lista todas las referencias remotas de las que ha traído datos.\nEste comando te indica a cuál rama enviarás información automáticamente cada vez que ejecutas git push, dependiendo de la rama en la que estés. También te muestra cuáles ramas remotas no tienes aún, cuáles ramas remotas tienes que han sido eliminadas del servidor, y varias ramas que serán combinadas automáticamente cuando ejecutes git pul.\nCuando hacemos git pull, nos traemos los cambios del repositorio que elijamos o tengamos configurado, y uno de los parámetros que podemos utilizar es rebase:\n1 git pull --rebase ¿Qué hace esto? Al realizar un pull estamos haciendo un fetch y justo después un merge, pasándole la opción rebase, git intentará traer todos los cambios y después aplicar nuestras modificaciones encima en lugar de intentar hacer un merge desde el punto en el que estábamos, esto hará que nuestro histórico tenga mucho mejor aspecto.\nNota: Git no siempre va a poder hacer git pull --rebase, por descontado si hay conflictos, no sobreescribe el código sino que nos dejará editar y entonces forzará hacer un merge manual.\nFuentes\nhttps://www.atlassian.com/es/git/tutorials/what-is-git\nhttps://git-scm.com/book/es/v2/Fundamentos-de-Git-Obteniendo-un-repositorio-Git\nhttps://www.w3schools.com/git/default.asp?remote=gitlab\nhttps://desarrolloweb.com/articulos/trabajar-ramas-git.html\nhttps://desarrolloweb.com/manuales/manual-de-git.html\nhttps://docs.gitlab.com/ee/gitlab-basics/add-file.html#add-a-file-using-the-command-line\nhttps://instatecno.com/aprender-git-github-gitlab-bitbucket/\n","pubDate":"2022-02-23","title":"Uso básico de Git con GitLab y GitHub"},{"link":"https://esaborit.github.io/posts/virtualizando-con-kmv-en-mx-linux/","plain":"Pequeño tutorial para la instalación de KMV en Mx-linux.\nInstalar Qemu/KVM, libvirt y virt-manager en MX-Linux para Virtualización libvirt está compuesto por una API de administración (de código abierto) y un demonio con el que se puede interactuar con su pila de virtualizaciónes. Es una herramienta para la administración de máquinas virtuales, soporta los siguientes hypervisores KVM/Qemu, Xen, LXC, OpenVZ, VirtualBox, Hyper-V, y de VMware soporta ESX y Workstation.\nKVM (Kernel based Virtual Machine) es un módulo del kernel de linux que permite utilizar las extensiones de virtualización de los procesadores. KMV está soportado en casi todos los procesadores actuales ya sean Intel (vmx) o AMD (svm), tanto para arquitectura x86 como x86_64.\nvirt-manager es una aplicación de escritorio para administrar maquinas virtuales por medio de libvirt, su principal foco es para máquinas virtuales en KVM, pero también soporta Xen y LXC, su interfaz permite ver un resumen de las máquinas y una vista rápida de los recursos utilizados, tiene un asistente para crear Máquinas Virtuales, tiene un cliente VNC y SPICE para tener acceso a la consola gráfica de las máquinas virtuales.\nPasos para instalar y habilitar KVM en Mx-Linux Confirmación del soporte de virtualización Lo primero que hay que realizar es verificar que el procesador del equipo soporta las extensiones de virtualización, si la máquina donde voy a probar tiene un procesador fabricado aproximadamente después del 2006 no debería tener problema, siempre y cuando no sean de la gama baja, Intel Atom, Intel Celeron.\nComo dije al principio, necesito un sistema con un procesador Intel o AMD que tenga habilitada la extensión de virtualización. Por lo tanto, para confirmarlo, abro el terminal de comandos y ejecuto los siguientes comandos:\n1 2 $ egrep -c \u0026#39;(vmx | svm)\u0026#39; /proc/cpuinfo $ grep -E --color \u0026#39;(vmx | svm)\u0026#39; /proc/cpuinfo La salida del primer comando debería ser mayor que cero (podría ser 1, 2, 6 u 8). Si es así, el sistema admite la virtualización.\nY si no es así, primero debo reiniciar el sistema e ingresar al BIOS del sistema. Habilitar allí la virtualización y luego iniciar el sistema operativo donde nuevamente debo ejecutar el comando anterior para confirmar de nuevo que está habilitada la extensión de virtualización.\nCon el segundo comando , obtengo información sobre su CPU, ya sea Intel o AMD. Si el texto de salida de color rojo es VMX, entonces es Intel, mientras que SVM significa AMD .\n1 2 3 4 5 Enrique@esc-pc:~ $ egrep -c \u0026#39;(vmx | svm)\u0026#39; /proc/cpuinfo 8 Enrique@esc-pc:~ $ grep -E --color \u0026#39;(vmx | svm)\u0026#39; /proc/cpuinfo Actualización del sistema. Actualizo el sistema antes de continuar con la instalación.\n1 2 $ sudo apt-get update $ sudo apt-get dist-upgrade Instalación de QEMU-KVM y Libvirt en Mx-Linux El siguiente es el comando que descargará e instalará todo lo necesario para la instalación de Qemu, el hipervisor KVM y Libvirt en Mx-Linux.\n1 $ sudo apt-get install qemu-kvm libvirt-clients libvirt-daemon-system bridge-utils virtinst libvirt-daemon Antes de continuar, debo confirmar que el demonio de virtualización, libvritd-daemon, se está ejecutando. Para hacerlo, ejecuto el comando service libvirtd status.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ service libvirtd status ● libvirtd.service - Virtualization daemon Loaded: loaded (/lib/systemd/system/libvirtd.service; enabled; vendor preset: enabled) Active: active (running) since Sun 2022-01-16 18:57:14 CET; 2h 16min ago TriggeredBy: ● libvirtd.socket ● libvirtd-admin.socket ● libvirtd-ro.socket Docs: man:libvirtd(8) https://libvirt.org Main PID: 1008 (libvirtd) Tasks: 22 (limit: 32768) Memory: 34.4M CPU: 10.636s CGroup: /system.slice/libvirtd.service ├─1008 /usr/sbin/libvirtd ├─3090 /usr/sbin/dnsmasq --conf-file=/var/lib/libvirt/dnsmasq/default.conf --leasefile-ro --dhcp-script=/usr/lib\u0026gt; └─3091 /usr/sbin/dnsmasq --conf-file=/var/lib/libvirt/dnsmasq/default.conf --leasefile-ro --dhcp-script=/usr/lib\u0026gt; Warning: some journal files were not opened due to insufficient permissions. lines 1-18/18 (END) Para verificar si los módulos KVM están cargados, ejecuto el comando $ lsmod | grep -i kvm:\n1 2 3 4 $ lsmod | grep -i kvm kvm_intel 327680 0 kvm 921600 1 kvm_intel irqbypass 16384 1 kvm Puede observarse la presencia del módulo kvm_intel. Este es el caso de los procesadores Intel.\nPara que no me pida la contraseña del usuario cada vez que inicio la aplicación voy a añadir el usuario al grupo libvirt.\n1 $ sudo usermod -a -G libvirt Enrique Instalación de la GUI Virt-Manager para KVM Virt-Manager , es la interfaz gráfica de usuario desarrollada por RedHat para crear, administrar y ejecutar máquinas virtuales usando KVM pero gráficamente. La instalo desde la línea de comandos.\n1 $ sudo apt install virt-manager -y Configuración de la red Para enumerar la red disponible para usar en máquinas virtuales KVM, puedo ejecutar el siguiente comando:\n1 2 3 4 $ sudo virsh net-list --all Nombre Estado Inicio automático Persistente ---------------------------------------------------------------------------- default inactivo no si Una vez ejecutado el comando, veo que la red predeterminada no está activa y tampoco configurada para iniciarse automáticamente con un reinicio del sistema. Por lo tanto, para activarlo e iniciarlo automáticamente, debo ejecutar los siguientes comandos:\n1 2 $ sudo virsh net-start default $ sudo virsh net-autostart default Puedo comprobar la red de nuevo \u0026hellip;\n1 2 3 4 $ sudo virsh net-list --all Nombre Estado Inicio automático Persistente ---------------------------------------------------------------------------- default activo si si Aparece activa. Ahora puedo encontrarla junto a las demás.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $ ip ad show 1: lo: \u0026lt;LOOPBACK,UP,LOWER_UP\u0026gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: eth0: \u0026lt;NO-CARRIER,BROADCAST,MULTICAST,UP\u0026gt; mtu 1500 qdisc pfifo_fast state DOWN group default qlen 1000 link/ether 94:c6:91:ac:df:b5 brd ff:ff:ff:ff:ff:ff 3: wlan0: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc noqueue state UP group default qlen 1000 link/ether 18:1d:ea:a5:f3:9d brd ff:ff:ff:ff:ff:ff inet 192.168.100.3/24 brd 192.168.100.255 scope global noprefixroute wlan0 valid_lft forever preferred_lft forever inet6 fe80::2eee:2aa7:4f7b:c13c/64 scope link noprefixroute valid_lft forever preferred_lft forever 4: virbr0: \u0026lt;NO-CARRIER,BROADCAST,MULTICAST,UP\u0026gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000 link/ether 52:54:00:89:f3:01 brd ff:ff:ff:ff:ff:ff inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0 valid_lft forever preferred_lft forever Agregando un \u0026ldquo;vhost_net\u0026rdquo; Para mejorar el rendimiento de la transferencia de datos en la red y reducir la carga de virtio-net, se puede agregar un vhost_net en nuestro equipo linux usando el siguiente comando:\n1 $ sudo modprobe vhost_net vhost-net es el backend (lado del host) mientras que virtio-net (lado del invitado) es el frontend que se ejecuta en el espacio del kernel invitado. Para saber más sobre ellos, puedo consultar: Vhost-net y Virtio-networking\nPara comprobar que se ha habilitado ejecuto el comando:\n1 $ lsmod | grep vhost Nota : Este paso no es necesario si no se desea.\nCreando una red puente (opcional) Aunque el KVM viene con una interfaz de red puente llamada “ virbr0 ″ , sin embargo, eso no nos permitirá acceder a la máquina virtual KVM desde la PC host utilizando alguna otra computadora en la red debido al rango de IP asignado. Por lo tanto, se puede crear nuestra propia interfaz de puente completo sobre el nic físico del sistema host que tendrá el rango de IP de nuestra red.\nBusco la interfaz de red física adjunta a mi sistema host que desea utilizar para el puente\n1 $ ip a Veré todas las interfaces de red disponibles en mi máquina host. Anoto el que deseo utilizar para la red Bridge.\nPor ejemplo , aquí tenemos wlan0 y la dirección IP es 192.168.100.3. Por lo tanto, el rango está entre 192.168.100.1-192.168.100.255\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $ ip ad show 1: lo: \u0026lt;LOOPBACK,UP,LOWER_UP\u0026gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: eth0: \u0026lt;NO-CARRIER,BROADCAST,MULTICAST,UP\u0026gt; mtu 1500 qdisc pfifo_fast state DOWN group default qlen 1000 link/ether 94:c6:91:ac:df:b5 brd ff:ff:ff:ff:ff:ff 3: wlan0: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc noqueue state UP group default qlen 1000 link/ether 18:1d:ea:a5:f3:9d brd ff:ff:ff:ff:ff:ff inet 192.168.100.3/24 brd 192.168.100.255 scope global noprefixroute wlan0 valid_lft forever preferred_lft forever inet6 fe80::2eee:2aa7:4f7b:c13c/64 scope link noprefixroute valid_lft forever preferred_lft forever 4: virbr0: \u0026lt;NO-CARRIER,BROADCAST,MULTICAST,UP\u0026gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000 link/ether 52:54:00:89:f3:01 brd ff:ff:ff:ff:ff:ff inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0 valid_lft forever preferred_lft forever Ahora, edito el archivo de interfaz de red :\n1 sudo nano / etc / network / interfaces Agrego las siguientes líneas:\nNota : cambiar los valores según la red de cada cual.\n1 2 3 4 5 6 7 8 9 10 11 12 13 #Configure bridge y dele una ip estática auto virbr0 iface virbr0 inet static address 192.168.0.100 //cambiar netmask 255.255.255.0 network 192.168.0.1 //cambiar broadcast 192.168.0.255 //cambiar gateway 192.168.0.1 //cambiar bridge_ports wlan0 bridge_stp off bridge_fd 0 bridge_maxwait 0 dns-nameservers 8.8.8.8 4.4.2.2 Guardar el archivo pulsando Ctrl + O, y la salida usando Ctrl + X .\nNota : Si desea que el puente obtenga una dirección IP mediante DHCP :\nLuego, en lugar de la configuración anterior, use esta:\n1 2 3 4 5 6 ## DHCP ip config file for virbr0 ## auto virbr0 # Bridge setup iface virbr0 inet dhcp bridge_ports wlan0 Reinicio el administrador de red para aplicar los cambios.\n1 2 3 $ sudo systemctl restart networking.service or $ sudo /etc/init.d/networking restart Verifico la dirección IP\n1 $ ip a Esta vez veré mi interface puente virtbr0 recién creada junto con otras.\nCreando máquinas virtuales usando Virt-Manager GUI Nota: para realizar la creación y ejecución de máquinas virtuales desde la línea de comando con Virt y KVM, simplemente seguiría el enlace anterior.\nDesde el entorno gráfico, Mx-Linux puedo utilizar Virt-Manager.\nEjecuto Virt-Manager Voy al lanzador de aplicaciones, busco “Administrador de máquinas virtuales” (VVM) y lo ejecuto. Antes de que se abra, el sistema me pide que proporcione la contraseña de root. Esto me permite crear y administrar máquinas virtuales.\nCreo una máquina virtual: Hago clic en el icono de la PC para crear una nueva máquina virtual en Virt-Manager usando KVM.\nLocalizo el volumen de medios ISO Hago clic en el botón Examinar y luego ubico el archivo ISO que deseo usar para instalar un sistema operativo en mi máquina virtual como sistema operativo invitado.\nDespués de eso, desmarco la casilla \u0026quot; Detectar automáticamente desde el medio / fuente de instalación \u0026quot; y luego hago clic en el botón Adelante .\nElijo la configuración de memoria y CPU Establezco la cantidad de memoria virtual que deseo asignar a la VM y luego la cantidad de núcleos de CPU.\nCrear imagen de disco virtual Qemu Para instalar el sistema operativo invitado de VM, necesito algo de espacio de almacenamiento y para eso, tengo que crear un archivo de imagen de disco. Simplemente indico la cantidad de espacio en el disco duro que deseo asignar y sigo adelante.\nRed Nombro mi máquina virtual, aquí. Además, de forma predeterminada, Virt-manager usará el NAT , sin embargo, puedo seleccionar la interfaz Bridge, ya sea la predeterminada, es decir , vibr0 , o la que he creado. En caso de duda, seleccionaria la NAT predeterminada.\nMáquina virtual Qemu KVM en Mx-Linux Finalmente, tengo una máquina virtual iniciada que se puede controlar como cualquier computadora física usando un teclado y un mouse.\nNota: para poder utilizar correctamente la consola gráfica de cada máquina virtual debo seleccionar la máquina a ejecutar y hacer clic en el botón Abrir del gestor de máquinas virtuales. Se abre una ventana que muestra los detalles y la consola gráfica de la máquina virtual. En ella elijo el botón (fondo azul con una letra i en blanco) que me permite mostrar los detalles del hardware virtual. Selecciono Monitor VNC y en los detalles elijo en la pestaña Tipo la opción Servidor VCN, en mi caso con la opción Servidor Spice no funciona la consola gráfica.\n","pubDate":"2022-01-17","title":"Virtualizando con KMV libvirt y virt-manager en Mx-linux"},{"link":"https://esaborit.github.io/posts/clonar-proyecto-laravel-desde-github/","plain":"Voy a crear un proyecto con laravel a partir de otro alojado en un repositorio de Github.\nClonación del proyecto Me conecto a mi servidor mediante ssh y me sitúo en la carpeta raíz de mis proyectos laravel. Una vez allí utilizo git para clonar el repositorio\n1 enrique@enrique-server:/var/www/laravel$ git clone https://github.com/coders-free/udemy.git Una vez que termina la clonación abro el proyecto en Visual Studio Code.\nInstalacion de dependencias En el proyecto recién clonado no aparecen ni la carpeta vendors (dependencias de php que necesita laravel para funcionar) ni la carpeta node_modules (dependencias de npm) ni el archivo .env .\nTengo que generar dichas carpetas desde la consola ejecutando el siguiente comando desde dentro de la carpeta principal del proyecto\n1 enrique@enrique-server:/var/www/laravel/blog$ composer install El comando anterior me instala las dependencias de php y me genera la carpeta vendor.\nLo siguiente es instalar todas las dependencias de npm .\n1 enrique@enrique-server:/var/www/laravel/blog$ npm install Continuo creando el archivo .env a partir del archivo .env.example\nUna vez copiado lo debo editar poniendo la APP_URL de mi proyecto, el nombre de a base de datos del proyecto en la variable DB_DATABASE, el usuario DB_USERNAME y la password DB_PASSWORD.\nPara generar la APP_KEY debo ejecutar el siguiente comando desde la terminal.\n1 enrique@enrique-server:/var/www/laravel/blog$ php artisan key:generate Hecho esto el contenido del archivo quedaría como sigue.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ........... APP_NAME=Laravel APP_ENV=local APP_KEY=base64:l+Nh2C7redmnxlKzZl2dcJ1qbtWctJdI3M/2bd4t47g= APP_DEBUG=true APP_URL=http://blog.test LOG_CHANNEL=stack LOG_LEVEL=debug DB_CONNECTION=mysql DB_HOST=127.0.0.1 DB_PORT=3306 DB_DATABASE=blog DB_USERNAME=root DB_PASSWORD=esaborit ........... Falta por generar el acceso directo desde la carpeta public a la carpeta storage . Lo hago desde la consola con el siguiente comando:\n1 enrique@enrique-server:/var/www/laravel/blog$ php artisan storage:link Generación de registros Por último genero todos los registros de prueba.\n1 enrique@enrique-server:/var/www/laravel/blog$ php artisan migrate:fresh --seed Subiendo un proyecto laravel a github Me situo en la carpeta raiz del proyecto que quiero subir e inicio git en ella con el siguiente comando.\n1 enrique@enrique-server:/var/www/laravel/blog$ git init Ejecuto el comando status para saber el estado actual del proyecto. Git nos muestra en rojo los archivos y carpetas que no estan agregados al repositorio.\n1 enrique@enrique-server:/var/www/laravel/blog$ git status Agrego todos los archivos al repositorio con el comando git add .\n1 enrique@enrique-server:/var/www/laravel/blog$ git add . Si ejecutase otrave el comando git status me listaria todos los archivos en verde.\nConfirmo los archivos\n1 enrique@enrique-server:/var/www/laravel/blog$ git commit -m \u0026#34;primer commit\u0026#34; Añado el origen remoto del repositorio en github\n1 2 enrique@enrique-server:/var/www/laravel/blog$ git remote add origin https://github.com/user/repo.git enrique@enrique-server:/var/www/laravel/blog$ git push -u origin master Ingreso los datos de acceso de github y ya está, comienza a subir el proyecto. Una vez acabada la subida se puede consultar en nuestra cuenta de github.\n","pubDate":"2020-12-30","title":"Crear un proyecto laravel desde un repositorio en Github"},{"link":"https://esaborit.github.io/posts/configurando-entorno-de-desarrollo-con-laravel-en-ubuntu-server-20-04/","plain":"Voy a crear una máquina virtual con Ubuntu Server 20.04 en VirtualBox donde instalaré todas las herramientas y servicios necesarios para el entorno de desarrollo con Laravel.\nAccederé a la MV vía ssh desde la línea de comandos de mi equipo anfitrión. Para facilitar la tarea debo establecer una ip estática en la interface del servidor desde la que tendré acceso. para ello arranco la MV con Ubuntu Server\nConfigurar una dirección IP estática en Ubuntu Server 20.04 Para el caso de Ubuntu Server 20.04, es importante anotar que el archivo de configuración de red Netplan por defecto lo encontraré en la ruta /etc/netplan/00-installer-config.yaml.\nPaso 1 Voy a detectar la interfaz de red actual con el comando ip a:\n1 2 3 4 5 6 7 8 9 10 11 12 13 enrique@enrique-server:~$ ip addr 1: lo: \u0026lt;LOOPBACK,UP,LOWER_UP/\u0026gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: enp0s3: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP/\u0026gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000 link/ether 08:00:27:e2:ed:03 brd ff:ff:ff:ff:ff:ff inet 192.168.100.160/24 brd 192.168.100.255 scope global enp0s3 valid_lft forever preferred_lft forever inet6 fe80::a00:27ff:fee2:ed03/64 scope link valid_lft forever preferred_lft forever Paso 2 En este caso el adaptador es “enp0s3” con la dirección IP “192.168.100.160”. Es momento de validar que CloudInit no gestiona la interfaz de red, para ello abriré el archivo de configuración con mi editor habitual:\n1 enrique@enrique-server:~$ sudo nano /etc/cloud/cloud.cfg.d/subiquity-disable-cloudinit-networking.cfg Paso 3 Allí debo validar que existe la siguiente línea, si no está la debo ingresar manualmente:\n1 network: {config: disabled} 1 2 3 4 5 6 7 8 9 10 11 12 GNU nano 4.8 /etc/cloud/cloud.cfg.d/subiquity-disable-cloudinit-networking.cfg network: {config: disabled} [ File \u0026#39;/etc/cloud/cloud.cfg.d/subiquity-disable-cloudinit-networking.cfg\u0026#39; is unwritable ] ^G Get Help ^O Write Out ^W Where Is ^K Cut Text ^J Justify ^C Cur Pos M-U Undo ^X Exit ^R Read File ^\\ Replace ^U Paste Text ^T To Spell ^_ Go To Line M-E Redo Paso 4 Guardo los cambios si aplica y luego de esto abriré el archivo de configuración Netplan con la siguiente orden. Allí verifico que el adaptador de red posea el protocolo dhcp en estado “true, esto significa que usar DNS para las direcciones IP.\n1 enrique@enrique-server:~$ nano /etc/netplan/00-installer-config.yaml Paso 5 Debo borrar estas líneas e ingresar las siguientes con los datos deseados:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 GNU nano 4.8 /etc/netplan/00-installer-config.yaml # This is the network config written by \u0026#39;subiquity\u0026#39; network: ethernets: enp0s3: addresses: [192.168.100.160/24] gateway4: 192.168.100.11 nameservers: addresses: [192.168.100.11, 8.8.8.8] version: 2 [ File \u0026#39;/etc/netplan/00-installer-config.yaml\u0026#39; is unwritable ] ^G Get Help ^O Write Out ^W Where Is ^K Cut Text ^J Justify ^C Cur Pos M-U Undo ^X Exit ^R Read File ^\\ Replace ^U Paste Text ^T To Spell ^_ Go To Line M-E Redo Paso 6 Guardo los cambios usando la combinación de teclas siguiente:\nCtrl + O\nSalo del editor usando:\nCtrl + X\nPaso 7 Compruebo que no existen errores con el siguiente comando:\n1 enrique@enrique-server:~$ sudo netplan try Paso 8 Si todo es correcto aplico los cambios con el siguiente comando:\n1 enrique@enrique-server:~$ sudo netplan apply Paso 9 Reinicio el sistema para completar el proceso de cambio:\n1 enrique@enrique-server:~$ sudo reboot Una vez iniciemos sesión ejecuto de nuevo el comando “ip a” para comprobar que los cambios realizados en la red han sido aplicados de forma correcta. Allí veré la nueva IP establecida.\nAcceso remoto via ssh a Ubuntu Server 20.04 Lo siguiente para poder acceder desde mi pc es instalar el servidor ssh openssh en la máquina virtual con Ubuntu.\n1 enrique@enrique-server:~$ sudo apt-get install ssh y compruebo su estado.\n1 2 3 4 5 6 7 8 9 10 11 12 13 enrique@enrique-server:~$ systemctl status ssh.service ● ssh.service - OpenBSD Secure Shell server Loaded: loaded (/lib/systemd/system/ssh.service; enabled; vendor preset: enab Active: active (running) since Sun 2020-05-31 13:31:34 BST; 18min ago Process: 523 ExecStartPre=/usr/sbin/sshd -t (code=exited, status=0/SUCCESS) Main PID: 525 (sshd) Tasks: 5 (limit: 4915) CGroup: /system.slice/ssh.service ├─525 /usr/sbin/sshd -D ├─555 sshd: root@pts/0 ├─569 -bash ├─860 systemctl status ssh.service └─861 systemctl status ssh.service Todo está correcto, ya puedo habrir una terminal desde mi equipo anfitrión y conectarme vía ssh por el puerto 22 a mi servidor virtualizado. Como es un entorno de desarrollo no cambio más en el servidor ssh, pero quiero recordar que por seguridad en producción se debería haber cambiando el puerto de escucha por defecto, prohibir el cceso de root, etc, todo ello editando el archivo de configuración sshd_config.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 enrique@enrique-server:~$ sudo nano /etc/ssh/sshd_config # $OpenBSD: sshd_config,v 1.101 2017/03/14 07:19:07 djm Exp $ # This is the sshd server system-wide configuration file. See # sshd_config(5) for more information. # This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin # The strategy used for options in the default sshd_config shipped with # OpenSSH is to specify options with their default value where # possible, but leave them commented. Uncommented options override the # default value. #Port 22 #AddressFamily any #ListenAddress 0.0.0.0 #ListenAddress :: #HostKey /etc/ssh/ssh_host_rsa_key #HostKey /etc/ssh/ssh_host_ecdsa_key #HostKey /etc/ssh/ssh_host_ed25519_key # Ciphers and keying #RekeyLimit default none Como dije anteriormente abro una consola en mi equipo anfitrion y tecleo ssh enrique@192.168.100.160, intruzco mi contraseña y ya estoy dentro:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 enrique@asuspc:~$ ssh enrique@192.168.100.160 enrique@192.168.100.160´s password: Welcome to Ubuntu 20.04.1 LTS (GNU/Linux 5.4.0-52-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Thu Nov 5 09:59:26 UTC 2020 System load: 0.37 Processes: 115 Usage of /: 23.4% of 18.57GB Users logged in: 0 Memory usage: 10% IPv4 address for enp0s3: 192.168.100.160 Swap usage: 0% 64 updates can be installed immediately. 0 of these updates are security updates. To see these additional updates run: apt list --upgradable Last login: Wed Nov 4 18:54:04 2020 from 192.168.100.136 enrique@enrique-server:~$ Prerequisitos a la instalación de Laravel Laravel es un marco PHP gratuito y de código abierto que implementa el patrón de diseño MVC (Model-View-Controller). Taylor Otwell lo creó en 2011 como un intento de proporcionar una alternativa avanzada al marco CodeIgniter (CI). En 2011, Laravel lanzó la versión 1 y la versión 2. La última versión 8.x viene con más características mejoradas como esquema de versiones, política de soporte, etiquetas y mejoras de componentes Blade, operaciones de cadenas fluidas, mejoras de enlace del modelo de ruta, etc.\nLo ideal a la hora de trabajar con Laravel en local es instalar su máquina virtual, Laravel Homestead, que viene lista para el desarrollo de proyectos con Laravel y otras tecnologías de PHP como Symfony y Statamic. Al ser una máquina virtual nos va a permitir ejecutar nuestros proyectos sin necesidad de instalar PHP, MySQL, etc. Cuando se tiene experiancia tanto en desarrollo como en producción con laravel, esta opción es la más cómoda. En mi caso no es la que usaré. Estoy aprendiendo a desarrollar con Laravel y quiero aprender lo mas posible al entorno de desarrollo y producción de este ecosistema. Por lo tanto debo de preocuparme de cumplir los prerequisitos necesarios en la instalacion. Mirando en la página de laravel encuentro que son los siguientes:\nApache / Nginx MySQL / MariaDB PHP \u0026gt;= 7.3 BCMath PHP Extension Ctype PHP Extension Fileinfo PHP Extension JSON PHP Extension Mbstring PHP Extension OpenSSL PHP Extension PDO PHP Extension Tokenizer PHP Extension XML PHP Extension 1 Instalar el servidor web Apache Primero, instalaré el servidor web Apache en el sistema Ubuntu 20.04 y configuraré el firewall UFW que solo permite conexiones entrantes para algunos servicios, incluidos SSH, HTTP y HTTPS.\nActualico todos los repositorios disponibles en el sistema e instalo el servidor web Apache.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 enrique@enrique-server:~$ sudo apt update nrique@enrique-server:~$ sudo apt-get install apache2 [sudo] password for enrique: Reading package lists... Done Building dependency tree Reading state information... Done The following additional packages will be installed: apache2-bin apache2-data apache2-utils libapr1 libaprutil1 libaprutil1-dbd-sqlite3 libaprutil1-ldap libjansson4 liblua5.2-0 ssl-cert Suggested packages: apache2-doc apache2-suexec-pristine | apache2-suexec-custom www-browser openssl-blacklist The following NEW packages will be installed: apache2 apache2-bin apache2-data apache2-utils libapr1 libaprutil1 libaprutil1-dbd-sqlite3 libaprutil1-ldap libjansson4 liblua5.2-0 ssl-cert 0 upgraded, 11 newly installed, 0 to remove and 3 not upgraded. Need to get 1865 kB of archives. After this operation, 8080 kB of additional disk space will be used. Do you want to continue? [Y/n] Una vez completada la instalación, inicio el servicio Apache y lo agréguo al inicio del sistema.\n1 2 enrique@enrique-server:~$ sudo systemctl start apache2 enrique@enrique-server:~$ sudo systemctl enable apache2 Ahora verifico el estado del servicio Apache usando el siguiente comando.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 enrique@enrique-server:~$ sudo systemctl status apache2 ● apache2.service - The Apache HTTP Server Loaded: loaded (/lib/systemd/system/apache2.service; enabled; vendor preset: enabled) Active: active (running) since Thu 2020-11-05 11:12:19 UTC; 2min 23s ago Docs: https://httpd.apache.org/docs/2.4/ Main PID: 19476 (apache2) Tasks: 55 (limit: 2282) Memory: 5.1M CGroup: /system.slice/apache2.service ├─19476 /usr/sbin/apache2 -k start ├─19478 /usr/sbin/apache2 -k start └─19479 /usr/sbin/apache2 -k start Nov 05 11:12:19 enrique-server systemd[1]: Starting The Apache HTTP Server... Nov 05 11:12:19 enrique-server apachectl[19475]: AH00558: apache2: Could not reliably determine t\u0026gt; Nov 05 11:12:19 enrique-server systemd[1]: Started The Apache HTTP Server. lines 1-15/15 (END) Como resultado, el servicio Apache está en funcionamiento.\nLuego, agreguo los servicios SSH, HTTP y HTTPS al firewall UFW usando el siguiente comando.\n1 2 3 4 for svc in ssh http https do ufw allow $svc done Ahora habilito los servicios de firewall de UFW.\n1 sudo ufw enable Escribo \u0026rsquo; y \u0026rsquo; para continuar y se habrá habilitado el firewall UFW. A continuación, abro su navegador web y escriba la dirección IP de su servidor en la barra de direcciones. http://10.5.5.25/ Y obtengo la página index.html predeterminada de Apache.\nComo resultado, puedo afirmar que se completaron correctamente la instalación del servidor web Apache y la configuración del firewall UFW.\n2 Instalar y configurar PHP 7.4 En este paso, instalaremos y configuraremos PHP 7.4 para nuestra instalación de Laravel. Para instalar Laravel 8.x, al menos debe tener PHP\u0026gt; = 7.2.5 en su sistema. Y, de forma predeterminada, el repositorio oficial de Ubuntu 20.04 proporciona paquetes PHP 7.4.\nInstalé paquetes PHP 7.4 usando el comando apt .\n1 sudo apt install libapache2-mod-php php php-common php-mysql php-xml php-gd php-opcache php-mbstring php-tokenizer php-json php-bcmath php-zip unzip 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 enrique@enrique-server:~$ sudo apt install libapache2-mod-php php php-common php-mysql php-xml php-gd php-opcache php-mbstring php-tokenizer php-json php-bcmath php-zip unzip [sudo] password for enrique: Reading package lists... Done Building dependency tree Reading state information... Done Note, selecting \u0026#39;php7.4-opcache\u0026#39; instead of \u0026#39;php-opcache\u0026#39; The following additional packages will be installed: fontconfig-config fonts-dejavu-core libapache2-mod-php7.4 libfontconfig1 libgd3 libjbig0 libjpeg-turbo8 libjpeg8 libonig5 libtiff5 libwebp6 libxpm4 libzip5 php7.4 php7.4-bcmath php7.4-cli php7.4-common php7.4-gd php7.4-json php7.4-mbstring php7.4-readline php7.4-xml php7.4-zip Suggested packages: php-pear libgd-tools zip The following NEW packages will be installed: fontconfig-config fonts-dejavu-core libapache2-mod-php libapache2-mod-php7.4 libfontconfig1 libgd3 libjbig0 libjpeg-turbo8 libjpeg8 libonig5 libtiff5 libwebp6 libxpm4 libzip5 php php-bcmath php-common php-gd php-json php-mbstring php-tokenizer php-xml php-zip php7.4 php7.4-bcmath php7.4-cli php7.4-common php7.4-gd php7.4-json php7.4-mbstring php7.4-opcache php7.4-readline php7.4-xml php7.4-zip unzip 0 upgraded, 35 newly installed, 0 to remove and 3 not upgraded. Need to get 6785 kB of archives. After this operation, 27.0 MB of additional disk space will be used. Do you want to continue? [Y/n] Una vez completada toda la instalación, voy al directorio /etc/php/7.4/ y edito la configuración de php.ini para el servidor web Apache2.\n1 2 cd /etc/php/7.4/ nano apache2/php.ini Descomento la opción \u0026lsquo;cgi.fix_pathinfo\u0026rsquo; y cambio el valor a \u0026lsquo;0\u0026rsquo;, cgi.fix_pathinfo=0\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 GNU nano 4.8 apache2/php.ini Modified ; every request. PHP\u0026#39;s default behavior is to disable this feature. ;cgi.nph = 1 ; if cgi.force_redirect is turned on, and you are not running under Apache or Netscape ; (iPlanet) web servers, you MAY need to set an environment variable name that PHP ; will look for to know it is OK to continue execution. Setting this variable MAY ; cause security issues, KNOW WHAT YOU ARE DOING FIRST. ; http://php.net/cgi.redirect-status-env ;cgi.redirect_status_env = ; cgi.fix_pathinfo provides *real* PATH_INFO/PATH_TRANSLATED support for CGI. PHP\u0026#39;s ; previous behaviour was to set PATH_TRANSLATED to SCRIPT_FILENAME, and to not grok ; what PATH_INFO is. For more information on PATH_INFO, see the cgi specs. Setting ; this to 1 will cause PHP CGI to fix its paths to conform to the spec. A setting ; of zero causes PHP to behave as before. Default is 1. You should fix your scripts ; to use SCRIPT_FILENAME rather than PATH_TRANSLATED. ; http://php.net/cgi.fix-pathinfo ;cgi.fix_pathinfo=1 cgi.fix_pathinfo=0 ^G Get Help ^O Write Out ^W Where Is ^K Cut Text ^J Justify ^C Cur Pos ^X Exit ^R Read File ^\\ Replace ^U Paste Text ^T To Spell ^_ Go To Line Guardar y cerrar.\nA continuación, reinicio el servicio Apache para aplicar la nueva configuración \u0026lsquo;php.ini\u0026rsquo;.\n1 enrique@enrique-server:~$ sudo systemctl restart apache2 Como resultado, la configuración básica de PHP 7.4 se ha completado con éxito.\n3 Instalar la administración de paquetes PHP de Composer Composer es un administrador de dependencias para PHP. Es un administrador de paquetes a nivel de aplicación para PHP que le permite descargar bibliotecas y dependencias PHP adicionales a su proyecto PHP.\nEn este tutorial, usaré Composer para instalar Laravel e instalaré Composer descargando el archivo binario desde el sitio web oficial de Composer.\nDescargué el archivo binario del Composer y lo muevo al directorio / usr / local / bin.\n1 2 3 4 5 6 7 8 enrique@enrique-server:~$ sudo curl -sS https://getcomposer.org/installer | php All settings correct for using Composer Downloading... Composer (version 2.0.4) successfully installed to: /home/enrique/composer.phar Use it: php composer.phar enrique@enrique-server:~$ sudo mv composer.phar /usr/local/bin/composer Después de eso, verifico la versión de Composer usando el siguiente comando.\n1 2 enrique@enrique-server:~$ composer --version Composer version 2.0.4 2020-10-30 22:39:11 4 Instalar servidor MySQL Los paquetes del servidor MySQL 8.0 están disponibles en los repositorios predeterminados en Ubuntu 20.04. Después de iniciar sesión en su servidor, actualice apt cache y ejecute los paquetes de instalación. Para instalar el tipo de servidor MySQL:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 enrique@enrique-server:~$ sudo apt-get install mysql-server [sudo] password for enrique: Reading package lists... Done Building dependency tree Reading state information... Done The following additional packages will be installed: libcgi-fast-perl libcgi-pm-perl libencode-locale-perl libevent-core-2.1-7 libevent-pthreads-2.1-7 libfcgi-perl libhtml-parser-perl libhtml-tagset-perl libhtml-template-perl libhttp-date-perl libhttp-message-perl libio-html-perl liblwp-mediatypes-perl libmecab2 libtimedate-perl liburi-perl mecab-ipadic mecab-ipadic-utf8 mecab-utils mysql-client-8.0 mysql-client-core-8.0 mysql-common mysql-server-8.0 mysql-server-core-8.0 Suggested packages: libdata-dump-perl libipc-sharedcache-perl libwww-perl mailx tinyca The following NEW packages will be installed: libcgi-fast-perl libcgi-pm-perl libencode-locale-perl libevent-core-2.1-7 libevent-pthreads-2.1-7 libfcgi-perl libhtml-parser-perl libhtml-tagset-perl libhtml-template-perl libhttp-date-perl libhttp-message-perl libio-html-perl liblwp-mediatypes-perl libmecab2 libtimedate-perl liburi-perl mecab-ipadic mecab-ipadic-utf8 mecab-utils mysql-client-8.0 mysql-client-core-8.0 mysql-common mysql-server mysql-server-8.0 mysql-server-core-8.0 0 upgraded, 25 newly installed, 0 to remove and 3 not upgraded. Need to get 30.7 MB of archives. After this operation, 249 MB of additional disk space will be used. Do you want to continue? [Y/n] Espero a que el administrador de paquetes complete la instalación. Después de finalizar la instalación, el servicio MySQL se iniciará automáticamente. Para comprobar el tipo de estado del servicio:\n1 2 3 4 5 6 7 8 9 10 11 12 13 enrique@enrique-server:~$ sudo systemctl status mysql ● mysql.service - MySQL Community Server Loaded: loaded (/lib/systemd/system/mysql.service; enabled; vendor preset: enabled) Active: active (running) since Thu 2020-11-05 21:06:59 UTC; 1min 18s ago Main PID: 1767 (mysqld) Status: \u0026#34;Server is operational\u0026#34; Tasks: 37 (limit: 2282) Memory: 331.8M CGroup: /system.slice/mysql.service └─1767 /usr/sbin/mysqld Nov 05 21:06:54 enrique-server systemd[1]: Starting MySQL Community Server... Nov 05 21:06:59 enrique-server systemd[1]: Started MySQL Community Server. 5 Asegurando el servidor mysql En esta etapa, el servidor MySQL aún no está protegido. Puede cambiar al usuario root de su sistema y conectarse al servidor MySQL. No solicitará ninguna contraseña.\nEntonces, aquí necesito asegurar el servidor MySQL. Los paquetes proporcionan un script para hacerlo. Ejecuto el siguiente comando para la configuración inicial de mi servidor MySQL. El script solicitará más configuraciones que las versiones anteriores de MySQL, como la política de validación de contraseña, etc.\n1 enrique@enrique-server:~$ sudo mysql_secure_installation Sigo las instrucciones en pantalla para finalizar el asistente. Todas las entradas del usuario están resaltadas en el asistente a continuación. Esto creará una contraseña para el usuario raíz, eliminará la base de datos de prueba y el usuario para proteger el servidor de la base de datos.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 enrique@enrique-server:~$ sudo mysql_secure_installation Securing the MySQL server deployment. Connecting to MySQL using a blank password. VALIDATE PASSWORD COMPONENT can be used to test passwords and improve security. It checks the strength of password and allows the users to set only those passwords which are secure enough. Would you like to setup VALIDATE PASSWORD component? Press y|Y for Yes, any other key for No: y There are three levels of password validation policy: LOW Length \u0026gt;= 8 MEDIUM Length \u0026gt;= 8, numeric, mixed case, and special characters STRONG Length \u0026gt;= 8, numeric, mixed case, special characters and dictionary file Please enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: 0 Please set the password for root here. New password: esaborit Re-enter new password: esaborit Estimated strength of the password: 50 Do you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : y By default, a MySQL installation has an anonymous user, allowing anyone to log into MySQL without having to have a user account created for them. This is intended only for testing, and to make the installation go a bit smoother. You should remove them before moving into a production environment. Remove anonymous users? (Press y|Y for Yes, any other key for No) : y Success. Normally, root should only be allowed to connect from \u0026#39;localhost\u0026#39;. This ensures that someone cannot guess at the root password from the network. Disallow root login remotely? (Press y|Y for Yes, any other key for No) : y Success. By default, MySQL comes with a database named \u0026#39;test\u0026#39; that anyone can access. This is also intended only for testing, and should be removed before moving into a production environment. Remove test database and access to it? (Press y|Y for Yes, any other key for No) : y - Dropping test database... Success. - Removing privileges on test database... Success. Reloading the privilege tables will ensure that all changes made so far will take effect immediately. Reload privilege tables now? (Press y|Y for Yes, any other key for No) : y Success. All done! 6 Administrando el servidor MySQL El servicio MySQL se administra bajo el administrador de servicios systemd. Puedo usar los comandos systemctl predeterminados para administrar el servicio de base de datos en la línea de comandos. A continuación se muestran algunos comandos de uso frecuente para administrar el servicio:\nPara detener el servicio MySQL, escriba: sudo systemctl detener mysql Para iniciar el servicio MySQL, escriba: sudo systemctl iniciar mysql Deténgase y luego inicie el servicio MySQL, escriba: sudo systemctl reiniciar mysql Para ver el estado del servicio MySQL, escriba: sudo systemctl estado mysql 7 Conectandome al servidor MySQL He instalado y asegurado correctamente el servidor de base de datos MySQL en mi sistema Ubuntu 20.04. Ahora me conecto a mi servidor de base de datos en la línea de comandos con el siguiente comando.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 enrique@enrique-server:~$ mysql -u root -p Enter password: Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 14 Server version: 8.0.22-0ubuntu0.20.04.2 (Ubuntu) Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type \u0026#39;help;\u0026#39; or \u0026#39;\\h\u0026#39; for help. Type \u0026#39;\\c\u0026#39; to clear the current input statement. mysql\u0026gt; Nota: Cuando instala MySQL e intenta acceder a él en la máquina local con el usuario root , el comando que usa es:mysql -u root -p. En la mayoría de los casos, recibirá el mensaje de error: ERROR 1698 (28000): Access denied for user \u0026lsquo;root\u0026rsquo;@\u0026rsquo;localhost\u0026rsquo;. Para poder iniciar sesión en MySQL como root, primero use sudo para modificar el usuario root:sudo mysql. Utilice el comando ALTER USER y cambie el método de autenticación para iniciar sesión en MySQL como root : ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'esaborit';\nYa puedo entrar como root.\n8 Creo un usuario y una base de datos MySQL para mi proyecto en Laravel Como me he conectado al servidor MySQL en la línea de comandos. El servidor de base de datos está listo para que sus aplicaciones almacenen datos.\nCrearé un usuario de base de datos independiente para conectar la base de datos mediante la aplicación. Utilice los siguientes comandos para crear una base de datos en MySQL. Luego crearé un usuario y le asignaré privilegios en la base de datos.\n1 2 3 4 5 6 7 8 9 10 11 mysql\u0026gt; CREATE DATABASE laravel_proyecto1; Query OK, 1 row affected (0.46 sec) mysql\u0026gt; CREATE USER \u0026#39;laraveluser\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED BY \u0026#39;Laravel_user1\u0026#39;; Query OK, 0 rows affected (0.37 sec) mysql\u0026gt; GRANT ALL PRIVILEGES ON laravel_proyecto1.* TO \u0026#39;laraveluser\u0026#39;@\u0026#39;localhost\u0026#39;; Query OK, 0 rows affected (0.29 sec) mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 0 rows affected (0.15 sec) Instalación de Laravel 8.x en Ubuntu 20.04 Para este paso, voy a describir dos formas diferentes de instalar el marco web de Laravel. Instalaré Laravel a través del Instalador de Laravel y a través de Composer. Esta sección instalará el marco web de Laravel con el usuario no root llamado \u0026rsquo;enrique\u0026rsquo;.\nNota: En mi caso el usuario ya existe y si tiene privilegios de sudo que no utilizo para instalar laravel Se puede agregar el usuario y configurar su contraseña usando el siguiente comando.\n1 2 useradd -m -s /bin/bash enrique passwd enrique Después de eso, inicie sesión con el usuario \u0026rsquo;enrique\u0026rsquo;.\n1 su - enrique 1 Instalando Laravel Via Composer create-project Una forma de instalar el marco web de Laravel es mediante la gestión de paquetes PHP de Composer. Para instalar Laravel, me dirijo al directorio \u0026ldquo;proyectos_laravel\u0026rdquo; que he creado en mi directorio personal. Como estamos en Ubuntu y usando Apache,otra opción poría ser instalarlo en el directorio /var/www/laravel. Pero voy a usar Visual Studio como IDE de desarrollo y accederé vía ssh al servidor con Ubuntu y me resulta mas cómodo trabajar desde mi directorio personal.\n1 2 enrique@enrique-server:~$ cd /home/proyectos_laravel/ enrique@enrique-server:/var/www/laravel$ sudo composer create-project --prefer-dist laravel/laravel prueba1 El comando anterior creará el directorio «prueba1» con la instalación de Laravel. Composer usa git para descargar e instalar todos los paquetes y módulos que Laravel requiere para funcionar.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 enrique@enrique-server:~/proyectos_laravel$ composer create-project --prefer-dist laravel/laravel prueba1 Creating a \u0026#34;laravel/laravel\u0026#34; project at \u0026#34;./prueba1\u0026#34; Installing laravel/laravel (v8.4.0) - Downloading laravel/laravel (v8.4.0) - Installing laravel/laravel (v8.4.0): Extracting archive Created project in /home/enrique/proyectos_laravel/prueba1 \u0026gt; @php -r \u0026#34;file_exists(\u0026#39;.env\u0026#39;) || copy(\u0026#39;.env.example\u0026#39;, \u0026#39;.env\u0026#39;);\u0026#34; Loading composer repositories with package information Updating dependencies Lock file operations: 104 installs, 0 updates, 0 removals - Locking asm89/stack-cors (v2.0.2) - Locking brick/math (0.9.1) - Locking dnoegel/php-xdg-base-dir (v0.1.1) - Locking doctrine/inflector (2.0.3) - Locking doctrine/instantiator (1.3.1) - Locking doctrine/lexer (1.2.1) - Locking dragonmantank/cron-expression (v3.0.2) ......... A continuación, cambie la propiedad del directorio del proyecto \u0026lsquo;prueba1\u0026rsquo; al usuario \u0026lsquo;www-data\u0026rsquo; y haga que se pueda escribir en el directorio \u0026lsquo;storage\u0026rsquo;.\n1 2 enrique@enrique-server:~$ sudo chown -R www-data:www-data /home/enrique/proyectos_laravel/prueba1 enrique@enrique-server:~$ sudo chmod -R 775 /home/enrique/proyectos_laravel/prueba1/storage Como resultado, ha instalado el marco web de Laravel usando el comando Composer.\n1.2 Configuracion de Apache para el proyecto prueba1 en Laravel En este paso, configuraremos el host virtual Apache para el proyecto prueba1.\nAhora voy al directorio \u0026lsquo;/etc/apache/sites-available\u0026rsquo; y creo con el editor nano una nueva configuración de host virtual llamada \u0026lsquo;prueba1.conf\u0026rsquo;.\n1 2 cd /etc/apache2/sites-available/ sudo nano prueba1.conf Cambio el nombre de dominio y el directorio root por el mio y peguo la configuración en él.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026lt;VirtualHost *:80\u0026gt; ServerName prueba1.com ServerAdmin admin@prueba1.com DocumentRoot /home/enrique/proyectos_laravel/prueba1/public \u0026lt;Directory /home/enrique/proyectos_laravel/prueba1/\u0026gt; Options Indexes FollowSymLinks MultiViews AllowOverride All Order Allow,Deny Allow from all Require all granted \u0026lt;/Directory\u0026gt; ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined \u0026lt;/VirtualHost\u0026gt; \u0026lt;VirtualHost *:80\u0026gt; ServerName proyectolaravel_1.com ServerAdmin admin@proyectolaravel_1.com DocumentRoot /var/www/laravel/proyectolaravel_1/public \u0026lt;Directory /var/www/laravel/proyectolaravel_1/\u0026gt; Options Indexes FollowSymLinks MultiViews AllowOverride All Order Allow,Deny Allow from all Require all granted \u0026lt;/Directory\u0026gt; ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined \u0026lt;/VirtualHost\u0026gt; Guardar y cerrar.\nA continuación, activo el módulo de reescritura de Apache y la configuración del host virtual de Laravel usando el siguiente comando.\n1 2 sudo a2enmod rewrite sudo a2ensite laravel.conf Después de eso, pruebo la configuración de Apache, asegúrese de que no haya ningún error y reinicie el servicio Apache.\n1 2 apachectl configtest systemctl restart apache2 Con esto, completo la configuración del host virtual Apache para Laravel. Puedo acceder a prueba1.com desde un navegador web de mi pc anfitrión con solo modificar el hosts.\n2 Instalando Laravel con su instalador Hay una alternativa para instalar Laravel y es con su instalador, que también es un paquete, por tanto, también usaremos Composer para instalarlo de forma global con el comando:\n1 enrique@enrique-server:~$ composer global require \u0026#34;laravel/installer\u0026#34; Luego, nos tenemos que asegurar que la variable de entorno PATH del sistema operativo tenga incluido el directorio donde se alojan los paquetes instalados globalmente y así se puedan ejecutar sin ningún problema, para ello debemos agregar su ruta:\nPara MacOs y Linux la variable PATH la podemos definir en ~/.bashrc o ~/.bash_profile:\n1 enrique@enrique-server:~$ sudo nano ~/.bashrc donde la ruta a añadir al final de lo que tiene asignado la variable es:\n1 export PATH=\u0026#34;$HOME/.config/composer/vendor/bin:$PATH\u0026#34; Para Windows debes modificar la variable de entorno PATH para agregar la ruta\n1 ;C:\\Users\\tu-usuario\\AppData\\Roaming\\Composer\\vendor\\bin Ahora cargo la nueva versión de la configuración ~ / .bashrc y verifico la variable de entorno $ PATH. A continuación se muestra el resultado que obtendrá.\n1 2 3 enrique@enrique-server:~$ source ~/.bashrc enrique@enrique-server:~$ echo $PATH /home/enrique/.config/composer/vendor/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin Bien, de esta manera ya tenemos disponible el instalador de Laravel, por tanto, podemos ejecutar desde cualquier directorio:\n1 laravel new nombre-proyecto y se instalará tal y como se hizo con el comando composer create-project.\nAccesibilidad del proyecto laravel desde APACHE Para que el servidor web Apache acceda al directorio de su proyecto de Laravel, cambie el propietario del grupo del directorio del proyecto al grupo \u0026lsquo;www-data\u0026rsquo; y haga que el directorio de \u0026lsquo;almacenamiento\u0026rsquo; se pueda escribir.\n1 2 enrique@enrique-server:~$ sudo chgrp -R www-data /var/www/laravel/blog enrique@enrique-server:~$ sudo chmod -R 775 /var/www/laravel/blog/storage El proyecto está listo para configurar el host virtual Apache para su proyecto Laravel.\nCómo configurar una identificación de grupo en un directorio:\n1 chmod 2775 /var/www El 2 delante de 775 hace que el grupo que es el propietario de /var/www se copie en todos los archivos/carpetas nuevos creados en ese directorio.\nTambién hay otras opciones además de 2:\n0: setuid, setgid, sticky bits are unset\n1: sticky bit is in place\n2: setgid bit is in place\n3: setgid and sticky bits are in place\n4: setuid bit is in place\n5: setuid and sticky bits are in place\n6: setuid and setgid bits are on\n7: setuid, setgid, sticky bits are activated\nBorrando la cache de la aplicación Almacenamiento en caché de configuración\nLa configuración de laravel se extiende a través de docenas de archivos, e including cada uno de ellos para cada solicitud es un proceso costoso. Para combinar todos tus archivos de configuración en uno.\n1 php artisan config:cache Tenga en cuenta que cualquier cambio en la configuración no tendrá ningún efecto una vez que lo haya almacenado en caché. Para actualizar la caché de configuración, vuelva a ejecutar el comando anterior. En caso de que quiera deshacerse completamente de la caché de configuración, ejecute 1\n1 php artisan config:clear Enrutamiento de caché de rutas\nEl enrutamiento también es una tarea costosa en laravel. Para almacenar en caché el archivo routes.php, ejecute el siguiente comando: 1\n1 php artisan route:cache Tenga en cuenta que no funciona con cierres. En caso de que esté utilizando cierres, esta es una gran oportunidad para moverlos a un controlador, ya que el comando artesanal arrojará una excepción cuando intente comstackr rutas que estén unidas a cierres en lugar de a un método de control adecuado. Al igual que la caché de configuración, cualquier cambio en routes.php ya no tendrá ningún efecto. Para actualizar la memoria caché, ejecute el comando anterior cada vez que realice un cambio en el archivo de rutas. Para deshacerse completamente de la caché de ruta, ejecute el siguiente comando: 1\n1 php artisan route:clear Optimización de Classmap\nNo es raro que un proyecto de tamaño mediano se extienda a través de cientos de archivos PHP. Como los buenos comportamientos de encoding nos dictan, todo tiene su propio archivo. Esto, por supuesto, no viene sin inconvenientes. Laravel tiene que incluir docenas de archivos diferentes para cada solicitud, lo cual es una tarea costosa.\nPor lo tanto, un buen método de optimización es declarar qué archivos se utilizan para cada solicitud (esto es, por ejemplo, todos sus proveedores de servicios, middleware y algunos más) y combinarlos en un solo archivo, que luego se cargará para cada solicitud. Esto no es diferente de combinar todos tus archivos javascript en uno, por lo que el navegador tendrá que hacer menos solicitudes al servidor.\nLos archivos de comstackción adicionales (una vez más: proveedores de servicios, middleware, etc.) deben ser declarados por usted en config / compile.php, en la clave de archivos. Una vez que coloque allí todo lo esencial para cada solicitud hecha a su aplicación, concatenarlos en un archivo con: 1\n1 php artisan optimize --force Optimizar la autocarga del compositor\nEste no es solo para laravel, sino para cualquier aplicación que esté haciendo uso del compositor.\nPrimero explicaré cómo funciona la carga automática del PSR-4, y luego le mostraré qué comando debe ejecutar para optimizarlo. Si no está interesado en saber cómo funciona el compositor, le recomiendo que salte directamente al comando de la consola.\nCuando le pides a compsoser la clase App\\Controllers\\AuthController, primero busca una asociación directa en el mapa de clases. El mapa de clases es una matriz con asociaciones de clases y archivos de 1 a 1. Como, por supuesto, no agregó manualmente la clase de inicio de sesión y su archivo asociado al mapa de clases, el compositor continuará y buscará en los espacios de nombres. Como App es un espacio de nombres PSR-4, que viene por defecto con Laravel y está asociado a la aplicación/carpeta, el compositor intentará convertir el nombre de la clase PSR-4 en un nombre de archivo con procedimientos básicos de manipulación de cadenas. Al final, adivina que App\\Controllers\\AuthController debe estar ubicado en un archivo AuthController.php, que se encuentra en una carpeta de Controladores que afortunadamente debe estar en la carpeta del espacio de nombres, que es la aplicación /.\nTodo este trabajo duro solo para conseguir que la clase App\\Controllers\\AuthController exista en el archivo app/Controllers/AuthController.php. Para que el compositor explore toda la aplicación y cree asociaciones directas de clases y archivos de 1 a 1, ejecute el siguiente comando:\n1 composer dumpautoload -o Tenga en cuenta que si ya ejecutó php artisan optimize –force, ya no tiene que ejecutar este. Dado que el comando de optimización ya le dice al compositor que cree una carga automática optimizada.\nClear Cache: 1 php artisan cache:clear Clear Route Cache: 1 php artisan route:cache Clear View Cache: 1 php artisan view:clear Clear Config Cache: 1 php artisan config:cache You can also clear cache without command using route. so you can create route as like bellow:\n1 2 3 4 5 Route::get(\u0026#39;/clear-cache-all\u0026#39;, function() { Artisan::call(\u0026#39;cache:clear\u0026#39;); dd(\u0026#34;Cache Clear All\u0026#34;); }); ","pubDate":"2020-12-29","title":"Configuración de un entorno de desarrollo con Laravel en Ubuntu Server 20.04"},{"link":"https://esaborit.github.io/posts/recursos-compartidos-debian-buster/","plain":"Ya que tengo un pequeño servidor casero lo voy a aprovechar para conectar a el los discos duros donde guardamos copias simples de los datos de los ordenadores de casa y las copias de seguridad.\nEn un principios todos los ordenadores que tendrán acceso a los recursos compartidos utilizan como S.O. GNU/Linux pero no quiero cerrar el acceso a un posible uso por parte de usuarios con equipos Windows por lo que utilizaré Samba como implementación de código abierto del protocolo de red SMB/CIFS para montar un servidor Samba independiente.\nRequisitos de usuarios y recursos a cumplir: Cada usuario tendrá al menos una carpeta compartida personal y privada; Todos los usuarios deben tener acceso de lectura y escritura a un recurso compartido de archivos común; Existirá un usuario administrador con acceso de lectura y escritura a todos los recursos compartidos personales y con la propiedad del recurso compartido común. Los recursos compartidos van a estar en discos duros externos, por lo que debo de montarlos y configurar el servidor para que en cada arranque los monte automáticamente. Para cada disco procederé de la siguiente manera:\nConecto el disco duro al servidor, me aseguro que este desmontado y desde el terminal ejecuto el comando blkid para determinar el UUID del disco.\n1 2 3 4 5 6 7 usuario@servidor:~$ sudo umount /dev/sdb1 usuario@servidor:~$ sudo blkid -c /dev/null /dev/sda1: UUID=\u0026#34;b60367ee-e2bf-46d0-b6aa-f6239e589ca5\u0026#34; TYPE=\u0026#34;ext4\u0026#34; PARTUUID=\u0026#34;de864ffb-01\u0026#34; /dev/sda2: LABEL=\u0026#34;datos\u0026#34; UUID=\u0026#34;6f38a642-5086-48f1-9946-39c96a86f8d9\u0026#34; TYPE=\u0026#34;ext4\u0026#34; PARTUUID=\u0026#34;de864ffb-02\u0026#34; /dev/sda3: UUID=\u0026#34;cb3341c2-8272-4a57-8441-0c47922b3c77\u0026#34; TYPE=\u0026#34;swap\u0026#34; PARTUUID=\u0026#34;de864ffb-03\u0026#34; /dev/sdb5: LABEL=\u0026#34;Respaldo_1\u0026#34; UUID=\u0026#34;ff3605bc-0e85-4308-82f7-76be171eb044\u0026#34; TYPE=\u0026#34;ext4\u0026#34; PARTUUID=\u0026#34;5b7ccb58-05\u0026#34; /dev/sdc5: LABEL=\u0026#34;exchange_data\u0026#34; UUID=\u0026#34;be134147-7220-4c05-bcec-e3c5bf65e32c\u0026#34; TYPE=\u0026#34;ext4\u0026#34; PARTUUID=\u0026#34;c7da918e-05\u0026#34; En este ejemplo tengo conectado a mi servidor un disco duro (sdc5) en formato EXT4, con la etiqueta o nombre \u0026quot;exchange_data\u0026quot; que voy a agregarlo al fstab del servidor, para que en el arranque el disco duro siempre se monte en la carpeta compartida “datos_intercambio”.\nEdito el fstab y agrego el UUID\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 usuario@servidor:~$ sudo nano /etc/fstab #/etc/fstab: static file system information. # # Use \u0026#39;blkid\u0026#39; to print the universally unique identifier for a # device; this may be used with UUID= as a more robust way to name devices # that works even if disks are added and removed. See fstab(5). # # \u0026lt;file system\u0026gt; \u0026lt;mount point\u0026gt; \u0026lt;type\u0026gt; \u0026lt;options\u0026gt; \u0026lt;dump\u0026gt; \u0026lt;pass\u0026gt; # / was on /dev/sda1 during installation UUID=b60367ee-e2bf-46d0-b6aa-f6239e589ca5 / ext4 errors=remount-ro 0 1 # swap was on /dev/sda3 during installation UUID=cb3341c2-8272-4a57-8441-0c47922b3c77 none swap sw 0 0 UUID=6f38a642-5086-48f1-9946-39c96a86f8d9\t/mnt/datos\text4\tdefaults\t0\t0 UUID=be134147-7220-4c05-bcec-e3c5bf65e32c /media/datos_intercambio ext4 errors=remount-ro,auto,exec,rw,user 0 0 UUID=ff3605bc-0e85-4308-82f7-76be171eb044 /media/respaldo ext4 errors=remount-ro,auto,exec,rw,user 0 0 Creo las carpetas donde montaré los discos sdb y sdc\n1 2 usuario@servidor:~$ sudo mkdir /media/datos_intercambio usuario@servidor:~$ sudo mkdir /media/respaldo Monto todos los sistemas de archivos mencionados en fstab entre ellos sdb\n1 usuario@servidor:~$ sudo mount -a Ahora ya puedo crear las carpetas que voy a compartir\n1 2 3 4 5 usuario@servidor:~$ sudo mkdir /media/datos_intercambio/intercambios usuario@servidor:~$ sudo mkdir /media/datos_intercambio/cosas_de_usuario1 usuario@servidor:~$ sudo mkdir /media/datos_intercambio/cosas_de_usuario2 usuario@servidor:~$ sudo mkdir /media/respaldo/respaldo_usuario1 usuario@servidor:~$ sudo mkdir /media/respaldo/respaldo_usuario2 Instalo Samba.\n1 usuario@servidor:~$ sudo apt-get install samba Este comando instalará e iniciará tanto el servidor Samba smbd como el servidor Samba NetBIOS nmbd.\nConfigurando UFW Configuro el cortafuegos del servidor para permitir el tráfico de Samba dentro de la red local.\n1 usuario@servidor:~$ sudo ufw allow from 192.168.100.0/24 to any app Samba Compruebo las reglas del cortafuegos.\n1 2 3 4 5 6 7 8 9 10 usuario@servidor:~$ sudo ufw status Status: active To Action From -- ------ ---- 9000 ALLOW 192.168.100.0/24 2011 ALLOW 192.168.100.0/24 10000 ALLOW 192.168.100.0/24 Anywhere ALLOW 192.168.100.136 Samba ALLOW 192.168.100.0/24 Compruebo que funciona.\n1 2 3 4 5 usuario@servidor:~$ sudo netstat -tulpn | grep smb tcp 0 0 127.0.0.1:139 0.0.0.0:* LISTEN 4054/smbd tcp 0 0 192.168.100.132:139 0.0.0.0:* LISTEN 4054/smbd tcp 0 0 127.0.0.1:445 0.0.0.0:* LISTEN 4054/smbd tcp 0 0 192.168.100.132:445 0.0.0.0:* LISTEN 4054/smbd Creando usuarios y permisos Creo un usuario “usuario1” en el servidor. Este usuario no tendrá directorio home ni podrá acceder mediante ssh al servidor.\n1 2 3 usuario@servidor:~$ sudo groupadd sambauser usuario@servidor:~$ sudo useradd -c \u0026#34;usuario1\u0026#34; -s /usr/sbin/nologin usuario1 usuario@servidor:~$ sudo usermod -G sambauser -a usuario1 Agrego el usuario usuario1 al servidor Samba.\n1 2 3 4 5 6 usuario@servidor:~$ sudo smbpasswd -a usuario1 New SMB password: Retype new SMB password: Added user usuario1. usuario@servidor:~$ sudo smbpasswd -e usuario1 Enabled user usuario1. Repito estos pasos para el segundo usuario usuario2.\n1 2 3 4 5 6 7 8 usuario@servidor:~$ sudo useradd -c \u0026#34;usuario2\u0026#34; -s /usr/sbin/nologin usuario2 usuario@servidor:~$ sudo usermod -G sambauser -a usuario2 usuario@servidor:~$ sudo smbpasswd -a usuario2 New SMB password: Retype new SMB password: Added user ito. usuario@servidor:~$ sudo smbpasswd -e usuario2 Enabled user usuario2. Y para el usuario administrador sambaadmins.\n1 2 3 4 5 6 7 8 9 usuario@servidor:~$ sudo groupadd sambaadmins usuario@servidor:~$ sudo useradd -c \u0026#34;adminsamba\u0026#34; -s /usr/sbin/nologin adminsamba usuario@servidor:~$ sudo usermod -G sambaadmins -a adminsamba usuario@servidor:~$ sudo smbpasswd -a adminsamba New SMB password: Retype new SMB password: Added user adminsamba. usuario@servidor:~$ sudo smbpasswd -e adminsamba Enabled user adminsamba. compruebo los usuarios en Samba.\n1 2 3 4 usuario@servidor:~$ sudo pdbedit -L usuario1:1002:usuario1 adminsamba:1004:adminsamba usuario2:1003:usuario2 Ahora que los usuarios del sistema usuario1, usuario2 y adminsamba existen, puedo establecer la propiedad y los permisos en el directorio de inicio de Samba: 1 2 3 4 5 6 7 8 9 10 11 12 usuario@servidor:~$ sudo chown adminsamba:sambauser /media/datos_intercambio/intercambios usuario@servidor:~$ sudo chmod 2770 /media/datos_intercambio/intercambios usuario@servidor:~$ sudo chown usuario1:sambauser /media/datos_intercambio/cosas_de_usuario1/ usuario@servidor:~$ sudo chmod 2770 /media/datos_intercambio/cosas_de_usuario1/ usuario@servidor:~$ sudo chown usuario1:sambauser /media/datos_intercambio/cosas_de_usuario2/ usuario@servidor:~$ sudo chmod 2770 /media/datos_intercambio/cosas_de_usuario2/ usuario@servidor:~$ sudo chown usuario1:sambauser /media/respaldo/respaldo_usuario1/ usuario@servidor:~$ sudo chmod 2770 /media/respaldo/respaldo_usuario1/ usuario@servidor:~$ sudo chown usuario2:sambauser /media/respaldo/respaldo_usuario2/ usuario@servidor:~$ sudo chmod 2770 /media/respaldo/respaldo_usuario2/ Establecer los permisos del directorio en 2770 significa que los nuevos archivos o directorios creados en /media/datos_intercambio/cosas_de_usuario1 heredarán la propiedad del grupo del directorio principal en lugar del grupo primario del usuario que creó el archivo o directorio. Esto significa, por ejemplo, que si el usuario administrador adminsamba creara un nuevo directorio en el recurso compartido de usuario1, usuario1 podría leerlo y escribir en el.\nConfigurando Samba Lo siguiente es hacer una copia del archivo de configuración del servidor Samba y editarlo:\n1 2 usuario@servidor:~$ sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.old usuario@servidor:~$ sudo nano /etc/samba/smb.conf Dentro de el establezco el nombre del grupo de trabajo (por defecto \u0026ldquo;WORKGROUP\u0026rdquo;):\n1 2 # Change this to the workgroup/NT-domain name your Samba server will part of workgroup = WORKGROUP Deshabilito la definición de share para los homes de usuarios:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 ;[homes] ; comment = Home Directories ; browseable = no # By default, the home directories are exported read-only. Change the # next parameter to \u0026#39;no\u0026#39; if you want to be able to write to them. ; read only = yes # File creation mask is set to 0700 for security reasons. If you want to # create files with group=rw permissions, set next parameter to 0775. ; create mask = 0700 # Directory creation mask is set to 0700 for security reasons. If you want to # create dirs. with group=rw permissions, set next parameter to 0775. ; directory mask = 0700 # By default, \\\\server\\username shares can be connected to by anyone # with access to the samba server. # The following parameter makes sure that only \u0026#34;username\u0026#34; can connect # to \\\\server\\username # This might need tweaking when using external authentication schemes ; valid users = %S Deshabilito compartir impresoras:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ;[printers] ; comment = All Printers ; browseable = no ; path = /var/spool/samba ; printable = yes ; guest ok = no ; read only = yes ; create mask = 0700 # Windows clients look for this share name as a source of downloadable # printer drivers ;[print$] ; comment = Printer Drivers ; path = /var/lib/samba/printers ; browseable = yes ; read only = yes ; guest ok = no Y al final del archivo de configuración, incluyo un archivo de definición de shares personalizado (para simplificar la configuración): include = /etc/samba/smb.conf.shares Guardo los cambios y cierro el archivo. Luego, defino el nuevo share en el archivo personalizado:\n1 usuario@servidor:~$ sudo nano /etc/samba/smb.conf.shares Inserto la siguiente configuración:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 GNU nano 3.2 /etc/samba/smb.conf.shares [intercambios] comment = Directorio de intercambio path = /media/datos_intercambio/intercambios/ valid users = @sambauser @sambaadmins browseable = yes read only = no force directory mode = 2770 force create mode = 0770 [Cosas de Usuario1] comment = Directorio personal de Usuario1 path = /media/datos_intercambio/cosas_de_usuario1 valid users = usuario1 @sambaadmins browseable = yes read only = no force directory mode = 2770 force create mode = 0770 [Respaldo de Usuario1] comment = Directorio copias de seguridad de Usuario1 path = /media/respaldo/respaldo_usuario1 valid users = usuario1 @sambaadmins browseable = yes read only = no force directory mode = 2770 force create mode = 0770 [Cosas de Usuario2] comment = Directorio personal de Usuario2 path = /media/datos_intercambio/cosas_de_usuario2 valid users = usuario2 @sambaadmins browseable = yes read only = no force directory mode = 2770 force create mode = 0770 [Respaldo de Usuario2] comment = Directorio copias de seguridad de Usuario2 path = /media/respaldo/respaldo_usuario2 valid users = usuario2 @sambaadmins browseable = yes read only = no force directory mode = 2770 force create mode = 0770 Guardo los cambios y antes de reiniciar Samba compruebo con el programa de test testparm que no hay ningún fallo dentro de la configuracion del archivo.\n1 2 usuario@servidor:~$ sudo testparm usuario@servidor:~$ sudo systemctl restart smbd Acceso al servidor Samba desde la linea de comandos Se puede usar una herramienta llamada smbclient para acceder a Samba desde la línea de comandos. Este paquete no está incluido de manera predeterminada en la mayoría de las distribuciones de Linux, por lo que se debería instalar con el administrador de paquetes local apt.\nEn Debian y Ubuntu, se instala smbclient con el siguiente comando:\n1 2 usuario@usuariopc:~$ sudo apt-get update usuario@usuariopc:~$ sudo apt-get install smbclient Para montar, en el sistema de archivos de mi ordenador personal con Debian, recursos de redes CIFS compartidos en máquinas remotas, debo instalar las Utilidades Comunes para Sistemas de Archivos de Internet ,“Common Internet File System utilities” cifs-utils:\n1 usuario@usuariopc:~$ sudo apt -y install cifs-utils smbclient usa el siguiente formato para acceder a los recursos compartidos de Samba:\n1 smbclient //ip_samba_hostname_o_server_ip/share -U username Después de ejecutar el comando smbclient, me pide la contraseña de Samba y me registra en una interfaz de línea de comandos que recuerda la interfaz de texto FTP:\n1 smb: \\\u0026gt; Esta interfaz es más útil para probar nombres de usuario y contraseñas y acceso de lectura y escritura. Por ejemplo, puedo crear un directorio y enumerar su contenido de la siguiente manera:\n1 2 smb: \\\u0026gt; mkdir prueba smb: \\\u0026gt; ls Para eliminar el directorio puedo escribir:\nsmb: \\\u0026gt; rmdir test Si quiero acceder como usuario1 al recurso compartido común intercambios, cambio el comando a:\n1 smbclient //samba.ejemplo.com/intercambios -U usuario1 o al recurso compartido Cosas de Usuario1:\n1 2 3 4 5 6 usuario@usuariopc:~$ smbclient //servidor-nombre.local/\u0026#39;Cosas de Usuario1\u0026#39; -U usuario1 mkdir failed on directory /var/run/samba/msg.lock: Permiso denegado Unable to initialize messaging context Enter WORKGROUP\\usuario1\u0026#39;s password: Try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; Veo que aparece un error, no me permite acceder al directorio /var/run/samba/msg.lock. es un bug reportado para la version de Samba 4.9.5 que porta Debian Buster\nRealizo un test de velocidad para conocer la velocidad de transferencia entre los distintos discos\n1 2 3 4 5 6 7 8 9 10 11 usuario@servidor:~$ sudo hdparm -t /dev/sdc /dev/sdc: Timing buffered disk reads: 92 MB in 3.05 seconds = 30.17 MB/sec usuario@servidor:~$ sudo hdparm -t /dev/sdb /dev/sdb: Timing buffered disk reads: 288 MB in 3.01 seconds = 95.56 MB/sec usuario@servidor:~$ sudo hdparm -t /dev/sda /dev/sda: Timing buffered disk reads: 1296 MB in 3.00 seconds = 431.78 MB/sec ","pubDate":"2020-10-14","title":"Compartiendo recursos con Samba en Debian 10 Buster"},{"link":"https://esaborit.github.io/posts/autofirma-debian-buster/","plain":"Otra herramienta útil en la tramitación de documentación de manera telemática ante la administración es Autofirma. Según nos indican en la sede electrónicoa del gobierno de España.\nAutofirma es una aplicación de firma realizada por el Ministerio de Hacienda y Administraciones Públicas. Su principal objetivo es ofrecer al usuario un sistema de firma en el que éste pueda firmar cualquier tipo de documento de manera sencilla. El usuario indica qué fichero quiere firmar y la aplicación escoge automáticamente el formato de firma qué debe aplicar, liberando así, al usuario de cualquier duda técnica.\nRequisitos técnicos previos En Linux para poder realizar el envío telemático usando un certificado o firma electrónica es necesario que se cumplan los siguientes requisitos:\nTener instalado en el ordenador un certificado digital válido y aprobado por el Ministerio (por ejemplo: certificado del DNIe o un certificado en tarjeta de la FNMT).\nTener instalado en el ordenador desde el que se quiere realizar el proceso de firma una versión válida de la máquina virtual de Java. En Linux se necesita un entorno de ejecución de Java 8 de Oracle u OpenJDK 8 mínimo (marcado como dependencia en el instalador integrado de AutoFirma).\nMozilla Firefox 41.0.1 o superior.\nNota: Se ha detectado una incompatibilidad entre la aplicación \u0026ldquo;Autofirma\u0026rdquo; y la última versión de navegador web \u0026ldquo;Mozilla Firefox 71\u0026rdquo; que impide la realización de firmas electrónicas. El problema afecta a los sistemas operativos Windows y Linux. Se recomienda no actualizar a esta versión del navegador.\u0026quot;\nBiblioteca “libnss3-tools”.\nInstalando Autofirma Antes de instalar el paquete deb de autofirma debo cumplir los requerimientos mínimos anteriormente mencionados, para que en el momento en que la aplicación haga contacto con el navegador Firefox no ocurra ningún tipo de error que entorpezca luego la correcta instalación. Como requisito ineludible, la instalación de AutoFirma en Linux debe ser realizada por un usuario con permisos de administrador, así que me logeo como tal y aprovecho para instalar las dependencias (OpenJDK y biblioteca NSS Tools) que requiere para su correcto funcionamiento.\n1 2 root@asuspc:~# apt-get install libnss3-tools root@asuspc:~# apt install default-jre Compruebo la versión de java\n1 2 3 4 5 root@asuspc:~# java -version openjdk version \u0026#34;11.0.8\u0026#34; 2020-07-14 OpenJDK Runtime Environment (build 11.0.8+10-post-Debian-1deb10u1) OpenJDK 64-Bit Server VM (build 11.0.8+10-post-Debian-1deb10u1, mixed mode, sharing) root@asuspc:~# Creo una carpeta donde descargo temporalmente el zip de Autofirma y lo descomprimo.\n1 2 3 4 5 6 7 8 9 root@asuspc:~# mkdir tmp_autofirma root@asuspc:~# cd tmp_autofirma root@asuspc:~# wget https://estaticos.redsara.es/comunes/autofirma/currentversion/AutoFirma_Linux.zip root@asuspc:~# unzip AutoFirma_Linux.zip Archive: AutoFirma_Linux.zip inflating: AF_manual_instalacion_usuarios_ES.pdf extracting: autofirma-1.6.5-1.noarch.rpm extracting: AutoFirma_1_6_5.deb inflating: autofirma-1.6.5-1.noarch_SUSE.rpm Procedo a instalar Autofirma.\n1 root@asuspc:~# dpkg -i AutoFirma_1_6_5.deb El proceso de instalación creará la CA de Autofirma y la instalará en los navegadores Firefox, Chrome y Chromium. Los navegadores deben estar previamente instalados, en caso de instalarse posteriormente al proceso de instalación de Autofirma sería necesario instalar de forma manual el certificado de confianza, o bien ejecutar de nuevo la instalación de Autofirma.\nEl funcionamiento de AutoFirma está verificado en distribuciones Ubuntu, Fedora y OpenSuse. Una vez instalada, puede usarse como aplicación de escritorio e invocarse desde los navegadores web Mozilla Firefox y Google Chrome.\nHay dos opciones de instalación: por línea de comandos y desde la interfaz de escritorio. La instalación por ambos medios dejará la aplicación instalada por defecto en el directorio: /usr/lib/AutoFirma.\nUna vez finalizada la instalación y comprobado que funciona correctamente, borro el directorio temporal.\n1 2 root@asuspc:~# cd .. root@asuspc:~# rm tmp_autofirma Para desinstalar Autofirma se puede hacer.\n1 root@asuspc:~# apt-get remove –-purge autofirma Uso de DNIe y tarjetas inteligentes de la FNMT AutoFirma comprueba al abrirse si existen lectores de tarjeta inteligente instalados en el sistema. Si los detecta, muestra al usuario una pantalla para que seleccione si desea “Firmar con DNIe” o “Usar cualquier certificado”. Tanto si se selecciona “Firmar con DNIe” como si se selecciona “Usar cualquier certificado” y luego se selecciona el certificado del DNIe o un certificado en tarjeta de la FNMT, AutoFirma hará uso del certificado mediante un controlador propio integrado en la propia aplicación. Este controlador es JMulticard y permite utilizar los certificados alojados en este tipo de tarjetas aun cuando no se tiene instalado su controlador oficial (CSP o PKCS#11) en el equipo.\nJMulticard pedirá el PIN de las tarjetas que lo requieran para acceder al listado de certificados que contienen. También pedirá el PIN cada vez que se desee utilizar para firmar cualquiera de estos certificados. Esto puede suponer un inconveniente si queremos firmar múltiples documentos seguidos. Este comportamiento puede no darse con los controladores oficiales de las tarjetas que mantienen habilitado el permiso de firma después de la primera, evitando que sea necesario volver a introducir el PIN.\nSi no desea utilizar JMulticard cuando seleccione el uso de cualquier certificado, puede deshabilitar su uso desde el menú de preferencias de AutoFirma. Acceda a la aplicación, selecciones el menú “Herramientas” y la opción “Preferencias”. En la pestaña “General” se muestra la opción “Habilitar JMulticard para el uso de las tarjetas de la FNMT y DNIe”. Esta opción estará habilitada por defecto y deberá desactivarla para que se use el controlador oficial de su tarjeta. Después de desactivar esta opción, deberá pulsar Aceptar en el panel. La próxima vez que abra AutoFirma, se cargará el controlador oficial de su tarjeta en lugar de Jmulticard.\nPosibles problemas Al instalar AutoFirma falla la instalación de los certificados de confianza SSL.\nAutoFirma requiere permisos de administrador para ser instalado y para insertar el certificado de confianza SSL para el funcionamiento de la firma en los trámites online. Si no puede instalar AutoFirma o el certificado de confianza, solicite al administrador de su sistema que realice la instalación de la aplicación.\nAl abrir Google Chrome después del proceso de instalación de AutoFirma se muestra un mensaje notificando que la configuración de la aplicación está corrupta.\nEl navegador Google Chrome incluye en su configuración un listado de protocolos que considera seguros para la llamada a aplicaciones externas. Durante el proceso de instalación de AutoFirma se registra el protocolo “afirma” en este listado seguro de Chrome para que las invocaciones desde el navegador se realicen correctamente. En algunas situaciones en las que el instalador podría no poder completar el proceso de registro, el fichero de configuración de Chrome podría quedar en un estado inconsistente. En estos casos, al iniciarse de nuevo el navegador, detectará el problema y anunciará al usuario esta corrupción de datos mediante una ventana de advertencia que nos permitirá restaurar las propiedades por defecto. Seguidamente, el navegador restaurará las propiedades de configuración y volverá a funcionar normalmente. En este caso, el usuario recibirá mensajes de advertencia al usar AutoFirma desde Chrome para realizar firmas, aunque esto no impedirá que funcione normalmente. Durante el proceso de desinstalación de AutoFirma se realiza el proceso inverso al de instalación y se elimina el protocolo “afirma” del listado de protocolos seguros registrados en Chrome. Este proceso podría derivar en algunas circunstancias a la misma corrupción de la configuración del navegador.\nCuando se instala Mozilla Firefox o se crea un nuevo perfil de usuario después de la instalación de AutoFirma, este no funciona en Firefox.\nDurante el proceso de instalación de AutoFirma se genera un certificado para la comunicación entre la página web y la aplicación, y lo instala en los almacenes de confianza del sistema y de Firefox. Si se crea un perfil de usuario de Firefox o se instala el propio Firefox después de la instalación de AutoFirma, este no contará con el certificado entre los que considera de confianza. Para resolver este problema deberá desinstalar AutoFirma y volverlo a instalar. Tenga en cuenta, sin embargo, que esto implicará que se pierda la configuración personalizada establecida en AutoFirma.\nAutoFirma indica que un documento PDF es demasiado grande cuando se intenta firmar con firma visible.\nCuando AutoFirma crea la previsualización de un documento PDF, lo carga en memoria y crea miniaturas de cada una de sus páginas. Esta tarea requiere una gran cantidad de memoria y es posible que no pueda completarse porque la aplicación no pueda reservar suficiente. Este problema suele darse con documentos PDF de gran tamaño o con un gran número de páginas. La probabilidad aumenta considerablemente en equipos con instalaciones de 32bits de AutoFirma, ya que no permiten reservar toda la memoria necesaria. También puede ocurrir en equipos con 2Gb de memoria o menos. Se recomienda que los usuarios de sistemas operativos de 64bits utilicen AutoFirma de 64bits para reducir la probabilidad de sufrir este error.\nAutoFirma se cierra inmediatamente tras ser invocado desde el navegador web.\nCuando se abre AutoFirma por petición de un navegador web inmediatamente se abre una conexión entre ambas aplicaciones. Si AutoFirma detecta cualquier problema que evita que se pueda establecer esa comunicación, se cierra. Esto dará lugar a que, pasado un tiempo, la página web que intentó realizar la operación de firma informe de que no se pudo conectar con AutoFirma. Si se encuentra en esta situación, utilice la función de “Restaurar instalación” de AutoFirma. Esta función permitirá reestablecer la configuración y los recursos necesarios para que se pueda establecer la comunicación entre el navegador y AutoFirma. La función de “Restauración instalación” se encuentra disponible en el menú de herramientas de AutoFirma. ","pubDate":"2020-08-14","title":"Instalación de Autofirma en Debian 10 Buster"},{"link":"https://esaborit.github.io/posts/dnie-debian-buster/","plain":"Para facilitar algunos de mis trámites con la administración pública, tanto local como estatal, voy a instalar un lector de DNIe en mi máquina con Debian Buster y los certificados de dicho documento en el navegador web Firefox 68.12.0esr (64-bit).\nActualización: Esta guía es valida para máquinas con Debian 11 bullseye y Firefox 98.0.2.\nPreparando la instalación Instalo los paquetes necesarios para el lector y la gestión de la entrada del PIN\n1 usuario@usuariopc:~$ sudo apt-get install pcscd pcsc-tools opensc Dependiendo del entorno de ventanas que esté utilizando, deberé instalar el paquete de pinentry (pinentry-curses para diálogos de consola, pinetry-gtk2 para Gnome o pinentry-qt4 para KDE) que solicita el pin de nuestro DNIe: En mi caso, al usar Gnome, instalaré pinentry-gtk2:\n1 usuario@usuariopc:~$ sudo apt-get install pinentry-gtk2 Compruebo con el comando pcsc_scan que el sistema reconoce el lector. Conecto el lector USB con el DNI metido, y escribo\n1 usuario@usuariopc:~$ pcsc_scan Esta es la salida por consola:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 usuario@usuariopc:~$ pcsc_scan Using reader plug\u0026#39;n play mechanism Scanning present readers... 0: C3PO LTC31 v2 00 00 Mon Jun 24 12:35:44 2019 Reader 0: C3PO LTC31 v2 00 00 Event number: 0 Card state: Card inserted, Shared Mode, ATR: 3B 7F 96 00 00 00 6A 44 4E 49 65 10 01 01 55 04 21 03 90 00 ATR: 3B 7F 96 00 00 00 6A 44 4E 49 65 10 01 01 55 04 21 03 90 00 + TS = 3B --\u0026gt; Direct Convention + T0 = 7F, Y(1): 0111, K: 15 (historical bytes) TA(1) = 96 --\u0026gt; Fi=512, Di=32, 16 cycles/ETU 250000 bits/s at 4 MHz, fMax for Fi = 5 MHz =\u0026gt; 312500 bits/s TB(1) = 00 --\u0026gt; VPP is not electrically connected TC(1) = 00 --\u0026gt; Extra guard time: 0 + Historical bytes: 00 6A 44 4E 49 65 10 01 01 55 04 21 03 90 00 Category indicator byte: 00 (compact TLV data object) Tag: 6, len: A (pre-issuing data) Data: 44 4E 49 65 10 01 01 55 04 21 Mandatory status indicator (3 last bytes) LCS (life card cycle): 03 (Initialisation state) SW: 9000 (Normal processing.) Possibly identified card (using /usr/share/pcsc/smartcard_list.txt): 3B 7F 96 00 00 00 6A 44 4E 49 65 10 01 01 55 04 21 03 90 00 3B 7F 96 00 00 00 6A 44 4E 49 65 10 01 01 55 04 .. 03 90 00 DNIE Spain (eID) http://www.dnielectronico.es/PortalDNIe/ Salgo de pcsc_scan con Ctrl+C y desconecto el lector de DNI.\nDescargo el paquete de DNI electrónico, para Debian Buster desde la página de la Policía Nacional\n1 usuario@usuariopc:~$ wget https://www.dnielectronico.es/descargas/distribuciones_linux/Debian_10_libpkcs11-dnie_1.5.3_amd64.deb Compruebo que la suma de comprobación es correcta:\n1 2 usuario@usuariopc:~$ md5sum Debian_10_libpkcs11-dnie_1.5.3_amd64.deb c9a15dd9ae4327a468f850af93b8ef45 Debian_10_libpkcs11-dnie_1.5.3_amd64.deb Lo instalo\n1 usuario@usuariopc:~$ sudo dpkg -i Debian_10_libpkcs11-dnie_1.5.3_amd64.deb Aquí se instala el paquete pero luego da un error porque intenta abrir Firefox como root, cosa que el sistema no deja. Lo que hace es llamar a un script en Perl que es el que lanza Firefox, así que lo llamo como usuario normal: usuario@usuariopc:~$ /usr/share/libpkcs11-dnie/launch.pl. Se abre Firefox y hay que seguir las instrucciones de la página web que aparece (file:///usr/share/libpkcs11-dnie/launch.html) para cargar el módulo de seguridad de DNIe, y la autoridad de certificación FNMT.\nPara usar el DNI electrónico se requiere: Instalar el Módulo de Seguridad PKCS#11\nPara instalar el módulo PCKS#11 debo ir en Firefox a Preferencias/Privacidad \u0026amp; Seguridad/Seguridad/ certificados/Dispositivos de seguridad y seleccionoCargar.\nLe doy un nombre al módulo. (Por ejemplo \u0026ldquo;Modulo DNIe\u0026rdquo;).\nIndico manualmente la ruta del módulo: /usr/lib/libpkcs11-dnie.so.\nPulso el botónAceptar.\nCon la sesión iniciada.\nInstalar el Certificado Raíz de la Autoridad de Certificación del DNIe Para instalar el certificado raíz debo ir en Firefox a Preferencias/Privacidad \u0026amp; Seguridad/Seguridad/ certificados/Ver certificados y en la pestaña Autoridades seleccionoImporta.\nIndico manualmente la ruta del certificado raíz: /usr/share/libpkcs11-dnie/ac_raiz_dnie.crt.\nEl asistente me pide que establezca la confianza para el certificado, por lo que marco las tres casillas de confianza y pulso el botón Aceptar.\nUna vez hecho esto, cierro Firefox, lo vuelvo a abrir, entro en una web que me pida el DNI electrónico y compruebo que funciona.\n","pubDate":"2020-08-14","title":"Instalación de DNI electrónico (DNIe) en Debian 10 Buster"},{"link":"https://esaborit.github.io/posts/openvpn-as/","plain":"Otra utilidad que quería darle a mi servidor casero era la de poder acceder a Internet de manera segura desde mi teléfono o desde mi portátil cuando estoy conectado a una red de la que no me fío, como la red wifi de un hotel o una cafetería. Por ello voy a crear una red privada virtual (VPN) que me permita navegar por redes no confiables de manera privada y segura, como si estuviera en mi red privada.\nEl tráfico se inicia en el servidor de la VPN y continúa su camino hacia el destino. Cuando se combina con conexiones HTTPS, esta configuración permite proteger los inicios de sesión y las operaciones que realizo por medios inalámbricos. También se podría usar para evitar censuras y restricciones geográficas, o proteger la ubicación y el tráfico de HTTP no cifrado contra la actividad de la red no confiable.\nVoy a utilizar OpenVPN que es una solución de capa de conexión segura (SSL) de funciones completas y de código abierto que cuenta con una amplia variedad de configuraciones.\nPrimero creo el contenedor docker de nombre openvpn-as el fichero:\n1 2 3 4 5 6 7 8 9 10 11 12 13 docker create \\ --name=openvpn-as \\ --cap-add=NET_ADMIN \\ -e PUID=1001 \\ -e PGID=1001 \\ -e TZ=Europe/Madrid \\ -e INTERFACE=eth0 `#optional` \\ -p 943:943 \\ -p 9443:9443 \\ -p 1194:1194/udp \\ -v /mnt/datos/appdata/openvpn:/config \\ --restart unless-stopped \\ linuxserver/openvpn-as Lo siguiente es ponerlo en funcionamiento\n1 docker start openvpn-as Configuración de la aplicación Una vez que el contenedor se ha puesto en marcha sin contratiempos puedo configurarlo entrando en la aplicación a través de su interface web desde https://DOCKER-HOST-IP:943/admin.\nMe identifico con el usuario “admin” y la contraseña “password” que son las credenciales asignadas por defecto. Durante el primer inicio de sesión me aseguro de que la \u0026ldquo;Autenticación\u0026rdquo; en el interface web esté configurada como \u0026quot;Local\u0026quot; en lugar de \u0026quot;PAM\u0026quot;. Luego configuro las cuentas de usuario que necesito (me parece que solo deja 2) con sus contraseñas (las cuentas de usuario creadas bajo “PAM” no sobreviven a la actualización o recreación del contenedor).\nCreación de usuarios Creo otro usuario y lo configuro como administrador Inicio sesión como el nuevo usuario Elimino el usuario \u0026quot;admin\u0026quot; en la interfaz gráfica de usuario Modifico el archivo as.conf en config / etc y reemplazo la línea boot_pam_users. 0 = admin con boot_pam_users.0 = nombreotrousuario (esto solo debe hacerse una vez y sobrevivirá a la recreación del contenedor) Dentro del menú de configuración en la opción “VPN settings” la configuración la tengo así. No le he dado acceso a los clientes a mi red local 192.168.300.0\nDentro de “Network settings” puedes configurar los parámetros de la red a tu gusto.\nMe conecto con el cliente “usuariodocker” a través de la dirección https://\u0026lt;\u0026lt;YourIpAddress\u0026gt;\u0026gt;:943.\nMe dirige a la siguiente página desde donde me puedo bajar el perfil del cliente.ovpn\nSolo queda que lo agregue a la aplicación del teléfono inteligente.\n","pubDate":"2020-06-29","title":"Red privada virtual con OPENVPN y Docker"},{"link":"https://esaborit.github.io/posts/wordpress-y-letsencrypt/","plain":"Después de instalar mi servidor web y el proxy inverso voy a crear un Server Blocks (virtualhost en Apache) en el servidor web Ngnix. En el alojaré un sitio web creado con WordPress al que accederé desde internet con el subominio de pruebas pruebas.misubdominio.duckdns.org que he creado.\nVoy a Instalar WordPress dentro del contenedor letsencryt creado en el post anterior. Empiezo elaborando el archivo Server Blocks en el directorio mapeado “/appdata/letsencrypt/nginx/site-confs/pruebas.misubdominio.duckdns.org” correspondiente a mi subdominio “pruebas.misubdominio.duckdns.org”. Su contenido es el siguiente:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 ## Version 2019/08/01 - Changelog: https://github.com/linuxserver/docker-letsencrypt/commits/master/root/defaults/default # redirect all traffic to https server { listen 80; listen [::]:80; server_name pruebas.misubdominio.duckdns.org; return 301 https://$host$request_uri; } # main server block server { listen 443 ssl http2; listen [::]:443 ssl http2; root /config/www/pruebas.misubdominio.duckdns.org/html; index index.html index.htm index.php; server_name pruebas.misubdominio.duckdns.org; # enable subfolder method reverse proxy confs #include /config/nginx/proxy-confs/*.subfolder.conf; # all ssl related config moved to ssl.conf include /config/nginx/ssl.conf; client_max_body_size 0; location / { try_files $uri $uri/ /index.html /index.php?$args =404; } location ~ \\.php$ { fastcgi_split_path_info ^(.+\\.php)(/.+)$; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; include /etc/nginx/fastcgi_params; } } Sigo con la carpeta donde alojaré todo el contenido web, en este caso WordPress “/appdata/letsencrypt/www/pruebas.misubdominio.duckdns.org/html/index.html”.\nDesde la terminal me descargo WordPress en español.\n1 wget https://es.wordpress.org/latest-es_ES.zip Lo descomprimo en el directorio raíz de mi sitio web.\n1 unzip latest-es_ES.zip -d /appdata/letsencrypt/www/puebas.misubdominio.duckdns.org/html/ Antes de configurar WordPress, necesito una base de datos para el, así que me conecto al contenedor de bases de datos “mariadb”.\n1 docker exec -it mariadb bash Hago login en el SGDB como root.\n1 mysql -uroot -p Y creo una base de datos y un usuario con privilegios para esa base de datos.\n1 2 3 4 5 6 7 8 9 10 MariaDB [(none)]\u0026gt; create database wordpress_db; Query OK, 1 row affected (0.002 sec) MariaDB [(none)]\u0026gt; grant all on wordpress_db.* to \u0026#39;wordpressuser\u0026#39;@\u0026#39;%\u0026#39; identified by \u0026#39;password\u0026#39;; Query OK, 0 rows affected (0.008 sec) MariaDB [(none)]\u0026gt; flush privileges; Query OK, 0 rows affected (0.003 sec) MariaDB [(none)]\u0026gt; Ya tengo creadas la base de datos y el usuario al que he dado todos los privilegios sobre la base de datos. Ahora abro el archivo wp-config.php del wordpress que he descomprimido y lo modifico con los datos de mi base de datos y usuario y lo dejo así:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 \u0026lt;?php /** * Configuración básica de WordPress. * * Este archivo contiene las siguientes configuraciones: ajustes de MySQL, prefijo de tablas, * claves secretas, idioma de WordPress y ABSPATH. Para obtener más información, * visita la página del Codex{@link http://codex.wordpress.org/Editing_wp-config.php Editing * wp-config.php} . Los ajustes de MySQL te los proporcionará tu proveedor de alojamiento web. * * This file is used by the wp-config.php creation script during the * installation. You don\u0026#39;t have to use the web site, you can just copy this file * to \u0026#34;wp-config.php\u0026#34; and fill in the values. * * @package WordPress */ // ** Ajustes de MySQL. Solicita estos datos a tu proveedor de alojamiento web. ** // /** El nombre de tu base de datos de WordPress */ define(\u0026#39;DB_NAME\u0026#39;, \u0026#39;wordpress_db\u0026#39;); /** Tu nombre de usuario de MySQL */ define(\u0026#39;DB_USER\u0026#39;, \u0026#39;wordpressuser\u0026#39;); /** Tu contraseña de MySQL */ define(\u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;password\u0026#39;); /** Host de MySQL (es muy probable que no necesites cambiarlo) */ define(\u0026#39;DB_HOST\u0026#39;, \u0026#39;mariadb\u0026#39;); /** Codificación de caracteres para la base de datos. */ define(\u0026#39;DB_CHARSET\u0026#39;, \u0026#39;utf8\u0026#39;); /** Cotejamiento de la base de datos. No lo modifiques si tienes dudas. */ define(\u0026#39;DB_COLLATE\u0026#39;, \u0026#39;\u0026#39;); /**#@+ * Claves únicas de autentificación. * * Define cada clave secreta con una frase aleatoria distinta. * Puedes generarlas usando el {@link https://api.wordpress.org/secret-key/1.1/salt/ servicio de claves secretas de WordPress} * Puedes cambiar las claves en cualquier momento para invalidar todas las cookies existentes. Esto forzará a todos los usuarios a volver a hacer login. * * @since 2.6.0 */ define(\u0026#39;AUTH_KEY\u0026#39;, \u0026#39;L^(,=J*aOw,BXr-Yx\u0026amp;wPU]|Sa@Ycrv_nT)F*EodV1?R](j\u0026amp;1OG/QS0-PfEebkvB#\u0026#39;); define(\u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;}HslE%ng6b=a$!fP4)EaU(;lJAO\u0026gt;C,QtPU|.f%Mka|\u0026lt;/Jbq!FI^\u0026amp;-_wgF#Ju?Z\u0026lt;F\u0026#39;); define(\u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;(r}ca:vject}Si*Y#-%uk(6]j+w=-sEMy.XH+uOE3l*i:Y;3|u~p2:fhG}8:xnC-\u0026#39;); define(\u0026#39;NONCE_KEY\u0026#39;, \u0026#39;M[6~N$f;~CQ--/s$XZ@z2~;\u0026gt;Lx9@,aoyK`J R0Be:Di=C.gxZzIx\u0026lt;x+RKZ+-%1:|\u0026#39;); define(\u0026#39;AUTH_SALT\u0026#39;, \u0026#39;Mj46{|,2$mG9St?%@Ke{GKY+,QQxp\u0026gt;]_t` FU+|w!(i_|IE#;FdGhrH.=:zdl+u0\u0026#39;); define(\u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;q_Ll_x}69t|ppWH9|@#_P(@![d/ aDtKvV`s.| BW.HAl-^B:R2P|rE\u0026gt;^H?Z1EkP\u0026#39;); define(\u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;g7F4SZBMW} L;L-eLE|:Kb|y4sgCcM@s6AFkmFYkO,M\u0026lt;?_OC3{DX(\u0026lt;!;=4[*E2O;\u0026#39;); define(\u0026#39;NONCE_SALT\u0026#39;, \u0026#39;A`I_=F8RH-TiH@/n,#vK-w#}0BXxsH7|TVnc#}e43uJDP\u0026amp;QnaPVs2#sH-+{pU] 1\u0026#39;); /**#@-*/ /** * Prefijo de la base de datos de WordPress. * * Cambia el prefijo si deseas instalar múltiples blogs en una sola base de datos. * Emplea solo números, letras y guión bajo. */ $table_prefix = \u0026#39;wordpress_\u0026#39;; ?\u0026gt; Lo guardo todo y abro la dirección “https://pruebas.misubdominio.duckdns.org/wp-admin/install.php” de mi subdominio para seguir con la instalación. Me aparecerá una ventana como la siguiente en la que debo rellenar el título del sitio, nombre de usuario y contraseña. La dirección de correo electrónico sirve como dirección de correo del usuario administrador que acabo de crear. Todos los mensajes e interacciones en WordPress, llegarán a ese correo.\nCuando he completado todos los campos hago click en el botón “instalar wordpress”. Si todo ha ido bien y he seguido los pasos correctamente finalizará la instalación y mostrará una pantalla con el mensaje de que se ha instalado correctamente.\nYa puedo entrar con mi usuario y contraseña a configurar el sitio web con WordPress.\n","pubDate":"2020-06-25","title":"WordPress y linuxserver-letsencrypt"},{"link":"https://esaborit.github.io/posts/comandos-elementales-en-docker/","plain":"Recojo en este breve post un pequeño listado de comandos docker para trabajar con imágenes y contenedores.\nHabilitar Docker Repo, instalar e iniciar Docker\n1 2 sudo systemctl start docker sudo systemctl enable docker Otorgar al usuario normal que ejecute comandos de ventana acoplable\n1 sudo usermod -aG docker babinlonston Verificando la versión de Docker\n1 2 3 docker -v docker info docker system info Búsqueda, extracción, listado y eliminación de imágenes de Docker.\n1 2 3 4 5 6 docker search nginx docker pull nginx docker pull nginx:1.14 docker images docker rmi nginx docker rmi nginx:1.14 Comenzando un contenedor, con etiqueta\n1 2 3 4 docker run nginx docker run -d nginx:1.14 docker run -d --name web_server nginx docker run -d --name web_server1 nginx:1.14 Lanzar un contenedor e iniciar sesión en él.\n1 docker run --name web_server2 -it nginx /bin/bash Listado de todos los contenedores en ejecución y detenidos\n1 2 docker ps docker ps -a Acceso al shell de un contenedor en ejecución después del lanzamiento\n1 docker exec -it web_server /bin/bash Ejecutando comando en un contenedor en ejecución\n1 2 docker exec web_server cat /etc/hosts docker exec web_server env Reiniciar, detener y borrar\n1 2 3 4 5 docker restart web_server docker stop web_server1 nginx docker stop $(docker ps -aq) docker rm web_server1 docker rm $(docker ps -aq) Referencia: Cómo gestionar contenedores Docker Detener o \u0026ldquo;matar\u0026rdquo; enviando SIGKILL\n1 2 docker kill exec web_server2 docker kill -s SIGKILL exec web_server2 Lanzar y exponer la red.\n1 2 docker run --name web_server3 -p 8080:80 -d -it nginx docker run -d --name web_server4 -p 192.168.107.105:8080:80 nginx Referencia: Cómo conectar los contenedores Docker y exponer la red. Correr Inspeccionar para saber la IP de un contenedor\n1 2 3 4 docker inspect web_server docker inspect web_server | grep -i -A 1 \u0026#39;IPAddress|ExposedPorts\u0026#39; docker inspect -f \u0026#39;{{ .NetworkSettings.IPAddress }}\u0026#39; web_server docker inspect -f \u0026#39;{{ .Config.ExposedPorts }}\u0026#39; web_server Adjuntar un volumen\n1 2 3 4 5 6 7 mkdir /mysql_container chown -R 27:27 /mysql_container chcon -t svirt_sandbox_file_t /mysql_container #temp or semanage fcontext -a -t svirt_sandbox_file_t \u0026#39;/mysql_container(/.*)?\u0026#39; #Persistent docker run --name mysql-pro-dbsrv -d -v /mysql_container:/var/lib/mysql/ -e MYSQL_ROOT_USER=root -e MYSQL_ROOT_PASSWORD=password123 mysql Referencia: administrar los datos de Docker de forma persistente adjuntando un volumen Docker exportar, importar, cargar y guardar\n1 2 3 4 docker export apache \u0026gt; linuxsysadins.local.tar docker import - website \u0026lt; linuxsysadins.local.tar docker save -o website_backup.local.tar website docker load \u0026lt; website_backup.local.tar Creando archivo Docker y construyendo imagen\n1 2 mkdir /root/linuxsysadmins nano /root/linuxsysadmins/Dockerfile Reemplace con sus valores requeridos.\n1 2 3 4 5 6 7 FROM centos MAINTAINER Babin Lonston RUN yum update -y \u0026amp;\u0026amp; yum install httpd mod_ssl -y ADD linuxsysadmins.local.conf /etc/httpd/conf.d/linuxsysadmins.local.conf ADD index.html /var/www/html/index.html CMD [\u0026#34;/usr/sbin/httpd\u0026#34;, \u0026#34;-D\u0026#34;, \u0026#34;FOREGROUND\u0026#34;] EXPOSE 80/tcp Crea el archivo index.html para Apache\n1 nano /root/linuxsysadmins/index.html Anexa con tu contenido.\n1 2 3 4 5 6 7 \u0026lt;code\u0026gt; \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;This is Test page for linuxsysadmins.local\u0026lt;/h1\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; \u0026lt;/code\u0026gt; Construye una imagen usando un archivo docker. Asegúrese de usar \u0026ldquo;.\u0026rdquo; Como se muestra a continuación.\n1 2 docker build -t linuxsysadmins.local . docker images Empujando imágenes a Docker Hub\n1 2 3 4 docker login docker tag linuxsysadmins.local babinlonston/linuxsysadmins.local:0.1 docker images docker push babinlonston/linuxsysadmins.local:0.1 ","pubDate":"2020-06-18","title":"Comandos Elementales en Docker"},{"link":"https://esaborit.github.io/posts/docker-en-un-servidor-casero/","plain":"Tengo un pequeño ordenador con varios servidores (Web, SQL, VPN, Nextcloud) al que voy a cambiar el disco duro. Después de barajar las distintas opciones disponibles, he decidido instalar Debian 10 server en el que por facilidad de mantenimiento quiero virtualizar todos estos servicios.\nPara lo cual la opción que mejor se adapta a mis necesidades y conocimientos es utilizar Docker una tecnología de virtualización basada en contenedores. Lo primero de todo es instalar el sistema operativo, actualizarlo y configurar una cuenta de usuario con privilegios sudo. Después instalo Docker. Para ello voy a su página y sigo las instrucciones dadas para sistemas Debian.\nInstalación de docker en Debian 10 Preparo el sistema operativo para la instalación de docker\n1 sudo apt update \u0026amp;\u0026amp; sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common Descargo la llave del Repositorio oficial, para configurar el Repositorio oficial y validar los archivos disponibles del mismo, con la versión de nuestra Distro GNU/Linux.\n1 2 3 curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add - sudo add-apt-repository \u0026#34;deb [arch=amd64] https://download.docker.com/linux/debian $(lsb_release -cs) stable\u0026#34; sudo apt update \u0026amp;\u0026amp; apt-cache policy docker-ce Instalo la aplicación y los archivos esenciales recomendados.\n1 sudo apt install docker-ce docker-ce-cli containerd.io Valido instalación de la aplicación, ejecutando la instalación del contenedor de prueba llamado «hello-world».\n1 sudo docker run hello-world Compruebo la versión de la aplicación instalada.\n1 Docker -v Para permitir que un «usuario no administrador» pueda ejecutar un contenedor sin necesitar permisos de «usuario administrador»\n1 2 sudo adduser nombre_usuario docker docker run hello-world Por último, lo ideal antes de iniciar a usar por completo a Docker, es reiniciar y validar el arranque del Servicio y la ejecución del contenedor de prueba.\n1 2 3 sudo systemctl enable docker sudo systemctl start docker docker run hello-world Compruebo que el servicio docker esta funcionando correctamente con el comando\n1 sudo systemctl status docker Creando en primer contenedor: portainer Ahora que ya tengo operativo el servicio docker puedo desde el cliente docker descargar las imágenes que voy a necesitar utilizar para crear los contenedores a partir de ellas. La primera imagen que descargaré será portainer/portainer. Mediante el comando run creo el contenedor que llamaré portainer y que escuchará en el puerto 9000 de mi servidor. Para instalar Portainer escribo desde la consola\n1 docker run -d --name=Portainer --restart=always -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer Este contenedor me va a permitir gestionar desde un entorno gráfico todas las imágenes y los contenedores que cree a partir de ellas. Para lo cual basta abrir un navegador web desde el equipo anfitrión y teclear “ip-de-tu-servidor:9000” para que se abra el panel de administración. Con Portainer instalado y el puerto abierto lo primero que hay que hacer es configurarlo, para ello escribo http://IP_Publica_servidor:9000 en la barra de direcciones y creo una contraseña para el usuario administrador, selecciono “Local” y conectaré con el contenedor Docker. Capturas de todo este proceso: Instalado y configurado Portainer ya puedo crear los contenedores que quiera desde un entorno gráfico. Podré hacerlo de diferentes maneras “App Templates”, “Stacks” o “Images + Containers”. Aquí se pueden ver varias capturas con diferentes ejemplos:\nPosteriormente el login será como el de la imagen.\nServidores detrás de un proxy inverso segurizado con Let\u0026rsquo;s Encrypt Voy a utilizar las siguientes imágenes para crear mis contenedores:\nlinuxserver/duckdns linuxserver/mariadb linuxserver/nextcloud linuxserver/letsencrypt Están disponibles en https://github.com/linuxserver. Donde cada una de estas imágenes viene totalmente documentada para una correcta configuración.\nRed Puente Primero creo una red puente que albergará a los contenedores. Al crear esta red dentro de docker se activará el servidor DNS de que dispone docker y todos los contenedores que pertenezcan a la misma red se reconocerán mutuamente por su nombre. Si al crearla, no indico el tipo de red, esta será por defecto una red tipo puente.\n1 docker network create mi-red nota: Para que los nombres de contenedor se usen como nombres de host DNS en nginx, deben estar en minúsculas ya que nginx los convertirá a minúsculas antes de intentar resolverlos.\nServicio DNS gratuito Para poder acceder a mi servidor desde fuera de mi red NAT voy a utilizar mi subdominio gratuito de Duckdns y apuntar la ip dinámica de mi ISP a el. Como no, lo virtualizo también.\nPara eso creo un contenedor duckdns desde la línea de comando.\nNota: como no me he descargado previamente la imagen linuxserver/duckdns, docker lo hará por mi. Para el resto de contenedores en este punto procederé del mismo modo.\nNota importante: los contenedores que voy a crear a continuación mapean algunos directorios de mi servidor donde guardaré la información que será accesible (virtualhosts, db, log, etc) para ello debo de indicar a cada contenedor la UID y GID del usuario que tiene privilegios sobre esos directorios. Lo que yo he hecho es crear un usuario en mi servidor que será el propietario de dichos directorios con todos los permisos y solo miembro de users.\n1 2 3 4 5 6 7 8 9 10 11 docker create \\ --name=duckdns \\ -e PUID=1000 \\ -e PGID=1000 \\ -e TZ=Europe/Madrid \\ -e SUBDOMAINS=subdomain1,subdomain2 \\ -e TOKEN=escribea-qui-el-token-de-tu-cuenta-duckdns \\ -e LOG_FILE=true `#optional` \\ -v /path/to/appdata/config:/config `#optional` \\ --restart always \\ linuxserver/duckdns Para que empiece a funcionar el contenedor lo inicio con\n1 docker start duckdns Servidor de bases de datos Mysql Mi nube con NextCloud y mi servidor web necesitarán un servidor de bases de datos por lo que creo un contenedor con un SGBD MySQL con la imagen linuxserver/Mariadb y le indico los parámetros para crear el usuario y la BD necesarios para instalar Nextcloud\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 docker create \\ --name=mariadb \\ --net=mi-red \\ -e PUID=1000 \\ -e PGID=1000 \\ -e MYSQL_ROOT_PASSWORD=kljfhpsfkjnbdsfpk \\ -e TZ=Europe/Madrid \\ -e LANGUAGE=es_ES.UTF-8 \\ -e MYSQL_DATABASE=nextcloud_db `#optional` \\ -e MYSQL_USER=nextcloud `#optional` \\ -e MYSQL_PASSWORD=kjnifnfibj `#optional` \\ -p 3306:3306 \\ -v /home/user/appdata/mariadb:/config \\ --restart always \\ linuxserver/mariadb Puedo iniciar el contenedor\n1 docker starts mariadb y entrar en el para administrar las bases de datos con\n1 docker exec -it mariadb bash Ahora ya puedo desde la linea de comando manejar el gestor de bases de datos\nServidor Nextcloud Una vez que he creado el contenedor con el nombre mariadb, creo otro contenedor para Nextcloud de la siguiente manera:\n1 2 3 4 5 6 7 8 9 10 11 docker create \\ --name=nextcloud \\ --net=mi-red \\ -e PUID=1000 \\ -e PGID=1000 \\ -e TZ=Europe/Madrid \\ -p 444:443 \\ -v /home/user/appdata/nextcloud/config:/config \\ -v /home/user/appdata/nextcloud/data:/data \\ --restart always \\ linuxserver/nextcloud No configuro Nextcloud ahora en local desde su “ip:444”, espero a instalar el siguiente contenedor con el servidor web y ponerlo detrás del proxy.\nServidor web y proxy inverso Llegó el momento de crear el contenedor con ngnix como proxy inverso y Let\u0026rsquo;s Encrypt. La validación de la propiedad de los subdominios en Let\u0026rsquo;s Encrypt la haré con duckdns. Voy a solicitar un certificado comodín para subdominios secundarios.\nLa validación se realiza cuando el contenedor se inicia por primera vez. Nginx no estará activo hasta que los certificados SSL se generen con éxito. Los certificados son válidos por 90 días. El contenedor verificará el estado de vencimiento del certificado todas las noches y al llegar al último mes intentará renovarse automáticamente. Si quedasen menos de 30 días para la renovación de los certificados, indicaría que algo ha fallado y que debo revisar los registros en /config/log/letsencrypt para ver por qué fallaron las renovaciones automáticas.\nMapeo del puerto 443 para acceder a través https://www.subdomain1.duckdns.org. Sin embargo, no es necesario escuchar en el puerto 443 de servidor. Todo lo que se necesita es redireccionar el puerto 443 (red wan) del router al puerto 443 dentro del contenedor, entre ambos puede pasar por un puerto diferente en el servidor.\nEn mi caso, redirijo el puerto 443 en el router (wan) hacia el puerto 444 del servidor, y luego asigno este puerto 444 al puerto 443 en el contenedor .\nEl reenvío del puerto 80 solo se requiere para la validación http.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 docker create \\ --name=letsencrypt \\ --cap-add=NET_ADMIN \\ --net=mi-red \\ -e PUID=1000 \\ -e PGID=1000 \\ -e TZ=Europe/Madrid \\ -e URL=subdominio1.duckdns.org \\ -e SUBDOMAINS=wildcard \\ -e VALIDATION=duckdns \\ -e DUCKDNSTOKEN=escribe-aqui-el-token-de-tu-cuenta-duckdns \\ -e EMAIL=tuemail@gmail.com \\ -e DHLEVEL=2048 \\ -e ONLY_SUBDOMAINS=false \\ -e EXTRA_DOMAINS=extradomains `#optional` \\ -p 444:443 \\ -p 80:80 `#optional` \\ -v /srv/dev-disk-by-id-ata-KINGSTON-part6/appdata/letsencrypt:/config \\ --restart always \\ linuxserver/letsencrypt Alojamiento sitio web estático. Una vez que tengo un contenedor que funciona, puedo colocar mis documentos web y modificar los archivos de configuración nginx para configurar el servidor web.\nTodos los archivos necesarios están debajo de los /config que he mapeado en el servidor /home/user/appdata/letsencrypt. Puedo colocar todos los archivos web-html en /config/www.\nLa configuración principal del sitio que utiliza nginx se puede encontrar en /config/nginx/default. No debo eliminar este archivo, ya que se regenerará al reiniciar el contenedor, pero puedo modificarlo. De forma predeterminada, está escuchando en el puerto 443, y la carpeta raíz está configurada en /config/www, por lo que si coloco un archivo page1.html en esa ubicación, estará accesible en https://www.subdomain1.duckdns.org/page1.html. Para habilitar la escucha en el puerto 80 y redirigir automáticamente al puerto 443 para aplicar SSL, ademas de haber mapeado el puerto 80, debería descomentar las líneas en la parte superior de la configuración por defecto del sitio para que se lea:\n1 2 3 4 5 6 7 # redirect all traffic to https server { listen 80; listen [::]:80; server_name _; return 301 https://$host$request_uri; } Después de cualquier cambio en los archivos de configuración, simplemente reinicio el contenedor para volver a cargar la configuración de nginx.\n1 docker restart letsencrypt Configuración de nextcloud como subdominio Busco en la carpeta mapeada /config/nginx/proxy-confs el archivo nombrado nextcloud.subdomain.conf.sample, le cambio el nombre a nextcloud.subdomain.conf y reinicio el contenedor letsencrypt. Acabo de situar al servidor de Nextcloud detrás del proxy que acabo de levantar con el contenedor letsencrypt. Como es la primera vez que accedo a Nextcloud (nunca antes lo he hecho localmente), simplemente navego hasta Nextcloud por detrás del proxy desde https://nextcloud.subdomain1.duckdns.org y veo la página de configuración de Nextcloud.\nCompleto la información: creo un usuario usuario1 con contraseña micontraseña y configuro la base de datos mariadb nextcloud_db. Uso el usuario MYSQL_USER=nextcloud, la contraseña que seleccioné en la variable de entorno nextcloud y mariadb como la dirección del host de la base de datos (nombre del contenedor como dns hostname). Entrando en nexcloud.\nAhora, un usuario con un navegador web puede conectarse a nuestro contenedor de letencrypt a través de https en el puerto 443, solicitar el servicio de Nexcloud, entonces el contenedor de letsencrypt se conectará al contenedor de Nextcloud, recuperará los datos y los pasará al cliente a través de https con nuestro certificado de confianza.\nLa conexión a Nextcloud es local y no necesita ser encriptada, pero toda la comunicación entre nuestro contenedor de letencrypt y el navegador del cliente estará encriptada.\n","pubDate":"2020-06-17","title":"Docker en un servidor casero"},{"link":"https://esaborit.github.io/posts/conky-manager-en-debian-buster/","plain":"Proceso de instalación del monitor de sistemas Conky y la interface gráfica Conky Manager para manejar de una forma mas cómoda Conky.\nConky System Monitor Conky es un monitor de sistema para X originalmente basado en torsmo. Desde su inicio, Conky ha cambiado significativamente desde su predecesor, manteniendo la simplicidad y la capacidad de configuración. Conky puede mostrar casi cualquier cosa, ya sea en su escritorio raíz o en su propia ventana. Conky no solo tiene muchos objetos incorporados; También puede mostrar casi cualquier información utilizando scripts y otros programas externos.\nLa utilidad Conky está fácilmente disponible a través del repositorio oficial de Debian y puede instalarse fácilmente a través de la línea de comandos utilizando el comando apt-get.\nActualizo los indices de los repositorios locales del sistema\n1 sudo apt-get update Instalo Conky System Monitor\n1 sudo apt-get install conky-all Verifico el número de versión de la aplicación, y también verificar que efectivamente esté instalada en su sistema, a través del siguiente comando:\n1 conky --version Para ejecutar Conky basta con escribir su nombre en la consola\n1 conky Para eliminarlo\n1 sudo apt-get remove conky-all Conky Manager Es un administrador para Conky que nos ayudará a configurar Conky de forma gráfica y también permite agregar temas personalizados.\nPara instalarlo primero me descargo desde github el archivo .run de Conky Manager.\n1 wget --no-check-certificate https://github.com/teejee2008/conky-manager/releases/download/v2.4/conky-manager-v2.4-amd64.run Como root ejecuto el siguiente comando:\n1 chmod +x conky-manager-v2.4-amd64.run Instalo Conky Manager a través del siguiente comando\n1 sudo ./conky-manager-v2.4-amd64.run Para iniciarlo puedo acceder al Conky Manager desde la barra de inicio de aplicaciones de Debian o desde la consola con el comando\n1 conky-manager Si quiero eliminarlo de mi sistema, encontraré un archivo llamado conky-manager-uninstall en mi la carpeta / bin. Ejecuto el siguiente comando como root para desinstalar Conky Manager:\n1 ./conky-manager-uninstall Se ha creado la carpeta ~/.conky/ en el directorio personal de mi usuario, dentro de la cual se almacenan los widget que vienen con el programa y los que creemos nosotros. Suponiendo que realmente lo quiero utilizar en mi ordenador, lo siguiente que debo hacer es modificar el widget que mas me guste para agregar o quitar los parámetros que desee y dejarlo a mi gusto. Para ello yo opto por la opción del menu que permite editarlo manualmente como aparece en la figura\nCreo un tema en a carpeta ~/.conky/quique_theme$ con la siguiente composición\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 use_xft yes xftfont 123:size=8 xftalpha 0.1 update_interval 1 total_run_times 0 own_window yes own_window_type normal own_window_transparent yes own_window_hints undecorated,below,sticky,skip_taskbar,skip_pager own_window_colour 000000 own_window_argb_visual yes own_window_argb_value 0 double_buffer yes #minimum_size 250 5 #maximum_width 500 draw_shades no draw_outline no draw_borders no draw_graph_borders no default_color white default_shade_color red default_outline_color green alignment top_left gap_x 50 gap_y 100 no_buffers yes uppercase no cpu_avg_samples 2 net_avg_samples 1 override_utf8_locale yes use_spacer yes minimum_size 0 0 TEXT ${voffset 10}${color EAEAEA}${font GE Inspira:pixelsize=120}${time %H:%M}${font}${voffset -84}${offset 10}${color FFA300}${font GE Inspira:pixelsize=42}${time %d} ${voffset -15}${color EAEAEA}${font GE Inspira:pixelsize=22}${time %B} ${time %Y}${font}${voffset 24}${font GE Inspira:pixelsize=58}${offset -148}${time %A}${font} ${font GE Inspira:pixelsize=20,weight:bold}${color FFA300}${offset 12}${voffset 1}Distro:$color ${execi 3600 aptitude search \u0026#39;~U\u0026#39; | wc -l | cat /etc/issue.net} ${voffset 1}${offset 12}${font Droid Sans:size=12,weight:bold}${color FFA300}SO:$color$sysname${color FFA300}${offset 10}Kernel:$color${offset 2}$kernel ${voffset 1}${offset 12}${font Droid Sans:size=12,weight:bold}${color FFA300}Equipo $color$nodename${color FFA300} Usuario:$color${execi 60 who | awk \u0026#39;{print $1}\u0026#39; | sort -u | tr \u0026#39;\\n\u0026#39; \u0026#39;,\u0026#39; | sed -e \u0026#39;s/,$//\u0026#39; -e \u0026#39;s/,/, /g\u0026#39;} ${color FFA300}Uptime:$color$uptime ${font GE Inspira:pixelsize=20,weight:bold}${color FFA300}${offset 12}${voffset 1}CPU ${voffset -10}${offset 12}${font Ubuntu:pixelsize=12,weight:bold}${color FFA300}Procesador:$color ${execi 1000 cat /proc/cpuinfo | grep \u0026#39;model name\u0026#39; | sed -e \u0026#39;s/model name.*: //\u0026#39;| uniq} ${offset 9} ${color FFA300}Tª$color${acpitemp} °C ${voffset 1}${offset 12}${font Ubuntu:pixelsize=12, weight:bold}${color FFA300}CPU 0: $color${cpu cpu0}%${offset 10}${color FFA300}Tª$color${hwmon 3 temp 1}°C ${platform coretemp.0/hwmon/hwmon3 temp 1} ${voffset 1}${offset 12}${font Ubuntu:pixelsize=12,weight:bold}${color FFA300}CPU 1: $color${cpu cpu1}%${offset 10}${color FFA300}Tª$color${hwmon 3 temp 2}°C ${platform coretemp.0/hwmon/hwmon3 temp 2} ${voffset 1}${offset 12}${font Ubuntu:pixelsize=12,weight:bold}${color FFA300}CPU 2: $color${cpu cpu2}%${offset 10}${color FFA300}Tª$color${hwmon 3 temp 3}°C ${platform coretemp.0/hwmon/hwmon3 temp 3} ${voffset 1}${offset 12}${font Ubuntu:pixelsize=12,weight:bold}${color FFA300}CPU 3: $color${cpu cpu3}%${offset 10}${color FFA300}Tª$color${hwmon 3 temp 4}°C ${platform coretemp.0/hwmon/hwmon3 temp 4} #${platform coretemp.0/hwmon/hwmon3 temp 5} ${voffset 1}${font GE Inspira:pixelsize=20,weight:bold}${color FFA300}${offset 12}${voffset 1}Memoria RAM: ${offset 9}$color$mem / $memmax${offset 30} ${voffset 1}${font GE Inspira:pixelsize=20,weight:bold}${color FFA300}${offset 12}${voffset 1}SWAP: ${offset 9}$color${swap} / ${swapmax} #top para memoria y cpu ${voffset 1}${font GE Inspira:pixelsize=18,weight:bold}${color FFA300}${offset 12}TOP MEM${goto 250}TOP CPU ${voffset 1}${offset 12}${font Ubuntu:pixelsize=12,weight:bold}$color${top_mem name 1}${goto 100}${top_mem pid 1}${goto 150}${top_mem mem 1}%${goto 250}${top name 1}${goto 350}${top pid 1}${goto 400}${top cpu 1}% ${voffset 1}${offset 12}${font Ubuntu:pixelsize=12,weight:bold}$color${top_mem name 2}${goto 100}${top_mem pid 2}${goto 150}${top_mem mem 2}%${goto 250}${top name 2}${goto 350}${top pid 2}${goto 400}${top cpu 2}% ${voffset 1}${offset 12}${font Ubuntu:pixelsize=12,weight:bold}$color${top_mem name 3}${goto 100}${top_mem pid 3}${goto 150}${top_mem mem 3}%${goto 250}${top name 3}${goto 350}${top pid 3}${goto 400}${top cpu 3}% # Showing disk partitions: root, home and Data ${font GE Inspira:pixelsize=20,weight:bold}${color FFA300}${offset 12}${voffset 1}Discos #${offset 12}${diskiograph 33,183 666666 666666}${voffset -30} ${voffset 1}${offset 12}${font Ubuntu:pixelsize=12, weight:bold}${color FFA300}Sistema ${goto 80}Libre: $color${fs_free /}${offset 10}${color FFA300}Usado:$color${fs_used /}${offset 10}${color FFA300}Total: $color${fs_size /} ${fs_bar 10, 100 /}${offset 3}$fs_used_perc% #${voffset 1}${offset 12}${font Ubuntu:pixelsize=12, weight:bold}${color FFA300}Free: $color${fs_free /home}${offset 10}${color FFA300}Used: $color${fs_used /home} ${voffset 1}${offset 12}${font Ubuntu:pixelsize=12, weight:bold}${color FFA300}Datos ${goto 80}Libre: $color${fs_free /media/enrique/Datos}${offset 10}${color FFA300}Usado: $color${fs_used /media/enrique/Datos}${offset 10}${color FFA300}Total: $color${fs_size /media/enrique/Datos} ${fs_bar 10, 100 /media/enrique/Datos}${offset 3}${fs_used_perc /media/enrique/Datos}% ${font GE Inspira:pixelsize=20,weight:bold}${color FFA300}${offset 12}${voffset 1}Red # EDITION FINIR WLAN ${if_existing /proc/net/route wlan0}${font Play:normal:size=7}${color1}${alignr 54}${voffset -8}WiFi ${color1}${wireless_essid wlan0} ${font Play:normal:size=7}${color1}${goto 298}${voffset 2}Up${goto 370}${color1}${totalup wlan0} / ${color1}${upspeed wlan0} ${font Play:normal:size=7}${goto 298}${color1}Down${goto 370}${color1}${totaldown wlan0} / ${color1}${downspeed wlan0} ${font Play:normal:size=8}${goto 300}${voffset 2}Local IP${goto 370}${addr wlan0} ${font Play:normal:size=8}${goto 300}${voffset 1}Public IP${goto 370}${execi 3600 wget -q -O - checkip.dyndns.org | sed -e \u0026#39;s/[^[:digit:]\\|.]//g\u0026#39;} ${font Michroma:size=9}${goto 90}${voffset -42}${color0}${time %a} ${color0}${time %x} ${font Michroma:size=18}${goto 118}${color1}${voffset -4}${time %H}:${time %M} ${font Michroma:size=8}${color0}${goto 296}${voffset 18}BATTERIE ${font Play:size=8}${color0}${goto 278}${voffset 5}${color1}${battery_percent BAT1}% # |--ETH0 ${else}${if_existing /proc/net/route enp5s0} ${voffset -30}${offset 15}${font Ubuntu:pixelsize=12, weight:bold}${color FFA300}LAN: ${offset 45}Up${offset 10}${goto 110}$color${totalup enp5s0} / ${upspeed enp5s0}/s ${voffset 1}${offset 45}${font Ubuntu:pixelsize=12, weight:bold}${color FFA300}Down${offset 10}${goto 110}$color${totaldown enp5s0} / $color${downspeed enp5s0}/s ${voffset 1}${offset 45}${font Ubuntu:pixelsize=12, weight:bold}${color FFA300}Local IP $color${offset 10}${goto 110}${addr enp5s0} ${voffset 1}${offset 45}${font Ubuntu:pixelsize=12, weight:bold}${color FFA300}Public IP $color${goto 110}${execi 3600 wget -q -O - checkip.dyndns.org | sed -e \u0026#39;s/[^[:digit:]\\|.]//g\u0026#39;} #${font Michroma:size=9}${alignr 298}${voffset -42}${color0}${time %a} ${color0}${time %x} #${font Michroma:size=18}${goto 118}${color1}${voffset -4}${time %H}:${time %M} #${font Michroma:size=8}${color0}${goto 296}${voffset 18}BATTERIE #${font Play:size=8}${color0}${goto 278}${voffset 4}${color1}${battery_percent BAT1}%${endif}${endif} #${font Play:normal:size=7}${goto 180}Uptime${color1}${alignr 100}${uptime_short} ${voffset 1}${offset 45}${font Ubuntu:pixelsize=12, weight:bold}${color FFA300}Puertos abiertos: $color${tcp_portmon 1 65535 count} ${voffset 1}${offset 12}${font Ubuntu:pixelsize=18, weight:bold}${color FFA300}PUERTO${goto 110}IP${goto 400}URL ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 0} ${goto 100} ${tcp_portmon 1 65535 rhost 0}${goto 400}${tcp_portmon 1 65535 rip 0} ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 1} ${goto 100} ${tcp_portmon 1 65535 rhost 1}${goto 400}${tcp_portmon 1 65535 rip 1} ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 2} ${goto 100} ${tcp_portmon 1 65535 rhost 2}${goto 400}${tcp_portmon 1 65535 rip 2} ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 3} ${goto 100} ${tcp_portmon 1 65535 rhost 3}${goto 400}${tcp_portmon 1 65535 rip 3} ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 4} ${goto 100} ${tcp_portmon 1 65535 rhost 4}${goto 400}${tcp_portmon 1 65535 rip 4} ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 5} ${goto 100} ${tcp_portmon 1 65535 rhost 5}${goto 400}${tcp_portmon 1 65535 rip 5} ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 6} ${goto 100} ${tcp_portmon 1 65535 rhost 6}${goto 400}${tcp_portmon 1 65535 rip 6} ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 7} ${goto 100} ${tcp_portmon 1 65535 rhost 7}${goto 400}${tcp_portmon 1 65535 rip 7} ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 8} ${goto 100} ${tcp_portmon 1 65535 rhost 8}${goto 400}${tcp_portmon 1 65535 rip 8} ${offset 12}${font 6x10:size=7,weight:normal}$color${tcp_portmon 1 65535 rport 9} ${goto 100} ${tcp_portmon 1 65535 rhost 9}${goto 400}${tcp_portmon 1 65535 rip 9} Lo selecciono desde la aplicación para que se ejecute. Además quiero que se inicie cada vez que encienda el ordenador, para lo cual la aplicación dispone de un menú de configuración donde se puede decidir que los widgets se activen al iniciarse la sesión de usuario del Sistema, programar un retraso (delay) para iniciarlos sobre el escritorio, y cambiar, añadir y borrar el directorio (carpeta) por defecto donde se guardan y leen todos los widgets y temas instalados.\n","pubDate":"2020-06-12","title":"Instalando Conky System Monitor y Conky Manager en Debian Buster"},{"link":"https://esaborit.github.io/posts/instalando-gitkraken-en-debian-buster/","plain":"Instalo GitKraken siguiendo los pasos de la página de soporte del sitio web de Gitkraken. Entre otras razones para su instalación esta que no se requieren herramientas Git para GitKraken, por lo que una vez instalado, se puede abrir la aplicación y comenzar a trabajar con el.\nAdemás funciona directamente con sus repositorios sin dependencias, ni siquiera necesita tener Git instalado en su sistema.\nInstalación Para poder instalarlo bajo por el contenido de página de soporte hasta encontrarme con las instrucciones a seguir para distribuciones basadas en Debian y ejecuto el código que indican\n1 2 wget https://release.gitkraken.com/linux/gitkraken-amd64.deb sudo dpkg -i gitkraken-amd64.deb Me aparece un mensaje diciendo que hay un problema de dependencias que impiden la configuración de Gitkraken en concreto faltan gconf2 y un par de archivos más.\nLo solucioné con el siguiente comando\n1 sudo apt --fix-broken install Ahora ya puedo utilizar Gitkraken para el mantenimiento de mis proyectos.\nErrores en Linux En la página de soporte dan información de la solución a varios problemas conocidos en linux.\nError with libcurl.so.4 Error: libcurl.so.4: cannot open shared object file: No such file or directory.\nEjecute el siguiente comando para abordar el problema de dependencia.\n1 sudo apt install libcurl3 Error con libcurl-gnutls.so.4 libcurl-gnutls.so.4: cannot open shared object file: No such file or directory.\nEjecute el siguiente comando para solucionar este problema.\n1 sudo ln -s /usr/lib64/libcurl.so.4 /usr/lib64/libcurl-gnutls.so.4 Error con libXss.so.1 ./gitkraken ./gitkraken: error while loading shared libraries: libXss.so.1: cannot open shared object file: No such file or directory.\nEjecute el siguiente comando para solucionar este problema.\n1 2 3 4 /usr/bin/dnf whatprovides libXss.so.1 dnf install libXScrnSaver dnf check-update dnf upgrade ","pubDate":"2020-06-10","title":"Instalando GitKraken en Debian Buster"},{"link":"https://esaborit.github.io/posts/personalizando-beautifulhugo/","plain":"Para empezar a personalizar el tema que he instalado en mi sitio web, lo primero que debo de hacer es modificar el fichero config.toml que he copiado en el directorio raíz de mi sitio desde la carpeta llamada \u0026ldquo;exampleSite\u0026rdquo; de dicho tema.\nPrimeros ajustes Empiezo configurando las variables básicas del sitio web como son su url, título, tema, asi como la configuración de los bloque de código, comentarios, estadísticas de Google y la paginación de los post.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 baseurl = \u0026#34;https://usuario.github.io\u0026#34; DefaultContentLanguage = \u0026#34;es\u0026#34; title = \u0026#34;titulo del sitio\u0026#34; theme = \u0026#34;beautifulhugo\u0026#34; metaDataFormat = \u0026#34;yaml\u0026#34; # # Configuración de los bloques de código fuente # Guía en: https://gohugo.io/content-management/syntax-highlighting/ # pygmentsStyle = \u0026#34;trac\u0026#34; pygmentsUseClasses = true pygmentsCodeFences = true pygmentsCodefencesGuessSyntax = true # # Configuración de los comentarios (Disqus) # #disqusShortname = \u0026#34;XXX\u0026#34; # # Configuración de las estadísticas (Google Analytics) # #googleAnalytics = \u0026#34;XXX\u0026#34; # # Configuración de la paginación # Paginate = 5 # Por defecto muestra 10 post Más parámetros La siguiente sección que modifico es [Params]. No agrego título, pero si pongo un subtitulo, cambio el logo, el favicon, el formato de la fecha y pongo a false todos aquellas variables que representan elementos que no quiero que se muestren, como son rss, comentarios, esconder el autor.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 [Params] # homeTitle = \u0026#34;Beautiful Hugo Theme\u0026#34; # Set a different text for the header on the home page subtitle = \u0026#34;Notas de un aprendiz de informático\u0026#34; mainSections = [\u0026#34;post\u0026#34;,\u0026#34;posts\u0026#34;] logo = \u0026#34;img/avatar-icon2.png\u0026#34; # Expecting square dimensions favicon = \u0026#34;img/favicon.ico\u0026#34; dateFormat = \u0026#34;02-01-2006\u0026#34; commit = false rss = false comments = false readingTime = true wordCount = true useHLJS = true socialShare = false delayDisqus = true showRelatedPosts = true hideAuthor = false # gcse = \u0026#34;012345678901234567890:abcdefghijk\u0026#34; # Get your code from google.com/cse. Make sure to go to \u0026#34;Look and Feel\u0026#34; and change Layout to \u0026#34;Full Width\u0026#34; and Theme to \u0026#34;Classic\u0026#34; Carrusel Seguido a esto hay otro parámetros que podemos configurar para que se muestre un carrusel de imágenes de cabecera. Yo lo configuro para que solo muestre una imagen, aunque se podrían mostrar 2, 3, 4 o las que quisieras.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # # Configuración del carrusel de imágenes de la página de inicio # [[Params.bigimg]] src = \u0026#34;img/santanderb.jpg\u0026#34; desc = \u0026#34;Playa del camello\u0026#34; #[[Params.bigimg]] # src = \u0026#34;img/sphere.jpg\u0026#34; # desc = \u0026#34;Sphere\u0026#34; # # position: see values of CSS background-position. # position = \u0026#34;center top\u0026#34; #[[Params.bigimg]] # src = \u0026#34;img/hexagon.jpg\u0026#34; # desc = \u0026#34;Hexagon\u0026#34; Autor Continuo con la modificación del fichero config.toml, ahora le toca a la sección del autor en la que pongo mis datos personales como son nombre, el hosting de mi sitio web (en este caso en github), correo electrónico, y mis usuarios en diversas redes sociales (solo he dejado aquellas que me interesan).\n1 2 3 4 5 6 7 [Author] name = \u0026#34;Tu nombre completo si quieres\u0026#34; website = \u0026#34;https://tu-usuario.github.io/\u0026#34; #email = \u0026#34;youremail@domain.com\u0026#34; github = \u0026#34;tu-usuario\u0026#34; gitlab = \u0026#34;tu-usuario\u0026#34; linkedin = \u0026#34;tu-usuario\u0026#34; Menú Paso a configurar la sección del menú del sitio web. Cada item del menú contiene un nombre, una url y una posición denominada weight. Si además el item va a desplegar un submenú contiene un identifier que utilizarán como \u0026ldquo;parent\u0026rdquo; cada uno de las entradas del submenú.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 [[menu.main]] name = \u0026#34;Inicio\u0026#34; url = \u0026#34;\u0026#34; weight = 1 [[menu.main]] name = \u0026#34;Acerca de\u0026#34; url = \u0026#34;page/about/\u0026#34; weight = 3 [[menu.main]] identifier = \u0026#34;menu\u0026#34; name = \u0026#34;Contenidos\u0026#34; weight = 2 [[menu.main]] parent = \u0026#34;menu\u0026#34; name = \u0026#34;Etiquetas\u0026#34; url = \u0026#34;etiquetas\u0026#34; weight = 2 [[menu.main]] parent = \u0026#34;menu\u0026#34; name = \u0026#34;Proyectos\u0026#34; url = \u0026#34;proyectos\u0026#34; weight = 3 [[menu.main]] parent = \u0026#34;menu\u0026#34; name = \u0026#34;Categorias\u0026#34; url = \u0026#34;categorias\u0026#34; weight = 4 Taxonomías Si ahora voy al sitio web e intento usar el menú no me funcionará porque no he definido aún el contenido ni las taxonomías ni los permalinks. Asi que toca seguir con la faena. Las taxonomías para mi caso quedan asi:\n1 2 3 4 5 6 7 8 9 # # Configuración de taxonomías # [taxonomies] category = \u0026#34;categories\u0026#34; tag = \u0026#34;tags\u0026#34; categoria = \u0026#34;categorias\u0026#34; proyecto = \u0026#34;proyectos\u0026#34; etiqueta = \u0026#34;etiquetas\u0026#34; Importante seguir la estructura singular = plural marcada en la guía oficial de taxonomías de Hugo. Y como recomienda Alexis Sáez en su sitio web Infinitos Contrastes en su proyecto metablog\n\u0026ldquo;conviene escoger parejas en donde el plural se diferencie del singular únicamente por el carácter s final\u0026rdquo;.\nPermalinks Y los permalinks para los post asi:\n1 2 3 4 5 # # Configuración del permalink # [permalinks] post = \u0026#34;/:year/:month/:day/:slug/\u0026#34; Por defecto, Hugo utiliza el directorio donde se encuentre el contenido (generalmente es \\post\\) y lo concatena con el título de la entrada, para el que sustituye espacios por guiones. En cada entrada definiré manualmente mi propio slug, para evitar que la traducción automática del título hacia su correspondiente parte del permalink dé lugar a resultados no deseados derivados de la presencia de letras como la ñ no recogidas en el alfabeto inglés.\nPersonalizando post Pero todavía no he acabado la configuración. Quiero personalizar como se muestran las taxonomias que acompañan a los post que voy creando. Para ello debo de modificar los archivos \u0026quot;single.html\u0026quot;, \u0026quot;post_preview.html\u0026quot; y \u0026quot;main.css\u0026quot;. Comienzo copiando dichos archivos que están dentro de la carpeta \u0026ldquo;layouts\u0026rdquo; situada en la rutas \u0026quot;themes/beautifulhugo/layouts/_default/single.html\u0026quot;, \u0026quot;themes/beautifulhugo/layouts/partials/post_preview.html\u0026quot; y el archivo css en la ruta \u0026quot;themes/beautifulhugo/static/css/main.css\u0026quot;. Los coloco cada cual en su carpeta homologa en la raiz del sitio web.\n¿Porque lo hago así?. Porque hugo a la hora de construir el sitio web estatico dentro de la carpeta \u0026ldquo;public\u0026rdquo; primero mira en las carpetas del sitio y si no encuentra en ellas los archivos que necesita los coge entonces de la carpeta \u0026ldquo;themes\u0026rdquo;. Además de esta forma siempre tendré a mano los archivos originales en caso de que me arrepienta de algún cambio y no recuerde como era el archivo antes de los cambios.\nCambios en el main.css Creo clases de estilos css para \u0026quot;categorias\u0026quot;, \u0026quot;proyectos\u0026quot; y \u0026quot;etiquetas\u0026quot;, su contenido es el mismo para las tres. Muestro como ejemplo el de categorias.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 .blog-categorias { font-family: \u0026#39;Open Sans\u0026#39;, \u0026#39;Helvetica Neue\u0026#39;, Helvetica, Arial, sans-serif; color: #999; font-size: 15px; margin-bottom: 20px; } .blog-categorias a { color: #008AFF; text-decoration: none; border: none; background: rgba(0, 0, 0, 0.05); font-weight: normal; border-radius: 3px; padding: 5px 10px; margin-right: 8px; margin-bottom: 8px; } .blog-categorias a:hover { border-radius: 2px; color: #008AFF; background-color: #CCC; } .post-preview .blog-categorias { margin-top: 5px; margin-bottom: 0; } @media only screen and (min-width: 768px) { .post-preview .blog-categorias { margin-top: 10px; } } Modifico el estilo de la cabecera de la página de etiquetas, proyectos y de categorías.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 .intro-header .page-heading, .intro-header .tags-heading, .intro-header .etiquetas-heading, .intro-header .categorias-heading, .intro-header .proyectos-heading, .intro-header .categories-heading { text-align: center; } .intro-header .page-heading h1, .intro-header .tags-heading h1, .intro-header .etiquetas-heading h1, .intro-header .categorias-heading h1, .intro-header .proyectos-heading h1, .intro-header .categories-heading h1 { margin-top: 0; font-size: 50px; } Cambios en las plantillas En la plantilla \u0026quot;post-preview.html\u0026quot; modifico la forma en que muestra las etiquetas. Cambio\n1 2 3 4 5 {{ if .Params.tags }} \u0026lt;div class=\u0026#34;blog-tags\u0026#34;\u0026gt; {{ range .Params.tags }} \u0026lt;a href=\u0026#34;{{ $.Site.LanguagePrefix | absURL }}/tags/{{ . | urlize }}/\u0026#34;\u0026gt;{{ . }}\u0026lt;/a\u0026gt;\u0026amp;nbsp; {{ end }} \u0026lt;/div\u0026gt; {{ end }} por\n1 2 3 4 5 {{ if .Params.etiquetas }} \u0026lt;div class=\u0026#34;blog-etiquetas\u0026#34;\u0026gt;\u0026lt;i class=\u0026#34;fas fa-tags\u0026#34;\u0026gt;\u0026lt;/i\u0026gt; {{ range .Params.etiquetas }} \u0026lt;a href=\u0026#34;{{ $.Site.LanguagePrefix | absURL }}/etiquetas/{{ . | urlize }}/\u0026#34;\u0026gt;{{ . }}\u0026lt;/a\u0026gt;\u0026amp;nbsp; {{ end }} \u0026lt;/div\u0026gt; {{ end }} En la plantilla single.html cambio\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 {{ if .Params.categorias }} \u0026lt;div class=\u0026#34;blog-categorias\u0026#34;\u0026gt;\u0026lt;i class=\u0026#34;fas fa-folder\u0026#34;\u0026gt;\u0026lt;/i\u0026gt; {{ range .Params.categorias }} \u0026lt;a href=\u0026#34;{{ $.Site.LanguagePrefix | absURL }}/categorias/{{ . | urlize }}/\u0026#34;\u0026gt;{{ . }}\u0026lt;/a\u0026gt;\u0026amp;nbsp; {{ end }} \u0026lt;/div\u0026gt; {{ end }} {{ if .Params.proyectos }} \u0026lt;div class=\u0026#34;blog-proyectos\u0026#34;\u0026gt;\u0026lt;i class=\u0026#34;fas fa-tasks\u0026#34;\u0026gt;\u0026lt;/i\u0026gt; {{ range .Params.proyectos }} \u0026lt;a href=\u0026#34;{{ $.Site.LanguagePrefix | absURL }}/proyectos/{{ . | urlize }}/\u0026#34;\u0026gt;{{ . }}\u0026lt;/a\u0026gt;\u0026amp;nbsp; {{ end }} \u0026lt;/div\u0026gt; {{ end }} {{ if .Params.etiquetas }} \u0026lt;div class=\u0026#34;blog-tags\u0026#34;\u0026gt;\u0026lt;i class=\u0026#34;fas fa-tags\u0026#34;\u0026gt;\u0026lt;/i\u0026gt; {{ range .Params.etiquetas }} \u0026lt;a href=\u0026#34;{{ $.Site.LanguagePrefix | absURL }}/etiquetas/{{ . | urlize }}/\u0026#34;\u0026gt;{{ . }}\u0026lt;/a\u0026gt;\u0026amp;nbsp; {{ end }} \u0026lt;/div\u0026gt; {{ end }} Con estos cambios termino de dar una ligera capa de personalización al tema elegido para mi sitio web.\n","pubDate":"2020-06-02","title":"Personalizando el tema beautifulhugo"},{"link":"https://esaborit.github.io/posts/creando-un-sitio-web-con-hugo/","plain":"Creo este post para acordarme de como voy a instalar este blog utilizando Hugo. Mi entorno de desarrollo está compuesto de un ordenador con Debian 10 como SO, donde instalaré Hugo, VSCodium como editor de código y Github como hosting y repositorio del sitio web del blog.\nLo primero que debo hacer es preparar el entorno de trabajo. Necesito instalar Git, Hugo y VSCodium. Además debo crear, si no la tengo ya, una cuenta en Github.\nGit Instalo git desde la consola\n1 $ sudo apt-get install git Compruebo que está correctamente instalado con el siguiente comando:\n1 2 $ git --version git version 2.20.1 Configurando Git Ahora que he instalado Git, debo configurarlo para que los mensajes de confirmación generados contengan su información correcta.\nEsto lo puedo hacer usando el comando \u0026ldquo;git config\u0026rdquo;. Tengo que aportar un nombre de usuario y una dirección de correo electrónico porque Git incorpora esta información en cada confirmación que haga. Voy a poner mi usuario y correo que proporcioné al crear la cuenta de Github:\n1 2 $ git config --global user.name \u0026#34;Mi_nombre\u0026#34; $ git config --global user.email \u0026#34;mi_nombre@dominio.com\u0026#34; Puedo ver todos los elementos de configuración que se han guardado escribiendo:\n1 2 3 4 5 $ git config --list Output user.name=Mi_nombre user.email=mi_nombre@dominio.com ... La información se almacena en su archivo de configuración \u0026quot;.gitconfig\u0026quot;, que se puede editar a mano con nano, por ejemplo:\n1 2 3 4 5 $ nano ~/.gitconfig ~ / .gitconfig contenidos [user] name = Mi_nombre email = mi_nombre@dominio.com Hay muchas otras opciones que puede configurar, pero estas son las dos esenciales. Si omito este paso, es probable que aparezcan advertencias al ejecutar los comandos de Git.\nHugo He decidido instalar Hugo con snap porque los paquetes .deb de los repositorios ofrecen versiones mas antiguas del programa. Para instalar Hugo como snap en Debian 10, primero habilito snapd\n1 2 $ sudo apt update $ sudo apt install snapd Para después instalarlo así\n1 $ sudo snap install hugo Compruebo la versión con\n1 2 $ hugo version Hugo Static Site Generator v0.72.0 linux/amd64 BuildDate: 2020-05-31T18:06:12Z Sitio web en local Ahora ya puede crear mi sitio web en local. Desde la consola me sitúo dentro de la carpeta dentro de la que voy a crear el sitio web.\n1 $ cd /Proyectos Creo el framework para mi sitio web con Hugo ejecutando el siguiente comando:\n1 $ hugo new site mi-sitio Si todo ha ido bien veré el siguiente texto:\n1 2 3 4 5 6 7 8 9 10 11 12 13 Congratulations! Your new Hugo site is created in ~/Documents/websitename. Just a few more steps and you are ready to go: 1. Download a theme into the same-named folder. Choose a theme from https://themes.gohugo.io/ or create your own with the \u0026#34;hugo new theme \u0026lt;THEMENAME\u0026gt;\u0026#34; command. 2. Perhaps you want to add some content. You can add single files with \u0026#34;hugo new \u0026lt;SECTIONNAME\u0026gt;/\u0026lt;FILENAME\u0026gt;.\u0026lt;FORMAT\u0026gt;\u0026#34;. 3. Start the built-in live server via \u0026#34;hugo server\u0026#34;. Visit https://gohugo.io/ for quickstart guide and full documentation. Veo su contenido Entro de la carpeta del sitio recién creado y veo su contenido,\n1 2 3 4 5 6 7 8 9 10 11 12 esc@pc:$ /Proyectos/mi-sitio tree . ├── archetypes │ └── default.md ├── config.toml ├── content ├── data ├── layouts ├── static └── themes 6 directories, 2 files Puedo ver que se han creado 6 carpetas y dos archivos. Me centro en lo mas importante para empezar, las carpetas \u0026quot;content\u0026quot;, \u0026quot;themes\u0026quot;, \u0026quot;data\u0026quot; y el archivo \u0026quot;config.toml\u0026quot; dentro del cual están los parámetros de configuración del sitio.\nLo siguiente que necesito es bajarme un tema, pues no viene con ninguno por defecto. Yo he elegido el tema beautifulhugo, lo descargo desde su sitio web en formato zip , lo descomprimo y lo copio dentro de la carpeta \u0026quot;themes\u0026quot; de \u0026quot;mi-sitio\u0026quot;.\nEntro en la carpeta beautifulhugo descomprimida y veo que hay una carpeta llamada \u0026quot;exampleSite\u0026quot; que contiene las siguientes carpetas y ficheros. Copio todo su contenido y lo pego en el directorio raíz de \u0026quot;mi-sitio\u0026quot;. Ahora ya dispongo de un sitio web de ejemplo que modificaré a mi antojo.\nPuedo ver como se ve ejecuntando el siguiente comando:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 $ hugo server | ES -------------------+------ Pages | 48 Paginator pages | 2 Non-page files | 0 Static files | 188 Processed images | 0 Aliases | 12 Sitemaps | 1 Cleaned | 0 Built in 579 ms Watching for changes in /Proyectos/mi_sitio/{archetypes,content,data,layouts,static,themes} Watching for config changes in /Proyectos/mi_sitio/config.toml Environment: \u0026#34;development\u0026#34; Serving pages from memory Running in Fast Render Mode. For full rebuilds on change: hugo server --disableFastRender Web Server is available at http://localhost:1313/ (bind address 127.0.0.1) Press Ctrl+C to stop Debo copiar la dirección http://localhost:1313/ en la barra de direcciones de un navegador web para poder verlo. Después de confirmar que es el tema que quiero usar para mi sitio cierro el servidor local de Hugo desde la terminal, utilizando la combinación de teclas Ctrl + C.\n","pubDate":"2020-06-01","title":"Creando Un Sitio Web Con Hugo"},{"link":"https://esaborit.github.io/posts/instalando-vscodium-en-debian-10/","plain":"VSCodium es una una bifurcación del código de Visual Studio de Microsoft creada para que los desarrolladores no tengan que lidiar con la telemetría/rastreadores que tiene Visual Studio Code.\nEste proyecto incluye scripts de compilación especiales que clonan el repositorio vscode de Microsoft, ejecutan los comandos de compilación y cargan los binarios resultantes en un repositorio en Github . Estos binarios están autorizados bajo la licencia MIT. En ellos la telemetría está deshabilitada.\nInstalando VSCodium Para realizar la instalación de VSCodium sigo los pasos de la página web del proyecto VSCodium.\nAgrego la clave GPG del repositorio\n1 wget -qO - https://gitlab.com/paulcarroty/vscodium-deb-rpm-repo/raw/master/pub.gpg | sudo apt-key add - Agrego el repositorio:\n1 echo \u0026#39;deb https://gitlab.com/paulcarroty/vscodium-deb-rpm-repo/raw/repos/debs/ vscodium main\u0026#39; | sudo tee --append /etc/apt/sources.list.d/vscodium.list Actualizo y luego instalo vscodium:\n1 sudo apt update \u0026amp;\u0026amp; sudo apt install codium ","pubDate":"2020-05-30","title":"Instalando VSCodium en Debian 10"},{"link":"https://esaborit.github.io/about/","plain":"Written in Go, Hugo is an open source static site generator available under the Apache Licence 2.0. Hugo supports TOML, YAML and JSON data file types, Markdown and HTML content files and uses shortcodes to add rich content. Other notable features are taxonomies, multilingual mode, image processing, custom output formats, HTML/CSS/JS minification and support for Sass SCSS workflows.\nHugo makes use of a variety of open source projects including:\nhttps://github.com/yuin/goldmark https://github.com/alecthomas/chroma https://github.com/muesli/smartcrop https://github.com/spf13/cobra https://github.com/spf13/viper Hugo is ideal for blogs, corporate websites, creative portfolios, online magazines, single page applications or even a website with thousands of pages.\nHugo is for people who want to hand code their own website without worrying about setting up complicated runtimes, dependencies and databases.\nWebsites built with Hugo are extremelly fast, secure and can be deployed anywhere including, AWS, GitHub Pages, Heroku, Netlify and any other hosting provider.\nLearn more and contribute on GitHub.\n","pubDate":"2019-02-28","title":"Sobre mi"}];
    var search_theEnd = "Final de la búsqueda";
    var search_nothing = "Lo sentimos, no se encontró nada";
    var search_found = "Se han encontrado";
    var search_result = "resultado";
    var search_results = "resultados";
    var enable_mermaid =  null 
</script>





        
    </body>
</html>

